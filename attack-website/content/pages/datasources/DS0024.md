Title: Windows Registry
Template: datasources/datasource
save_as: datasources/DS0024/index.html
data: {"attack_id": "DS0024", "side_menu_data": {"name": "Data Sources", "id": "datasources", "path": null, "children": [{"name": "Active Directory", "id": "DS0026", "path": "/datasources/DS0026/", "children": [{"name": "Active Directory Credential Request", "id": "Active Directory Credential Request", "path": "/datasources/DS0026/#Active Directory Credential Request", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Access", "id": "Active Directory Object Access", "path": "/datasources/DS0026/#Active Directory Object Access", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Creation", "id": "Active Directory Object Creation", "path": "/datasources/DS0026/#Active Directory Object Creation", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Deletion", "id": "Active Directory Object Deletion", "path": "/datasources/DS0026/#Active Directory Object Deletion", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Modification", "id": "Active Directory Object Modification", "path": "/datasources/DS0026/#Active Directory Object Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Application Log", "id": "DS0015", "path": "/datasources/DS0015/", "children": [{"name": "Application Log Content", "id": "Application Log Content", "path": "/datasources/DS0015/#Application Log Content", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Application Vetting", "id": "DS0041", "path": "/datasources/DS0041/", "children": [{"name": "API Calls", "id": "API Calls", "path": "/datasources/DS0041/#API Calls", "domains": ["mobile"], "children": []}, {"name": "Application Assets", "id": "Application Assets", "path": "/datasources/DS0041/#Application Assets", "domains": ["mobile"], "children": []}, {"name": "Network Communication", "id": "Network Communication", "path": "/datasources/DS0041/#Network Communication", "domains": ["mobile"], "children": []}, {"name": "Permissions Requests", "id": "Permissions Requests", "path": "/datasources/DS0041/#Permissions Requests", "domains": ["mobile"], "children": []}, {"name": "Protected Configuration", "id": "Protected Configuration", "path": "/datasources/DS0041/#Protected Configuration", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Asset", "id": "DS0039", "path": "/datasources/DS0039/", "children": [{"name": "Asset Inventory", "id": "Asset Inventory", "path": "/datasources/DS0039/#Asset Inventory", "domains": ["ics"], "children": []}, {"name": "Software", "id": "Software", "path": "/datasources/DS0039/#Software", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Certificate", "id": "DS0037", "path": "/datasources/DS0037/", "children": [{"name": "Certificate Registration", "id": "Certificate Registration", "path": "/datasources/DS0037/#Certificate Registration", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Service", "id": "DS0025", "path": "/datasources/DS0025/", "children": [{"name": "Cloud Service Disable", "id": "Cloud Service Disable", "path": "/datasources/DS0025/#Cloud Service Disable", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Enumeration", "id": "Cloud Service Enumeration", "path": "/datasources/DS0025/#Cloud Service Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Metadata", "id": "Cloud Service Metadata", "path": "/datasources/DS0025/#Cloud Service Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Modification", "id": "Cloud Service Modification", "path": "/datasources/DS0025/#Cloud Service Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Storage", "id": "DS0010", "path": "/datasources/DS0010/", "children": [{"name": "Cloud Storage Access", "id": "Cloud Storage Access", "path": "/datasources/DS0010/#Cloud Storage Access", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Creation", "id": "Cloud Storage Creation", "path": "/datasources/DS0010/#Cloud Storage Creation", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Deletion", "id": "Cloud Storage Deletion", "path": "/datasources/DS0010/#Cloud Storage Deletion", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Enumeration", "id": "Cloud Storage Enumeration", "path": "/datasources/DS0010/#Cloud Storage Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Metadata", "id": "Cloud Storage Metadata", "path": "/datasources/DS0010/#Cloud Storage Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Modification", "id": "Cloud Storage Modification", "path": "/datasources/DS0010/#Cloud Storage Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Command", "id": "DS0017", "path": "/datasources/DS0017/", "children": [{"name": "Command Execution", "id": "Command Execution", "path": "/datasources/DS0017/#Command Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Container", "id": "DS0032", "path": "/datasources/DS0032/", "children": [{"name": "Container Creation", "id": "Container Creation", "path": "/datasources/DS0032/#Container Creation", "domains": ["enterprise"], "children": []}, {"name": "Container Enumeration", "id": "Container Enumeration", "path": "/datasources/DS0032/#Container Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Container Start", "id": "Container Start", "path": "/datasources/DS0032/#Container Start", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Domain Name", "id": "DS0038", "path": "/datasources/DS0038/", "children": [{"name": "Active DNS", "id": "Active DNS", "path": "/datasources/DS0038/#Active DNS", "domains": ["enterprise"], "children": []}, {"name": "Domain Registration", "id": "Domain Registration", "path": "/datasources/DS0038/#Domain Registration", "domains": ["enterprise"], "children": []}, {"name": "Passive DNS", "id": "Passive DNS", "path": "/datasources/DS0038/#Passive DNS", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Drive", "id": "DS0016", "path": "/datasources/DS0016/", "children": [{"name": "Drive Access", "id": "Drive Access", "path": "/datasources/DS0016/#Drive Access", "domains": ["enterprise"], "children": []}, {"name": "Drive Creation", "id": "Drive Creation", "path": "/datasources/DS0016/#Drive Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Drive Modification", "id": "Drive Modification", "path": "/datasources/DS0016/#Drive Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Driver", "id": "DS0027", "path": "/datasources/DS0027/", "children": [{"name": "Driver Load", "id": "Driver Load", "path": "/datasources/DS0027/#Driver Load", "domains": ["enterprise"], "children": []}, {"name": "Driver Metadata", "id": "Driver Metadata", "path": "/datasources/DS0027/#Driver Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "File", "id": "DS0022", "path": "/datasources/DS0022/", "children": [{"name": "File Access", "id": "File Access", "path": "/datasources/DS0022/#File Access", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Creation", "id": "File Creation", "path": "/datasources/DS0022/#File Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Deletion", "id": "File Deletion", "path": "/datasources/DS0022/#File Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Metadata", "id": "File Metadata", "path": "/datasources/DS0022/#File Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Modification", "id": "File Modification", "path": "/datasources/DS0022/#File Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Firewall", "id": "DS0018", "path": "/datasources/DS0018/", "children": [{"name": "Firewall Disable", "id": "Firewall Disable", "path": "/datasources/DS0018/#Firewall Disable", "domains": ["enterprise"], "children": []}, {"name": "Firewall Enumeration", "id": "Firewall Enumeration", "path": "/datasources/DS0018/#Firewall Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Firewall Metadata", "id": "Firewall Metadata", "path": "/datasources/DS0018/#Firewall Metadata", "domains": ["enterprise"], "children": []}, {"name": "Firewall Rule Modification", "id": "Firewall Rule Modification", "path": "/datasources/DS0018/#Firewall Rule Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Firmware", "id": "DS0001", "path": "/datasources/DS0001/", "children": [{"name": "Firmware Modification", "id": "Firmware Modification", "path": "/datasources/DS0001/#Firmware Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Group", "id": "DS0036", "path": "/datasources/DS0036/", "children": [{"name": "Group Enumeration", "id": "Group Enumeration", "path": "/datasources/DS0036/#Group Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Group Metadata", "id": "Group Metadata", "path": "/datasources/DS0036/#Group Metadata", "domains": ["enterprise"], "children": []}, {"name": "Group Modification", "id": "Group Modification", "path": "/datasources/DS0036/#Group Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Image", "id": "DS0007", "path": "/datasources/DS0007/", "children": [{"name": "Image Creation", "id": "Image Creation", "path": "/datasources/DS0007/#Image Creation", "domains": ["enterprise"], "children": []}, {"name": "Image Deletion", "id": "Image Deletion", "path": "/datasources/DS0007/#Image Deletion", "domains": ["enterprise"], "children": []}, {"name": "Image Metadata", "id": "Image Metadata", "path": "/datasources/DS0007/#Image Metadata", "domains": ["enterprise"], "children": []}, {"name": "Image Modification", "id": "Image Modification", "path": "/datasources/DS0007/#Image Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Instance", "id": "DS0030", "path": "/datasources/DS0030/", "children": [{"name": "Instance Creation", "id": "Instance Creation", "path": "/datasources/DS0030/#Instance Creation", "domains": ["enterprise"], "children": []}, {"name": "Instance Deletion", "id": "Instance Deletion", "path": "/datasources/DS0030/#Instance Deletion", "domains": ["enterprise"], "children": []}, {"name": "Instance Enumeration", "id": "Instance Enumeration", "path": "/datasources/DS0030/#Instance Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Instance Metadata", "id": "Instance Metadata", "path": "/datasources/DS0030/#Instance Metadata", "domains": ["enterprise"], "children": []}, {"name": "Instance Modification", "id": "Instance Modification", "path": "/datasources/DS0030/#Instance Modification", "domains": ["enterprise"], "children": []}, {"name": "Instance Start", "id": "Instance Start", "path": "/datasources/DS0030/#Instance Start", "domains": ["enterprise"], "children": []}, {"name": "Instance Stop", "id": "Instance Stop", "path": "/datasources/DS0030/#Instance Stop", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Internet Scan", "id": "DS0035", "path": "/datasources/DS0035/", "children": [{"name": "Response Content", "id": "Response Content", "path": "/datasources/DS0035/#Response Content", "domains": ["enterprise"], "children": []}, {"name": "Response Metadata", "id": "Response Metadata", "path": "/datasources/DS0035/#Response Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Kernel", "id": "DS0008", "path": "/datasources/DS0008/", "children": [{"name": "Kernel Module Load", "id": "Kernel Module Load", "path": "/datasources/DS0008/#Kernel Module Load", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Logon Session", "id": "DS0028", "path": "/datasources/DS0028/", "children": [{"name": "Logon Session Creation", "id": "Logon Session Creation", "path": "/datasources/DS0028/#Logon Session Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Logon Session Metadata", "id": "Logon Session Metadata", "path": "/datasources/DS0028/#Logon Session Metadata", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Malware Repository", "id": "DS0004", "path": "/datasources/DS0004/", "children": [{"name": "Malware Content", "id": "Malware Content", "path": "/datasources/DS0004/#Malware Content", "domains": ["enterprise"], "children": []}, {"name": "Malware Metadata", "id": "Malware Metadata", "path": "/datasources/DS0004/#Malware Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Module", "id": "DS0011", "path": "/datasources/DS0011/", "children": [{"name": "Module Load", "id": "Module Load", "path": "/datasources/DS0011/#Module Load", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Named Pipe", "id": "DS0023", "path": "/datasources/DS0023/", "children": [{"name": "Named Pipe Metadata", "id": "Named Pipe Metadata", "path": "/datasources/DS0023/#Named Pipe Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Network Share", "id": "DS0033", "path": "/datasources/DS0033/", "children": [{"name": "Network Share Access", "id": "Network Share Access", "path": "/datasources/DS0033/#Network Share Access", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Network Traffic", "id": "DS0029", "path": "/datasources/DS0029/", "children": [{"name": "Network Connection Creation", "id": "Network Connection Creation", "path": "/datasources/DS0029/#Network Connection Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Content", "id": "Network Traffic Content", "path": "/datasources/DS0029/#Network Traffic Content", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Flow", "id": "Network Traffic Flow", "path": "/datasources/DS0029/#Network Traffic Flow", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Operational Databases", "id": "DS0040", "path": "/datasources/DS0040/", "children": [{"name": "Device Alarm", "id": "Device Alarm", "path": "/datasources/DS0040/#Device Alarm", "domains": ["ics"], "children": []}, {"name": "Process History/Live Data", "id": "Process History/Live Data", "path": "/datasources/DS0040/#Process History/Live Data", "domains": ["ics"], "children": []}, {"name": "Process/Event Alarm", "id": "Process/Event Alarm", "path": "/datasources/DS0040/#Process/Event Alarm", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Persona", "id": "DS0021", "path": "/datasources/DS0021/", "children": [{"name": "Social Media", "id": "Social Media", "path": "/datasources/DS0021/#Social Media", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Pod", "id": "DS0014", "path": "/datasources/DS0014/", "children": [{"name": "Pod Creation", "id": "Pod Creation", "path": "/datasources/DS0014/#Pod Creation", "domains": ["enterprise"], "children": []}, {"name": "Pod Enumeration", "id": "Pod Enumeration", "path": "/datasources/DS0014/#Pod Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Pod Modification", "id": "Pod Modification", "path": "/datasources/DS0014/#Pod Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Process", "id": "DS0009", "path": "/datasources/DS0009/", "children": [{"name": "OS API Execution", "id": "OS API Execution", "path": "/datasources/DS0009/#OS API Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Access", "id": "Process Access", "path": "/datasources/DS0009/#Process Access", "domains": ["enterprise"], "children": []}, {"name": "Process Creation", "id": "Process Creation", "path": "/datasources/DS0009/#Process Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Metadata", "id": "Process Metadata", "path": "/datasources/DS0009/#Process Metadata", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Modification", "id": "Process Modification", "path": "/datasources/DS0009/#Process Modification", "domains": ["enterprise"], "children": []}, {"name": "Process Termination", "id": "Process Termination", "path": "/datasources/DS0009/#Process Termination", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Scheduled Job", "id": "DS0003", "path": "/datasources/DS0003/", "children": [{"name": "Scheduled Job Creation", "id": "Scheduled Job Creation", "path": "/datasources/DS0003/#Scheduled Job Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Scheduled Job Metadata", "id": "Scheduled Job Metadata", "path": "/datasources/DS0003/#Scheduled Job Metadata", "domains": ["enterprise"], "children": []}, {"name": "Scheduled Job Modification", "id": "Scheduled Job Modification", "path": "/datasources/DS0003/#Scheduled Job Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Script", "id": "DS0012", "path": "/datasources/DS0012/", "children": [{"name": "Script Execution", "id": "Script Execution", "path": "/datasources/DS0012/#Script Execution", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Sensor Health", "id": "DS0013", "path": "/datasources/DS0013/", "children": [{"name": "Host Status", "id": "Host Status", "path": "/datasources/DS0013/#Host Status", "domains": ["enterprise", "mobile"], "children": []}], "domains": ["enterprise", "mobile"]}, {"name": "Service", "id": "DS0019", "path": "/datasources/DS0019/", "children": [{"name": "Service Creation", "id": "Service Creation", "path": "/datasources/DS0019/#Service Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Metadata", "id": "Service Metadata", "path": "/datasources/DS0019/#Service Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Modification", "id": "Service Modification", "path": "/datasources/DS0019/#Service Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Snapshot", "id": "DS0020", "path": "/datasources/DS0020/", "children": [{"name": "Snapshot Creation", "id": "Snapshot Creation", "path": "/datasources/DS0020/#Snapshot Creation", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Deletion", "id": "Snapshot Deletion", "path": "/datasources/DS0020/#Snapshot Deletion", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Enumeration", "id": "Snapshot Enumeration", "path": "/datasources/DS0020/#Snapshot Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Metadata", "id": "Snapshot Metadata", "path": "/datasources/DS0020/#Snapshot Metadata", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Modification", "id": "Snapshot Modification", "path": "/datasources/DS0020/#Snapshot Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "User Account", "id": "DS0002", "path": "/datasources/DS0002/", "children": [{"name": "User Account Authentication", "id": "User Account Authentication", "path": "/datasources/DS0002/#User Account Authentication", "domains": ["enterprise", "ics"], "children": []}, {"name": "User Account Creation", "id": "User Account Creation", "path": "/datasources/DS0002/#User Account Creation", "domains": ["enterprise"], "children": []}, {"name": "User Account Deletion", "id": "User Account Deletion", "path": "/datasources/DS0002/#User Account Deletion", "domains": ["enterprise"], "children": []}, {"name": "User Account Metadata", "id": "User Account Metadata", "path": "/datasources/DS0002/#User Account Metadata", "domains": ["enterprise"], "children": []}, {"name": "User Account Modification", "id": "User Account Modification", "path": "/datasources/DS0002/#User Account Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "User Interface", "id": "DS0042", "path": "/datasources/DS0042/", "children": [{"name": "Permissions Request", "id": "Permissions Request", "path": "/datasources/DS0042/#Permissions Request", "domains": ["mobile"], "children": []}, {"name": "System Notifications", "id": "System Notifications", "path": "/datasources/DS0042/#System Notifications", "domains": ["mobile"], "children": []}, {"name": "System Settings", "id": "System Settings", "path": "/datasources/DS0042/#System Settings", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Volume", "id": "DS0034", "path": "/datasources/DS0034/", "children": [{"name": "Volume Creation", "id": "Volume Creation", "path": "/datasources/DS0034/#Volume Creation", "domains": ["enterprise"], "children": []}, {"name": "Volume Deletion", "id": "Volume Deletion", "path": "/datasources/DS0034/#Volume Deletion", "domains": ["enterprise"], "children": []}, {"name": "Volume Enumeration", "id": "Volume Enumeration", "path": "/datasources/DS0034/#Volume Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Volume Metadata", "id": "Volume Metadata", "path": "/datasources/DS0034/#Volume Metadata", "domains": ["enterprise"], "children": []}, {"name": "Volume Modification", "id": "Volume Modification", "path": "/datasources/DS0034/#Volume Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Web Credential", "id": "DS0006", "path": "/datasources/DS0006/", "children": [{"name": "Web Credential Creation", "id": "Web Credential Creation", "path": "/datasources/DS0006/#Web Credential Creation", "domains": ["enterprise"], "children": []}, {"name": "Web Credential Usage", "id": "Web Credential Usage", "path": "/datasources/DS0006/#Web Credential Usage", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Windows Registry", "id": "DS0024", "path": "/datasources/DS0024/", "children": [{"name": "Windows Registry Key Access", "id": "Windows Registry Key Access", "path": "/datasources/DS0024/#Windows Registry Key Access", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Creation", "id": "Windows Registry Key Creation", "path": "/datasources/DS0024/#Windows Registry Key Creation", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Deletion", "id": "Windows Registry Key Deletion", "path": "/datasources/DS0024/#Windows Registry Key Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "Windows Registry Key Modification", "id": "Windows Registry Key Modification", "path": "/datasources/DS0024/#Windows Registry Key Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "WMI", "id": "DS0005", "path": "/datasources/DS0005/", "children": [{"name": "WMI Creation", "id": "WMI Creation", "path": "/datasources/DS0005/#WMI Creation", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}]}, "notes": null, "created": "20 October 2021", "modified": "25 April 2025", "name": "Windows Registry", "version": "1.0", "descr": "A Windows OS hierarchical database that stores much of the information and settings for software programs, hardware devices, user preferences, and operating-system configurations(Citation: Microsoft Registry)", "platforms": "Windows", "collection_layers": "Host", "datacomponents_list": [{"name": "Windows Registry Key Access", "descr": "The action of opening a specific Windows Registry key, typically to read its associated value. This activity can be used for system configuration, application settings retrieval, and security policies.\n\n*Data Collection Measures:*\n\n- Windows Event Logs\n    - Event ID 4656 - Handle to an Object was Requested: Logs attempts to open registry keys.\n    - Event ID 4663 - An Object was Accessed: Captures read/write operations on registry keys.\n    - Event ID 4657 - Registry Value Modification: Useful for detecting changes to registry keys after being accessed.\n- Sysmon\n    - Sysmon Event ID 13 - Registry Value Set: Captures modifications to existing registry keys.\n- Endpoint Detection and Response (EDR) Solutions\n    - Provide telemetry on registry key access activities, especially when linked to suspicious processes.", "techniques": [{"technique_used": true, "domain": "enterprise", "id": "T1652", "name": "Device Driver Discovery", "descr": "Monitor for attempts to access information stored in the Registry about devices and their associated drivers, such as values under `HKLM\\SYSTEM\\CurrentControlSet\\Services` and `HKLM\\SYSTEM\\CurrentControlSet\\HardwareProfiles`.(Citation: Microsoft Registry Drivers)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1003", "name": "OS Credential Dumping", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Security Account Manager", "descr": "Monitor for the SAM registry key dump being created to access stored account password hashes. Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses. Others will make an in-memory copy of the SAM table before reading hashes. Detection of compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use by adversaries may help as well.\n\nAnalytic 1 - Unauthorized registry access to SAM key.\n\n<code> index=security sourcetype=\"WinEventLog:Security\" EventCode=4663 ObjectName=\"*\\\\SAM\" | where ProcessName IN (\"reg.exe\", \"powershell.exe\", \"wmic.exe\", \"schtasks.exe\", \"cmd.exe\", \"rundll32.exe\", \"mimikatz.exe\", \"procdump.exe\") </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "LSA Secrets", "descr": "Monitor for the LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets</code> being accessed\n\nAnalytic 1 - Unauthorized registry access to LSA secrets.\n\n<code> index=security sourcetype=\"WinEventLog:Security\" EventCode=4663 ObjectName=\"*\\\\Policy\\\\Secrets*\" | where ProcessName IN (\"reg.exe\", \"powershell.exe\", \"wmic.exe\", \"schtasks.exe\", \"cmd.exe\", \"rundll32.exe\", \"mimikatz.exe\", \"procdump.exe\") </code>", "subtechniques": [], "color": 1}], "descr": "Monitor for the SAM registry key being accessed that may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.\n\nAnalytic 1 - Unauthorized registry access to SAM key.\n\n<code> index=security sourcetype=\"WinEventLog:Security\" EventCode=4663 ObjectName=\"*\\\\SAM\" | where ProcessName IN (\"mimikatz.exe\", \"procdump.exe\", \"reg.exe\", \"powershell.exe\", \"wmic.exe\", \"schtasks.exe\", \"cmd.exe\") </code>"}, {"technique_used": true, "domain": "enterprise", "id": "T1012", "name": "Query Registry", "descr": "Monitor for unexpected process interactions with the Windows Registry (i.e. reads) that may be related to gathering information.\n\nNote: For Security Auditing event ids 4656 and 4663, a System Access Control List (SACL) that controls the use of specific access rights such as Enumerate sub-keys and Query key value is required for event generation. Depending on the Registry key you are monitoring, the implementation of a new System Access Control List (SACL) might be required. Depending of Registry key used for the creation of a System Access Control List (SACL), the generation of event ids 4656 and 4663 might be noisy.\n\nAnalytic 1 - Suspicious Registry\n\n<code>(sourcetype=\"WinEventLog:Security\" EventCode IN (4663, 4656)) AND ObjectType=\"Key\" | WHERE ObjectName LIKE \"%SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall%\" AND (UserAccessList LIKE \"%4435%\" OR UserAccessList LIKE \"%Enumerate sub-keys%\" OR UserAccessList LIKE \"%4432%\" OR UserAccessList LIKE \"%Query key value%\") AND Image NOT IN ('FilePathToExpectedProcess01.exe','FilePathToExpectedProcess02.exe')</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1649", "name": "Steal or Forge Authentication Certificates", "descr": "Monitor for attempts to access information stored in the Registry about certificates and their associated private keys. For example, user certificates are commonly stored under `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\SystemCertificates`.(Citation: SpecterOps Certified Pre Owned)(Citation: O365 Blog Azure AD Device IDs)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1614", "name": "System Location Discovery", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "System Language Discovery", "descr": "Monitor for access to windows registry keys that may attempt to gather information about the system language of a victim in order to infer the geographical location of that host.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1033", "name": "System Owner/User Discovery", "descr": "Monitor for the SAM registry key being accessed that may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1552", "name": "Unsecured Credentials", "descr": "Monitor for unexpected windows registry key being accessed that may search compromised systems to find and obtain insecurely stored credentials.\n\nAnalytic 1 - Unauthorized access to registry keys associated with credentials.\n\n<code> index=security sourcetype=\"WinEventLog:Microsoft-Windows-Security-Auditing\" EventCode=4663 ObjectType=\"Registry\" (ObjectName=\"*password*\" OR ObjectName=\"*credential*\") | eval AccessAttempt=case(\n    AccessMask=\"0x1\", \"Read\",\n    AccessMask=\"0x2\", \"Write\",\n    AccessMask=\"0x3\", \"Read/Write\",\n    AccessMask=\"0x4\", \"Delete\",\n    true(), \"Unknown\"\n)</code>", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Credentials in Registry", "descr": "Monitor for unexpected windows registry key being accessed that may search the Registry on compromised systems for insecurely stored credentials.\n\nAnalytic 1 - Unauthorized access to registry keys associated with credentials.\n\n<code> ndex=security sourcetype=\"WinEventLog:Microsoft-Windows-Security-Auditing\" EventCode=4663 ObjectType=\"Registry\" (ObjectName=\"*password*\" OR ObjectName=\"*credential*\")\n| eval AccessType=case(\n    AccessMask=\"0x1\", \"Read\",\n    AccessMask=\"0x2\", \"Write\",\n    AccessMask=\"0x3\", \"Read/Write\",\n    AccessMask=\"0x4\", \"Delete\",\n    true(), \"Unknown\"\n)</code>", "subtechniques": [], "color": 1}], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Windows Registry Key Creation", "descr": "Initial construction of a new registry key within the Windows operating system. \n\n*Data Collection Measures:* \n\n- Windows Event Logs\n    - Event ID 4656 - Registry Object Handle Requested: Tracks registry key access, including newly created keys.\n    - Event ID 4657 - Registry Value Modification: Detects modifications to an existing registry key after creation.\n- Sysmon (System Monitor) for Windows\n    - Sysmon Event ID 12 - Registry Key Created: Logs when a new registry key is created.\n", "techniques": [{"domain": "enterprise", "id": "T1547", "name": "Boot or Logon Autostart Execution", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Registry Run Keys / Startup Folder", "descr": "Monitor for newly created windows registry keys that may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "014", "name": "Active Setup", "descr": "Monitor Registry key additions to <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\</code>.\nTools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the Active Setup Registry locations and startup folders.(Citation: TechNet Autoruns) Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.", "subtechniques": [], "color": 1}], "descr": "Monitor for additions of mechanisms that could be used to trigger autostart execution, such as relevant additions to the Registry."}, {"technique_used": true, "domain": "enterprise", "id": "T1037", "name": "Boot or Logon Initialization Scripts", "descr": "Monitor for newly constructed windows registry keys that may use scripts automatically executed at boot or logon initialization to establish persistence.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Logon Script (Windows)", "descr": "Monitor for the creation to Registry keys associated with Windows logon scrips, nameley <code>HKCU\\Environment\\UserInitMprLogonScript</code>.\n\nAdversaries may schedule software to run whenever a user logs into the system; this is done to establish persistence and sometimes for lateral movement. This trigger is established through the registry key HKEY_CURRENT_USER\\EnvironmentUserInitMprLogonScript. This signature looks edits to existing keys or creation of new keys in that path. Users purposefully adding benign scripts to this path will result in false positives; that case is rare, however. There are other ways of running a script at startup or login that are not covered in this signature. Note that this signature overlaps with the Windows Sysinternals Autoruns tool, which would also show changes to this registry path.\n\nAnalytic 1 - Boot or Logon Initialization Scripts\n\n<code> (sourcetype=WinEventLog:Microsoft-Windows-Sysmon/Operational EventCode IN (12, 14, 13)) TargetObject= \"*\\Environment*UserInitMprLogonScript\")  </code>", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1543", "name": "Create or Modify System Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Windows Service", "descr": "Monitor for new constructed windows registry keys that may create or modify Windows services to repeatedly execute malicious payloads as part of persistence.\n\nAnalytic 1 - Creation of the HKLM\\System\\CurrentControlSet\\Services Registry key\n\n<code> sourcetype=WinEventLog:Microsoft-Windows-Sysmon/Operational EventCode=\"12\" TargetObject=\"HKLM\\System\\CurrentControlSet\\Services\\*\"</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed windows registry keys that may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence."}, {"domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Disable Windows Event Logging", "descr": "Monitor the addition of the MiniNT registry key in HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control, which may disable Event Viewer.(Citation: def_ev_win_event_logging)(Citation: disable_win_evt_logging) ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "009", "name": "Safe Mode Boot", "descr": "Monitor Registry creation for services that may start on safe mode. For example, a program can be forced to start on safe mode boot by adding a <code>\\*</code> in front of the \"Startup\" value name: <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\[\"\\*Startup\"=\"{Path}\"]</code> or by adding a key to <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal</code>.(Citation: BleepingComputer REvil 2021)(Citation: Sophos Snatch Ransomware 2019)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1556", "name": "Modify Authentication Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "008", "name": "Network Provider DLL", "descr": "Monitor for the addition of network provider Registry keys (e.g., `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<NetworkProviderName>\\NetworkProvider`).", "subtechniques": [], "color": 1}], "descr": "Monitor for the addition of network provider Registry keys (e.g., `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<NetworkProviderName>\\NetworkProvider`).\n\nAnalytic 1 - Unauthorized addition of network provider Registry keys.\n\n<code> sourcetype=WinEventLog:Security\n(EventCode=4663 OR EventCode=4657) \n| eval registry_path=mvindex(split(ObjectName,\"\\\\\"), 0, mvcount(split(ObjectName,\"\\\\\"))-1)\n| search registry_path IN (\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\", \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Authentication\", \"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanWorkstation\\\\Parameters\")\n</code>"}, {"technique_used": true, "domain": "enterprise", "id": "T1112", "name": "Modify Registry", "descr": "Monitor for newly constructed registry keys or values to aid in persistence and execution - for example, the creation of the registry key `HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\SafeDllSearchMode`. The key SafeDllSearchMode, if set to 0, will block the Windows mechanism for the search DLL order and adversaries may execute their own malicious dll.\n\nAnalytic 1 - Registry Edit with Creation of SafeDllSearchMode Key Set to 0\n\n<code>((source=\"*WinEventLog:Security\" EventCode=\"4657\")(ObjectValueName=\"SafeDllSearchMode\" value=\"0\")) OR \n((source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"13\") EventType=\"SetValue\" TargetObject=\"*SafeDllSearchMode\" Details=\"DWORD (0x00000000)\")))</code>", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1027", "name": "Obfuscated Files or Information", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "011", "name": "Fileless Storage", "descr": "Monitor for the creation of Registry values that may highlight storage of malicious data such as commands or payloads.", "subtechniques": [], "color": 1}], "descr": "Monitor for the creation of Registry values that may highlight storage of malicious data such as commands or payloads."}, {"domain": "enterprise", "id": "T1137", "name": "Office Application Startup", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Office Template Macros", "descr": "Collect events related to Registry key creation for keys that could be used for Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Today Home Page)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Office Test", "descr": "Monitor for the creation of the Office Test Registry key. Collect events related to Registry key creation for keys that could be used for Office-based persistence. Since v13.52, Autoruns can detect tasks set up using the Office Test Registry key.(Citation: Palo Alto Office Test Sofacy)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Add-ins", "descr": "Audit the Registry entries relevant for enabling add-ins.(Citation: GlobalDotName Jun 2019)(Citation: MRWLabs Office Persistence Add-ins)", "subtechniques": [], "color": 1}], "descr": "Many Office-related persistence mechanisms require changes to the Registry and for binaries, files, or scripts to be written to disk or existing files modified to include malicious scripts. Collect events related to Registry key creation and modification for keys that could be used for Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Today Home Page)"}, {"domain": "enterprise", "id": "T1053", "name": "Scheduled Task/Job", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Scheduled Task", "descr": "Monitor for newly constructed registry keys upon creation of new task. Deletion of values/keys in the registry may further indicate malicious activity.\n\nAnalytic 1 - Suspicious Creations under Schedule Registry Key\n\n<code>((source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"12\") OR (sourcetype=WinEventLog:Security EventCode=4657) | search (registry_path=\"HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Schedule\\\\TaskCache\\\\Tree\\\\*\" OR registry_path=\"HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Schedule\\\\TaskCache\\\\Tasks\\\\*\")</code>\n\n", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1176", "name": "Software Extensions", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Browser Extensions", "descr": "Monitor for any new items written to the Registry or PE files written to disk. That may correlate with browser extension installation.\n\nChrome extension registry keys under: HKCU\\Software\\Google\\Chrome\\Extensions\nFirefox entries under: HKCU\\Software\\Mozilla\\Firefox\\Extensions\nUnexpected changes or new GUIDs\n\nAnalytic 1 - browser registry keys created \n\n<code> sourcetype=WinEventLog:Sysmon EventCode=13\n(TargetObject=\"*\\\\Software\\\\Google\\\\Chrome\\\\Extensions\\\\*\" OR TargetObject=\"*\\\\Software\\\\Mozilla\\\\Firefox\\\\Extensions\\\\*\")\n| stats count by TargetObject, Details, User, Computer, _time\n| sort -_time\n</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for any new items written to the Registry or PE files written to disk. That may correlate with extension installation. "}, {"technique_used": true, "domain": "enterprise", "id": "T1553", "name": "Subvert Trust Controls", "descr": "Monitoring the creation of (sub)keys within the Windows Registry may reveal malicious attempts to modify trust settings, such as the installation of root certificates. Installed root certificates are located in the Registry under\u00a0<code>HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\</code>\u00a0and\u00a0</code>[HKLM or HKCU]\\Software[\\Policies\\]\\Microsoft\\SystemCertificates\\Root\\Certificates\\</code>. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison:\u00a0(Citation: Tripwire AppUNBlocker)\n* 18F7C1FCC3090203FD5BAA2F861A754976C8DD25\n* 245C97DF7514E7CF2DF8BE72AE957B9E04741E85\n* 3B1EFD3A66EA28B16697394703A72CA340A05BD5\n* 7F88CD7223F3C813818C994614A89C99FA3B5247\n* 8F43288AD272F3103B6FB1428485EA3014C0BCFE\n* A43489159A520F0D93D032CCAF37E7FE20A8B419\n* BE36A4562FB2EE05DBB3D32323ADF445084ED656\n* CDD4EEAE6000AC7F40C3802C171E30148030C072", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "004", "name": "Install Root Certificate", "descr": "Monitoring the creation of (sub)keys within the Windows Registry may reveal malicious root certificate installation. Installed root certificates are located in the Registry under\u00a0\n```HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\```\u00a0and\u00a0\n```HKLM\\SOFTWARE\\Microsoft\\SystemCertificates\\Root\\Certificates\\``` or ```HKCU\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates\\```\n\nThere are a subset of root certificates that are consistent across Windows systems and can be used for comparison:\u00a0(Citation: Tripwire AppUNBlocker)\n* 18F7C1FCC3090203FD5BAA2F861A754976C8DD25\n* 245C97DF7514E7CF2DF8BE72AE957B9E04741E85\n* 3B1EFD3A66EA28B16697394703A72CA340A05BD5\n* 7F88CD7223F3C813818C994614A89C99FA3B5247\n* 8F43288AD272F3103B6FB1428485EA3014C0BCFE\n* A43489159A520F0D93D032CCAF37E7FE20A8B419\n* BE36A4562FB2EE05DBB3D32323ADF445084ED656\n* CDD4EEAE6000AC7F40C3802C171E30148030C072", "subtechniques": [], "color": 1}], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Windows Registry Key Deletion", "descr": "The removal of a registry key within the Windows operating system.\n\n*Data Collection Measures:*\n\n- Windows Event Logs\n    - Event ID 4658 - Registry Key Handle Closed: Captures when a handle to a registry key is closed, which may indicate deletion.\n    - Event ID 4660 - Object Deleted: Logs when a registry key is deleted.\n- Sysmon (System Monitor) for Windows\n    - Sysmon Event ID 12 - Registry Key Deleted: Logs when a registry key is removed.\n    - Sysmon Event ID 13 - Registry Value Deleted: Captures removal of specific registry values.\n- Endpoint Detection and Response (EDR) Solutions\n    - Monitor registry deletions for suspicious behavior.", "techniques": [{"technique_used": true, "domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "descr": "Monitor for unexpected deletion of windows registry keys that that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Disable or Modify Tools", "descr": "Monitor for deletion of Windows Registry keys and/or values related to services and startup programs that correspond to security tools such as HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1070", "name": "Indicator Removal", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "009", "name": "Clear Persistence", "descr": "Monitor windows registry keys that may be deleted or alter generated artifacts associated with persistence on a host system. ", "subtechniques": [], "color": 1}], "descr": "Monitor windows registry keys that may be deleted or alter generated artifacts on a host system, including logs or captured files such as quarantined malware."}, {"technique_used": true, "domain": "ics", "id": "T0872", "name": "Indicator Removal on Host", "descr": "Monitor Windows registry keys that may be deleted or alter generated artifacts on a host system, including logs or captured files such as quarantined malware. For added context on adversary procedures and background see [Indicator Removal on Host Mitigation](https://attack.mitre.org/mitigations/T1070) and applicable sub-techniques.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1112", "name": "Modify Registry", "descr": "Monitor for unexpected deletion of windows registry keys to hide configuration information, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution. ", "subtechniques": [], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise", "ics"]}, {"name": "Windows Registry Key Modification", "descr": "Changes made to an existing registry key or its values. These modifications can include altering permissions, modifying stored data, or updating configuration settings.\n\n*Data Collection Measures:*\n\n- Windows Event Logs\n    - Event ID 4657 - Registry Value Modified: Logs changes to registry values, including modifications to startup entries, security settings, or system configurations.\n- Sysmon (System Monitor) for Windows\n    - Sysmon Event ID 13 - Registry Value Set: Captures changes to specific registry values.\n    - Sysmon Event ID 14 - Registry Key & Value Renamed: Logs renaming of registry keys, which may indicate evasion attempts.\n- Endpoint Detection and Response (EDR) Solutions\n    - Monitor registry modifications for suspicious behavior.", "techniques": [{"domain": "enterprise", "id": "T1548", "name": "Abuse Elevation Control Mechanism", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Bypass User Account Control", "descr": "Some UAC bypass methods rely on modifying specific, user-accessible Registry settings. For example:\n* The <code>eventvwr.exe</code> bypass uses the <code>[HKEY_CURRENT_USER]\\Software\\Classes\\mscfile\\shell\\open\\command</code> Registry key.(Citation: enigma0x3 Fileless UAC Bypass)\n* The <code>sdclt.exe</code> bypass uses the <code>[HKEY_CURRENT_USER]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\control.exe</code> and <code>[HKEY_CURRENT_USER]\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand</code> Registry keys.(Citation: enigma0x3 sdclt app paths)(Citation: enigma0x3 sdclt bypass)\nAnalysts should monitor these Registry settings for unauthorized changes.\n\nUAC Bypass is an interesting technique in that new implementations are regularly found and existing implementations may be fixed (i.e., patched) by Microsoft in new builds of Windows. Therefore, it is important to validate than detections for UAC Bypass are still relevant (i.e., they target non-patched implementations). \n\nNote: Sysmon Event ID 12 (Registry Key Create/Delete), Sysmon Event ID 13 (Registry Value Set), and Sysmon Event ID 14 (Registry Key and Value Rename) are useful for creating detections around Registry Key Modification in the context of UAC Bypass.", "subtechniques": [], "color": 1}], "descr": "There are many ways to perform UAC bypasses when a user is in the local administrator group on a system, so it may be difficult to target detection on all variations. Efforts should likely be placed on mitigation and collecting enough information on process launches and actions that could be performed before and after a UAC bypass is performed. Some UAC bypass methods rely on modifying specific, user-accessible Registry settings. Analysts should monitor Registry settings for unauthorized changes."}, {"technique_used": true, "domain": "enterprise", "id": "T1557", "name": "Adversary-in-the-Middle", "descr": "Monitor HKLM\\Software\\Policies\\Microsoft\\Windows NT\\DNSClient for changes to the \"EnableMulticast\" DWORD value. A value of \"0\" indicates LLMNR is disabled.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "LLMNR/NBT-NS Poisoning and SMB Relay", "descr": "Monitor HKLM\\Software\\Policies\\Microsoft\\Windows NT\\DNSClient for changes to the \"EnableMulticast\" DWORD value. A value of \"0\" indicates LLMNR is disabled.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0830", "name": "Adversary-in-the-Middle", "descr": "Monitor HKLM\\Software\\Policies\\Microsoft\\Windows NT\\DNSClient for changes to the \"EnableMulticast\" DWORD value. A value of \"0\" indicates LLMNR is disabled.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1547", "name": "Boot or Logon Autostart Execution", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Registry Run Keys / Startup Folder", "descr": "Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, etc. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations. (Citation: TechNet Autoruns)\n\nDetection of the modification of the registry key\u00a0<code>Common Startup</code>\u00a0located in HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\\\u00a0and\u00a0HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\\. When a user logs on, any files located in the Startup Folder are launched. Attackers may modify these folders with other files in order to evade detection set on these default folders. This detection focuses on EventIDs 4688 and 1 for process creation and EventID 4657 for the modification of the Registry Keys.\n\nAnalytic 1 - Modification of Default Startup Folder in the Registry Key \u2018Common Startup\u2019\n\n<code>(source=\"*WinEventLog:Security\" EventCode=\"4657\" ObjectValueName=\"Common Startup\") OR (source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"13\" TargetObject=\"*Common Startup\")</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Authentication Package", "descr": "Monitor the Registry for changes to the LSA Registry keys. Windows 8.1 and Windows Server 2012 R2 may generate events when unsigned DLLs try to load into the LSA by setting the Registry key <code>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe</code> with AuditLevel = 8. (Citation: Graeber 2014) (Citation: Microsoft Configure LSA)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Time Providers", "descr": "Monitor for changes made to windows registry keys and/or values modifying W32Time information in the Registry.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Winlogon Helper DLL", "descr": "Monitor for changes to Registry entries associated with Winlogon that do not correlate with known software, patch cycles, etc. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing current Winlogon helper values. (Citation: TechNet Autoruns)\n\nAnalytic 1 - Registry Edit with Modification of Userinit, Shell or Notify\n\n<code>source=\"*WinEventLog:Security\" EventCode=\"4657\" (ObjectValueName=\"Userinit\" OR ObjectValueName=\"Shell\" OR ObjectValueName=\"Notify\") OR source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"13\" (TargetObject=\"*Userinit\" OR TargetObject=\"*Shell\" OR TargetObject=\"*Notify\")</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Security Support Provider", "descr": "Monitor the Registry for changes to the SSP Registry keys. Windows 8.1 and Windows Server 2012 R2 may generate events when unsigned SSP DLLs try to load into the LSA by setting the Registry key <code>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LSASS.exe</code> with AuditLevel = 8. (Citation: Graeber 2014) (Citation: Microsoft Configure LSA)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "010", "name": "Port Monitors", "descr": "Monitor Registry writes to <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors</code>. Run the Autoruns utility, which checks for this Registry key as a persistence mechanism (Citation: TechNet Autoruns)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "012", "name": "Print Processors", "descr": "Monitor Registry writes to <code>HKLM\\SYSTEM\\ControlSet001\\Control\\Print\\Environments\\\\[Windows architecture]\\Print Processors\\\\[user defined]\\\\Driver</code> or <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\\\[Windows architecture]\\Print Processors\\\\[user defined]\\Driver</code> as they pertain to print processor installations.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "014", "name": "Active Setup", "descr": "Monitor Registry key modifications to <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\</code>.\nTools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the Active Setup Registry locations and startup folders.(Citation: TechNet Autoruns) Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.", "subtechniques": [], "color": 1}], "descr": "Monitor for modifications of mechanisms that could be used to trigger autostart execution, such as relevant additions to the Registry."}, {"domain": "enterprise", "id": "T1543", "name": "Create or Modify System Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Windows Service", "descr": "Look for changes to service Registry entries that do not correlate with known software, patch cycles, etc. Service information is stored in the Registry at <code>HKLM\\SYSTEM\\CurrentControlSet\\Services</code>. Changes to the binary path and the service startup type changed from manual or disabled to automatic, if it does not typically do so, may be suspicious. Tools such as Sysinternals Autoruns may also be used to detect system service changes that could be attempts at persistence.(Citation: TechNet Autoruns)\n\nAnalytic 1 - Modification of the HKLM\\System\\CurrentControlSet\\Services Registry key\n\n<code> (sourcetype=WinEventLog:Microsoft-Windows-Sysmon/Operational EventCode IN (13, 14) EventType= \"SetValue\" TargetObject=\"HKLM\\System\\CurrentControlSet\\Services\\*\" | where RegistryKeyPath LIKE \"%ImagePath%\" OR \n   RegistryKeyPath LIKE \"%Type%\" OR\n   RegistryKeyPath LIKE \"%DisplayName%\" OR\n   RegistryKeyPath LIKE \"%Objectname%\"</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for changes to windows registry keys and/or values that may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence."}, {"domain": "enterprise", "id": "T1074", "name": "Data Staged", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Local Data Staging", "descr": "Consider monitoring accesses and modifications to local storage repositories (such as the Windows Registry), especially from suspicious processes that could be related to malicious data collection.", "subtechniques": [], "color": 1}], "descr": "Consider monitoring accesses and modifications to local storage repositories (such as the Windows Registry), especially from suspicious processes that could be related to malicious data collection."}, {"domain": "enterprise", "id": "T1546", "name": "Event Triggered Execution", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Change Default File Association", "descr": "Collect and analyze changes to Registry keys that associate file extensions to default applications for execution and correlate with unknown process launch activity or unusual file types for that process. User file association preferences are stored under <code> [HKEY_CURRENT_USER]\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts</code> and override associations configured under <code>[HKEY_CLASSES_ROOT]</code>. Changes to a user's preference will occur under this entry's subkeys.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Screensaver", "descr": "Monitor changes to screensaver configuration changes in the Registry that may not correlate with typical user behavior. Tools such as Sysinternals Autoruns can be used to detect changes to the screensaver binary path in the Registry. Default screen saver files are stored in C:\\Windows\\System32. Use these files as a reference when defining list of not suspicious screen saver files.\n\nAnalytic 1 - Registry Edit from Screensaver\n\n<code>source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode IN (13, 14) TargetObject=\"*\\Software\\Policies\\Microsoft\\Windows\\Control Panel\\Desktop\\SCRNSAVE.EXE\"</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "Netsh Helper DLL", "descr": "Monitor the <code>HKLM\\SOFTWARE\\Microsoft\\Netsh</code> registry key for any new or suspicious entries that do not correlate with known system files or benign software. (Citation: Demaske Netsh Persistence)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Accessibility Features", "descr": "Monitor Registry keys within <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options</code>.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "009", "name": "AppCert DLLs", "descr": "Monitor the AppCertDLLs Registry value for modifications that do not correlate with known software, patch cycles, etc.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "010", "name": "AppInit DLLs", "descr": "Monitor the AppInit_DLLs Registry values for modifications that do not correlate with known software, patch cycles, etc. Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppInit DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the AppInit_DLLs value in the Registry keys HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows or HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows are loaded by user32.dll into every process that loads user32.dll. These values can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes. Accordingly, this analytic looks for modifications to these registry keys that may be indicative of this type of abuse.\n\nAnalytic 1 - AppInit DLLs\n\n<code> source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode IN (12, 13, 14) TargetObject= \"*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Appinit_Dlls\\*\" OR\n  TargetObject= \"*\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Appinit_Dlls\\*\"</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "011", "name": "Application Shimming", "descr": "Monitor for changes to windows registry keys and/or values that may establish persistence and/or elevate privileges by executing malicious content triggered by application shims.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "012", "name": "Image File Execution Options Injection", "descr": "Monitor Registry values associated with IFEOs, as well as silent process exit monitoring, for modifications that do not correlate with known software, patch cycles, etc.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "015", "name": "Component Object Model Hijacking", "descr": "There are opportunities to detect COM hijacking by searching for Registry references that have been replaced and through Registry operations (ex: [Reg](https://attack.mitre.org/software/S0075)) replacing known binary paths with unknown paths or otherwise malicious content. Even though some third-party applications define user COM objects, the presence of objects within HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\ may be anomalous and should be investigated since user objects will be loaded prior to machine objects in HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\.(Citation: Elastic COM Hijacking) Registry entries for existing COM objects may change infrequently. When an entry with a known good path and binary is replaced or changed to an unusual value to point to an unknown binary in a new location, then it may indicate suspicious behavior and should be investigated.\n\nAnalytic 1 - Component Object Model Hijacking\n\n<code> source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode IN (12, 13, 14) TargetObject= \"*\\Software\\Classes\\CLSID\\*\"</code>\n", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to windows registry keys and/or values that may establish persistence and/or elevate privileges using system mechanisms that trigger execution based on specific events."}, {"domain": "enterprise", "id": "T1564", "name": "Hide Artifacts", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Hidden Users", "descr": "Monitor for changes made to windows registry key or values for unexpected modifications of the <code>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList</code> key.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Hidden Window", "descr": "Monitor for changes in Registry keys such as ` HKEY_CURRENT_USER\\Console\\%SystemRoot%_System32_WindowsPowerShell_v1.0_PowerShell.exe` and  ` HKEY_CURRENT_USER\\Console\\%SystemRoot%_SysWOW64_WindowsPowerShell_v1.0_PowerShell.exe `, especially setting the subkey `WindowPosition` to a maximum value or the subkeys `ScreenBufferSize` and `WindowSize` to 1. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Hidden File System", "descr": "Monitor for changes made to windows registry keys and/or values that may use a hidden file system to conceal malicious activity from users and security tools.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Run Virtual Instance", "descr": "Monitor for changes made to Windows Registry keys and/or values that may be the result of using a virtual instance to avoid detection. For example, if virtualization software is installed by the adversary the Registry may provide detection opportunities. ", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to windows registry keys and/or values that may attempt to hide artifacts associated with their behaviors to evade detection."}, {"domain": "enterprise", "id": "T1574", "name": "Hijack Execution Flow", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "007", "name": "Path Interception by PATH Environment Variable", "descr": "Monitor for modifications of PATH environment variable Registry keys such as <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\\Path</code>. An adversary can add a new directory or list of directories before other locations where programs can be executed from.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "011", "name": "Services Registry Permissions Weakness", "descr": "Monitor for modification of Registry keys and values used by services such as HKLM\\SYSTEM\\CurrentControlSet\\Services that may allow adversaries to launch their own code when a service starts.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "012", "name": "COR_PROFILER", "descr": "For detecting system and user scope abuse of the COR_PROFILER variable, monitor the Registry for changes to COR_ENABLE_PROFILING, COR_PROFILER, and COR_PROFILER_PATH that correspond to system and user environment variables that do not correlate to known developer tools.", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to windows registry keys and/or values that may execute their own malicious payloads by hijacking the way operating systems run programs."}, {"domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Disable or Modify Tools", "descr": "Monitor for changes made to Windows Registry keys and/or values related to services and startup programs that correspond to security tools such as HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Disable Windows Event Logging", "descr": "Monitor the addition of the MiniNT registry key in HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control, which may disable Event Viewer.(Citation: def_ev_win_event_logging)\n\nAdversaries may disable Windows event logging to limit data that can be leveraged for detections and audits. There are different ways to perform this attack.\n1. The first one is to create the Registry Key\u00a0HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\MiniNt. This action will not generate Security EventLog 4657 or Sysmon EventLog 13 because the value of the key remains empty. However, if an attacker uses powershell to perform this attack (and not cmd), a Security EventLog 4663 will be generated (but 4663 generates a lot of noise).\n2. The second way is to disable the service EventLog (display name Windows Event Log). After disabed, attacker must reboot the system. The action of disabling or put in manual the service will modify the Registry Key value\u00a0HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\start, therefore Security EventLog 4657 or Sysmon EventLog 13 will be generated on the system.\n3. The third way is linked with the second. By default, the EventLog service cannot be stopped. If an attacker tries to stop the service, this one will restart immediately. Why ? Because to stop completely, this service must stop others, one in particular called netprofm (display name Network List Service). This service remains running until it is disabled. So Attacker must either disable EventLog and after to stop it or disable netprofm and after stop EventLog. Only stopping the service (even as admin) will not have an effect on the EventLog service because of the link with netprofm. Security EventLog 1100 will log the stop of the EventLog service (but also generates a lot of noise because it will generate a log everytime the system shutdown).\n4. The fourth way is to use auditpol.exe to modify the audit configuration and disable/modify important parameters that will lead to disable the creation of EventLog.\n5. The last one is to modify the Registry Key value\u00a0HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\Security\\file\u00a0(or other kind of log) to modify the path where the EventLog are stocked. Importantly, with this technique, the EventViewer will use the value of the Registry Key \u201cfile\u201d to know where to find the Log. Thus, using the EventViewer will always show the current event logs, but the old one will be stocked in another evtx. Also, the path must be in a folder that the Eventlog process has access (like it doesn\u2019t work if attacker set up the new path in the Desktop). Attacker can also decrease the maxsize value of the Log to force the system to rewrite on the older EventLog (but the minimum cannot be less than 1028 KB). As the Registry key is modified, Security EventLog 4657 or Sysmon EventLog 13 will be generated on the system. All of these attacks required administrative right. Attacks number three, four and five do not require a system reboot to be effective immediately.\n\nAnalytic 1 - Disable Windows Event Logging\n\n<code>(source=\"*WinEventLog:Security\" EventCode IN (4657, 4719) OR source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"13\") \n\t(ObjectName=\"*EventLog*\") \n\t(ObjectValueName=\"Start\" OR ObjectValueName=\"File\" OR ObjectValueName=\"MaxSize\")</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Disable or Modify System Firewall", "descr": "Monitor for changes made to windows Registry keys and/or values that adversaries might use to disable or modify System Firewall settings such as `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy`.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Indicator Blocking", "descr": "To detect changes in ETW you can also monitor the registry key which contains configurations for all ETW event providers: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\AUTOLOGGER_NAME\\{PROVIDER_GUID}</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "009", "name": "Safe Mode Boot", "descr": "Monitor modifications to Registry data associated with enabling safe mode. For example, a service can be forced to start on safe mode boot by adding a <code>\\*</code> in front of the \"Startup\" value name: <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\[\"\\*Startup\"=\"{Path}\"]</code> or by adding a key to <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal</code>.(Citation: BleepingComputer REvil 2021)(Citation: Sophos Snatch Ransomware 2019)", "subtechniques": [], "color": 1}], "descr": "Monitor Registry edits for modifications to services and startup programs that correspond to security tools and settings. For example, HVCI (Hypervisor-Protected Code Integrity) can be disabled by modifying the registry key `HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender` to 0, allowing the system to run custom unsigned kernel code.(Citation: welivesecurity)(Citation: Microsoft Security)"}, {"domain": "enterprise", "id": "T1070", "name": "Indicator Removal", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "007", "name": "Clear Network Connection History and Configurations", "descr": "Monitor for changes to Registry keys (ex: <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default</code>) and associated values that may be malicious attempts to conceal adversary network connection history.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "009", "name": "Clear Persistence", "descr": "Monitor for changes made to windows registry keys or values that may delete or alter generated artifacts associated with persistence on a host system.", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to windows registry keys or values that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware."}, {"technique_used": true, "domain": "ics", "id": "T0872", "name": "Indicator Removal on Host", "descr": "Monitor for changes made to Windows Registry keys or values that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware. For added context on adversary procedures and background see [Indicator Removal on Host Mitigation](https://attack.mitre.org/mitigations/T1070) and applicable sub-techniques.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1490", "name": "Inhibit System Recovery", "descr": "Monitor the registry for changes associated with system recovery features (ex: the creation of <code>HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\PreviousVersions\\DisableLocalPage</code>).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1056", "name": "Input Capture", "descr": "Monitor for changes made to windows registry keys or values for unexpected modifications", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Keylogging", "descr": "Monitor for changes made to windows registry keys or values for unexpected modifications", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1556", "name": "Modify Authentication Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Password Filter DLL", "descr": "Monitor for changes to Registry entries for password filters (ex: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages) and correlate then investigate the DLL files these files reference.\n\nAnalytic 1 - Unauthorized modifications to Registry entries for password filters.\n\n<code> index=windows_logs sourcetype=\"WinEventLog:Security\" (EventCode=4657 OR EventCode=4688)\n| search (\n    (TargetObject=\"*\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\\" AND ValueName=\"Notification Packages\")\n    OR (TargetObject=\"*\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\\" AND ValueName=\"Authentication Packages\")\n    OR (CommandLine=\"*reg.exe*\" AND CommandLine=\"*add*\" AND CommandLine=\"*Lsa*\")\n  )\n| eval Modification_Type=case(\n    like(CommandLine, \"%reg.exe% add%\"), \"Command Line Registry Edit\",\n    EventCode=4657, \"Direct Registry Modification\"\n  )</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Network Provider DLL", "descr": "Monitor for changes to Registry entries for network providers (e.g., `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order`) and correlate then investigate the DLL files these values reference.", "subtechniques": [], "color": 1}], "descr": "Monitor for changes to Registry entries for password filters (ex: `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages`) and correlate then investigate the DLL files these files reference.\n\nMonitor for changes to Registry entries for network providers (e.g., `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order`) and correlate then investigate the DLL files these values reference.\n\nAnalytic 1 - Unauthorized modifications to Registry entries for password filters or network providers.\n\n<code> index=wineventlog\n| eval suspicious_activity=if((EventCode=4657 AND (RegistryKeyPath=\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\Notification Packages\" OR RegistryKeyPath=\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\NetworkProvider\\\\Order\")) OR (EventCode=4663 AND AccessMask=\"0x2\" AND (ObjectName=\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\Notification Packages\" OR ObjectName=\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\NetworkProvider\\\\Order\")), \"true\", \"false\")</code>\n\nAnalytic 2 - Unauthorized modification of windows Registry keys may modify authentication mechanism\n\n<code> sourcetype=WinEventLog:Security\n(EventCode=4657 OR EventCode=4663) \n| eval registry_path=mvindex(split(ObjectName,\"\\\\\"), 0, mvcount(split(ObjectName,\"\\\\\"))-1)\n| search registry_path IN (\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\", \n                           \"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\WDigest\\\\Parameters\", \n                           \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\",\n                           \"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\")</code>"}, {"technique_used": true, "domain": "enterprise", "id": "T1112", "name": "Modify Registry", "descr": "Monitor for changes made to windows registry keys or values. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods).(Citation: Microsoft 4657 APR 2017) Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.\n\nDetection of modification of the registry key values of\u00a0Notify,\u00a0Userinit, and\u00a0Shell\u00a0located in\u00a0`HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\`\u00a0and\u00a0`HKEY_LOCAL_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\`. When a user logs on, the Registry key values of\u00a0Notify,\u00a0Userinit\u00a0and\u00a0Shell\u00a0are used to load dedicated Windows component. Attackers may insert malicious payload following the legitimate value to launch a malicious payload.\n\nDetection of the modification of the registry key\u00a0Common Startup\u00a0located in\u00a0`HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\\`\u00a0and\u00a0`HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\\`. When a user logs on, any files located in the Startup Folder are launched. Attackers may modify these folders with other files in order to evade detection set on these default folders. This detection focuses on EventIDs 4688 and 1 for process creation and EventID 4657 for the modification of the Registry Keys.\n\nAnalytic 1 - Registry Edit with Modification of Userinit, Shell or Notify\n\n<code>source=\"*WinEventLog:Security\" EventCode=\"4657\" (ObjectValueName=\"Userinit\" OR ObjectValueName=\"Shell\" OR ObjectValueName=\"Notify\") OR source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"13\" (TargetObject=\"*Userinit\" OR TargetObject=\"*Shell\" OR TargetObject=\"*Notify\")</code>\n\nAnalytic 2 - Modification of Default Startup Folder in the Registry Key 'Common Startup'\n\n<code>(source=\"*WinEventLog:Security\" EventCode=\"4657\" ObjectValueName=\"Common Startup\") OR (source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"13\" TargetObject=\"*Common Startup\")</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1111", "name": "Multi-Factor Authentication Interception", "descr": "Monitor for changes to windows registry keys or values that may target multi-factor authentication mechanisms, such as smart cards, to gain access to credentials that can be used to access systems, services, and network resources.\n\nAnalytic 1 - Unauthorized registry changes related to MFA settings.\n\n<code> index=security sourcetype=\"WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=13 | where match(RegistryKeyPath, \"(?i)(MFA|2FA|MultiFactorAuth|SmartCard|Token|SecureID|OTP|OneTimePasscode)\")</code>", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1137", "name": "Office Application Startup", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Office Template Macros", "descr": "Collect events related to Registry key modification for keys that could be used for Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Today Home Page)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Office Test", "descr": "Monitor for changes made to the Office Test Registry key. Collect events related to Registry key modification for keys that could be used for Office-based persistence. Since v13.52, Autoruns can detect tasks set up using the Office Test Registry key.(Citation: Palo Alto Office Test Sofacy)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Add-ins", "descr": "Audit the Registry entries relevant for enabling add-ins.(Citation: GlobalDotName Jun 2019)(Citation: MRWLabs Office Persistence Add-ins)", "subtechniques": [], "color": 1}], "descr": "Many Office-related persistence mechanisms require changes to the Registry and for binaries, files, or scripts to be written to disk or existing files modified to include malicious scripts. Collect events related to Registry key creation and modification for keys that could be used for Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Today Home Page)"}, {"domain": "enterprise", "id": "T1003", "name": "OS Credential Dumping", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "LSASS Memory", "descr": "Monitor for changes to Registry entries associated with credential access that is stored in the process memory of the LSASS. For example, the adversary can modify the SAM and SYSTEM files.\n\nAnalytics 1 - Unauthorized registry modifications related to LSASS.\n\n<code> index=security sourcetype=\"WinEventLog:Security\" EventCode=4663 ObjectName IN (\"*\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\*\", \"*\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\WDigest\", \"*\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\Kerberos\", \"*\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\MSV1_0\") | where ProcessName IN (\"reg.exe\", \"powershell.exe\", \"wmic.exe\", \"schtasks.exe\", \"cmd.exe\", \"rundll32.exe\") </code>", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1505", "name": "Server Software Component", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Terminal Services DLL", "descr": "Monitor for changes to Registry keys associated with <code>ServiceDll</code> and other subkey values under <code>HKLM\\System\\CurrentControlSet\\services\\TermService\\Parameters\\</code>.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1489", "name": "Service Stop", "descr": "Monitor for changes made to windows registry keys and/or values that may stop or disable services on a system to render those services unavailable to legitimate users.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0881", "name": "Service Stop", "descr": "Monitor for changes made to Windows registry keys and/or values that may stop or disable services on a system to render those services unavailable to legitimate users.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0856", "name": "Spoof Reporting Message", "descr": "Various techniques enable spoofing a reporting message. Monitor for LLMNR/NBT-NS poisoning via new services/daemons which may be used to enable this technique. For added context on adversary procedures and background see [LLMNR/NBT-NS Poisoning and SMB Relay](https://attack.mitre.org/techniques/T1557/001).", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1553", "name": "Subvert Trust Controls", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "SIP and Trust Provider Hijacking", "descr": "Enable the Registry Global Object Access Auditing (Citation: Microsoft Registry Auditing Aug 2016)\u00a0setting in the Advanced Security Audit policy to apply a global system access control list (SACL) and event auditing on modifications to Registry values (sub)keys related to SIPs and trust providers:(Citation: Microsoft Audit Registry July 2012)\n* <code>HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID</code>\n* <code>HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography\\OID</code>\n* <code>HKLM\\SOFTWARE\\Microsoft\\Cryptography\\Providers\\Trust</code>\n* <code>HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography\\Providers\\Trust</code>\n\n**Note:** As part of this technique, adversaries may attempt to manually edit these Registry keys (ex: Regedit) or utilize the legitimate registration process using\u00a0[Regsvr32](https://attack.mitre.org/techniques/T1218/010).(Citation: SpectorOps Subverting Trust Sept 2017)\n\nPeriodically baseline registered SIPs and trust providers (Registry entries and files on disk), specifically looking for new, modified, or non-Microsoft entries.(Citation: SpectorOps Subverting Trust Sept 2017)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Install Root Certificate", "descr": "Monitoring changes to the Windows Registry may reveal malicious root certificate installation. Installed root certificates are located in the Registry under\u00a0\n```HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\```\u00a0and\u00a0\n```HKLM\\SOFTWARE\\Microsoft\\SystemCertificates\\Root\\Certificates\\``` or ```HKCU\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates\\```. \n\nThere are a subset of root certificates that are consistent across Windows systems and can be used for comparison:\u00a0(Citation: Tripwire AppUNBlocker)\n* 18F7C1FCC3090203FD5BAA2F861A754976C8DD25\n* 245C97DF7514E7CF2DF8BE72AE957B9E04741E85\n* 3B1EFD3A66EA28B16697394703A72CA340A05BD5\n* 7F88CD7223F3C813818C994614A89C99FA3B5247\n* 8F43288AD272F3103B6FB1428485EA3014C0BCFE\n* A43489159A520F0D93D032CCAF37E7FE20A8B419\n* BE36A4562FB2EE05DBB3D32323ADF445084ED656\n* CDD4EEAE6000AC7F40C3802C171E30148030C072", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Code Signing Policy Modification", "descr": "Consider monitoring for modifications made to Registry keys associated with code signing policies, such as <code>HKCU\\Software\\Policies\\Microsoft\\Windows NT\\Driver Signing</code>. Modifications to the code signing policy of a system are likely to be rare.", "subtechniques": [], "color": 1}], "descr": "Monitoring changes to the Windows Registry may reveal malicious attempts to modify trust settings, such as the installation of root certificates. Installed root certificates are located in the Registry under\u00a0<code>HKLM\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\</code>\u00a0and\u00a0</code>[HKLM or HKCU]\\Software[\\Policies\\]\\Microsoft\\SystemCertificates\\Root\\Certificates\\</code>. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison:\u00a0(Citation: Tripwire AppUNBlocker) Also consider enabling the Registry Global Object Access Auditing (Citation: Microsoft Registry Auditing Aug 2016)\u00a0setting in the Advanced Security Audit policy to apply a global system access control list (SACL) and event auditing on modifications to Registry values (sub)keys related to SIPs and trust providers:(Citation: Microsoft Audit Registry July 2012) "}, {"technique_used": true, "domain": "enterprise", "id": "T1218", "name": "System Binary Proxy Execution", "descr": "Monitor for changes made to Windows Registry keys and/or values that may forge credential materials that can be used to gain access to web applications or Internet services.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Control Panel", "descr": "Inventory Control Panel items to locate unregistered and potentially malicious files present on systems:\n* Executable format registered Control Panel items will have a globally unique identifier (GUID) and registration Registry entries in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ControlPanel\\NameSpace</code> and <code>HKEY_CLASSES_ROOT\\CLSID\\{GUID}</code>. These entries may contain information about the Control Panel item such as its display name, path to the local file, and the command executed when opened in the Control Panel. (Citation: Microsoft Implementing CPL)\n* CPL format registered Control Panel items stored in the System32 directory are automatically shown in the Control Panel. Other Control Panel items will have registration entries in the <code>CPLs</code> and <code>Extended Properties</code> Registry keys of <code>HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Control Panel</code>. These entries may include information such as a GUID, path to the local file, and a canonical name used to launch the file programmatically (<code> WinExec(\"c:\\windows\\system32\\control.exe {Canonical_Name}\", SW_NORMAL);</code>) or from a command line (<code>control.exe /name {Canonical_Name}</code>).(Citation: Microsoft Implementing CPL)\n* Some Control Panel items are extensible via Shell extensions registered in <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Controls Folder\\{name}\\Shellex\\PropertySheetHandlers</code> where {name} is the predefined name of the system item.(Citation: Microsoft Implementing CPL)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1569", "name": "System Services", "descr": "Monitor for changes made to windows registry keys and/or values that may abuse system services or daemons to execute commands or programs.\n\nAnalytic 1 - Malicious service modification\n\n<code>sourcetype= Sysmon EventCode=12\n| search registry_path=\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\*\" \n| where registry_action=\"modified\" AND user NOT IN (\"known_admins\") </code>", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Service Execution", "descr": "Monitor for changes made to windows registry keys and/or values that may abuse the Windows service control manager to execute malicious commands or payloads.\n\nAnalytic 1 - Registry changes related to service execution.\n\n<code> sourcetype=WinEventLog:Security OR sourcetype=Sysmon EventCode=13 OR EventCode=4657\n| search registry_path IN (\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services*\")\n| where registry_value != \"*legitimate_software_registry*\"  // Filter out common services\n</code>", "subtechniques": [], "color": 1}], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise", "ics"]}], "citations": {"current_number": 0, "Microsoft Registry": {"description": "Microsoft. (2018, May 31). Registry. Retrieved September 29, 2021.", "url": "https://docs.microsoft.com/en-us/windows/win32/sysinfo/registry", "number": null}, "Microsoft 4657 APR 2017": {"description": "Miroshnikov, A. & Hall, J. (2017, April 18). 4657(S): A registry value was modified. Retrieved August 9, 2018.", "url": "https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4657", "number": null}, "enigma0x3 Fileless UAC Bypass": {"description": "Nelson, M. (2016, August 15). \"Fileless\" UAC Bypass using eventvwr.exe and Registry Hijacking. Retrieved December 27, 2016.", "url": "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/", "number": null}, "enigma0x3 sdclt app paths": {"description": "Nelson, M. (2017, March 14). Bypassing UAC using App Paths. Retrieved May 25, 2017.", "url": "https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/", "number": null}, "enigma0x3 sdclt bypass": {"description": "Nelson, M. (2017, March 17). \"Fileless\" UAC Bypass Using sdclt.exe. Retrieved May 25, 2017.", "url": "https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/", "number": null}, "TechNet Autoruns": {"description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.", "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902", "number": null}, "Demaske Netsh Persistence": {"description": "Demaske, M. (2016, September 23). USING NETSHELL TO EXECUTE EVIL DLLS AND PERSIST ON A HOST. Retrieved April 8, 2017.", "url": "https://htmlpreview.github.io/?https://github.com/MatthewDemaske/blogbackup/blob/master/netshell.html", "number": null}, "Graeber 2014": {"description": "Graeber, M. (2014, October). Analysis of Malicious Security Support Provider DLLs. Retrieved March 1, 2017.", "url": "http://docplayer.net/20839173-Analysis-of-malicious-security-support-provider-dlls.html", "number": null}, "Microsoft Configure LSA": {"description": "Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved June 24, 2015.", "url": "https://technet.microsoft.com/en-us/library/dn408187.aspx", "number": null}, "CrowdStrike Outlook Forms": {"description": "Parisi, T., et al. (2017, July). Using Outlook Forms for Lateral Movement and Persistence. Retrieved February 5, 2019.", "url": "https://malware.news/t/using-outlook-forms-for-lateral-movement-and-persistence/13746", "number": null}, "Outlook Today Home Page": {"description": "Soutcast. (2018, September 14). Outlook Today Homepage Persistence. Retrieved February 5, 2019.", "url": "https://medium.com/@bwtech789/outlook-today-homepage-persistence-33ea9b505943", "number": null}, "MRWLabs Office Persistence Add-ins": {"description": "Knowles, W. (2017, April 21). Add-In Opportunities for Office Persistence. Retrieved November 17, 2024.", "url": "https://web.archive.org/web/20190526112859/https://labs.mwrinfosecurity.com/blog/add-in-opportunities-for-office-persistence/", "number": null}, "GlobalDotName Jun 2019": {"description": "Shukrun, S. (2019, June 2). Office Templates and GlobalDotName - A Stealthy Office Persistence Technique. Retrieved August 26, 2019.", "url": "https://www.221bluestreet.com/post/office-templates-and-globaldotname-a-stealthy-office-persistence-technique", "number": null}, "Microsoft Implementing CPL": {"description": "M. (n.d.). Implementing Control Panel Items. Retrieved January 18, 2018.", "url": "https://msdn.microsoft.com/library/windows/desktop/cc144185.aspx", "number": null}, "Tripwire AppUNBlocker": {"description": "Smith, T. (2016, October 27). AppUNBlocker: Bypassing AppLocker. Retrieved December 19, 2017.", "url": "https://www.tripwire.com/state-of-security/off-topic/appunblocker-bypassing-applocker/", "number": null}, "Microsoft Registry Auditing Aug 2016": {"description": "Microsoft. (2016, August 31). Registry (Global Object Access Auditing). Retrieved January 31, 2018.", "url": "https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn311461(v=ws.11)", "number": null}, "Microsoft Audit Registry July 2012": {"description": "Microsoft. (2012, July 2). Audit Registry. Retrieved January 31, 2018.", "url": "https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd941614(v=ws.10)", "number": null}, "SpectorOps Subverting Trust Sept 2017": {"description": "Graeber, M. (2017, September). Subverting Trust in Windows. Retrieved January 31, 2018.", "url": "https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf", "number": null}, "BleepingComputer REvil 2021": {"description": "Abrams, L. (2021, March 19). REvil ransomware has a new \u2018Windows Safe Mode\u2019 encryption mode. Retrieved June 23, 2021.", "url": "https://www.bleepingcomputer.com/news/security/revil-ransomware-has-a-new-windows-safe-mode-encryption-mode/", "number": null}, "Sophos Snatch Ransomware 2019": {"description": "Sophos. (2019, December 9). Snatch ransomware reboots PCs into Safe Mode to bypass protection. Retrieved June 23, 2021.", "url": "https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/", "number": null}, "def_ev_win_event_logging": {"description": "Chandel, R. (2021, April 22). Defense Evasion: Windows Event Logging (T1562.002). Retrieved September 14, 2021.", "url": "https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/", "number": null}, "Palo Alto Office Test Sofacy": {"description": "Falcone, R. (2016, July 20). Technical Walkthrough: Office Test Persistence Method Used In Recent Sofacy Attacks. Retrieved July 3, 2017.", "url": "https://researchcenter.paloaltonetworks.com/2016/07/unit42-technical-walkthrough-office-test-persistence-method-used-in-recent-sofacy-attacks/", "number": null}, "Elastic COM Hijacking": {"description": "Ewing, P. Strom, B. (2016, September 15). How to Hunt: Detecting Persistence & Evasion with the COM. Retrieved September 15, 2016.", "url": "https://www.elastic.co/blog/how-hunt-detecting-persistence-evasion-com", "number": null}, "welivesecurity": {"description": "Martin Smol\u00e1r. (2023, March 1). BlackLotus UEFI bootkit: Myth confirmed. Retrieved February 11, 2025.", "url": "https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/", "number": null}, "Microsoft Security": {"description": "Microsoft Incident Response. (2023, April 11). Guidance for investigating attacks using CVE-2022-21894: The BlackLotus campaign. Retrieved February 12, 2025.", "url": "https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/", "number": null}, "disable_win_evt_logging": {"description": "Heiligenstein, L. (n.d.). REP-25: Disable Windows Event Logging. Retrieved April 7, 2022.", "url": "https://ptylu.github.io/content/report/report.html?report=25", "number": null}, "Microsoft Registry Drivers": {"description": "Microsoft. (2021, December 14). Registry Trees for Devices and Drivers. Retrieved March 28, 2023.", "url": "https://learn.microsoft.com/windows-hardware/drivers/install/overview-of-registry-trees-and-keys", "number": null}, "SpecterOps Certified Pre Owned": {"description": "Schroeder, W. & Christensen, L. (2021, June 22). Certified Pre-Owned - Abusing Active Directory Certificate Services. Retrieved August 2, 2022.", "url": "https://web.archive.org/web/20220818094600/https://specterops.io/assets/resources/Certified_Pre-Owned.pdf", "number": null}, "O365 Blog Azure AD Device IDs": {"description": "Syynimaa, N. (2022, February 15). Stealing and faking Azure AD device identities. Retrieved August 3, 2022.", "url": "https://o365blog.com/post/deviceidentity/", "number": null}}, "versioning_feature": false}