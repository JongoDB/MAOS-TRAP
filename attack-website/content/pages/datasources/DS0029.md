Title: Network Traffic
Template: datasources/datasource
save_as: datasources/DS0029/index.html
data: {"attack_id": "DS0029", "side_menu_data": {"name": "Data Sources", "id": "datasources", "path": null, "children": [{"name": "Active Directory", "id": "DS0026", "path": "/datasources/DS0026/", "children": [{"name": "Active Directory Credential Request", "id": "Active Directory Credential Request", "path": "/datasources/DS0026/#Active Directory Credential Request", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Access", "id": "Active Directory Object Access", "path": "/datasources/DS0026/#Active Directory Object Access", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Creation", "id": "Active Directory Object Creation", "path": "/datasources/DS0026/#Active Directory Object Creation", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Deletion", "id": "Active Directory Object Deletion", "path": "/datasources/DS0026/#Active Directory Object Deletion", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Modification", "id": "Active Directory Object Modification", "path": "/datasources/DS0026/#Active Directory Object Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Application Log", "id": "DS0015", "path": "/datasources/DS0015/", "children": [{"name": "Application Log Content", "id": "Application Log Content", "path": "/datasources/DS0015/#Application Log Content", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Application Vetting", "id": "DS0041", "path": "/datasources/DS0041/", "children": [{"name": "API Calls", "id": "API Calls", "path": "/datasources/DS0041/#API Calls", "domains": ["mobile"], "children": []}, {"name": "Application Assets", "id": "Application Assets", "path": "/datasources/DS0041/#Application Assets", "domains": ["mobile"], "children": []}, {"name": "Network Communication", "id": "Network Communication", "path": "/datasources/DS0041/#Network Communication", "domains": ["mobile"], "children": []}, {"name": "Permissions Requests", "id": "Permissions Requests", "path": "/datasources/DS0041/#Permissions Requests", "domains": ["mobile"], "children": []}, {"name": "Protected Configuration", "id": "Protected Configuration", "path": "/datasources/DS0041/#Protected Configuration", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Asset", "id": "DS0039", "path": "/datasources/DS0039/", "children": [{"name": "Asset Inventory", "id": "Asset Inventory", "path": "/datasources/DS0039/#Asset Inventory", "domains": ["ics"], "children": []}, {"name": "Software", "id": "Software", "path": "/datasources/DS0039/#Software", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Certificate", "id": "DS0037", "path": "/datasources/DS0037/", "children": [{"name": "Certificate Registration", "id": "Certificate Registration", "path": "/datasources/DS0037/#Certificate Registration", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Service", "id": "DS0025", "path": "/datasources/DS0025/", "children": [{"name": "Cloud Service Disable", "id": "Cloud Service Disable", "path": "/datasources/DS0025/#Cloud Service Disable", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Enumeration", "id": "Cloud Service Enumeration", "path": "/datasources/DS0025/#Cloud Service Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Metadata", "id": "Cloud Service Metadata", "path": "/datasources/DS0025/#Cloud Service Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Modification", "id": "Cloud Service Modification", "path": "/datasources/DS0025/#Cloud Service Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Storage", "id": "DS0010", "path": "/datasources/DS0010/", "children": [{"name": "Cloud Storage Access", "id": "Cloud Storage Access", "path": "/datasources/DS0010/#Cloud Storage Access", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Creation", "id": "Cloud Storage Creation", "path": "/datasources/DS0010/#Cloud Storage Creation", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Deletion", "id": "Cloud Storage Deletion", "path": "/datasources/DS0010/#Cloud Storage Deletion", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Enumeration", "id": "Cloud Storage Enumeration", "path": "/datasources/DS0010/#Cloud Storage Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Metadata", "id": "Cloud Storage Metadata", "path": "/datasources/DS0010/#Cloud Storage Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Modification", "id": "Cloud Storage Modification", "path": "/datasources/DS0010/#Cloud Storage Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Command", "id": "DS0017", "path": "/datasources/DS0017/", "children": [{"name": "Command Execution", "id": "Command Execution", "path": "/datasources/DS0017/#Command Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Container", "id": "DS0032", "path": "/datasources/DS0032/", "children": [{"name": "Container Creation", "id": "Container Creation", "path": "/datasources/DS0032/#Container Creation", "domains": ["enterprise"], "children": []}, {"name": "Container Enumeration", "id": "Container Enumeration", "path": "/datasources/DS0032/#Container Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Container Start", "id": "Container Start", "path": "/datasources/DS0032/#Container Start", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Domain Name", "id": "DS0038", "path": "/datasources/DS0038/", "children": [{"name": "Active DNS", "id": "Active DNS", "path": "/datasources/DS0038/#Active DNS", "domains": ["enterprise"], "children": []}, {"name": "Domain Registration", "id": "Domain Registration", "path": "/datasources/DS0038/#Domain Registration", "domains": ["enterprise"], "children": []}, {"name": "Passive DNS", "id": "Passive DNS", "path": "/datasources/DS0038/#Passive DNS", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Drive", "id": "DS0016", "path": "/datasources/DS0016/", "children": [{"name": "Drive Access", "id": "Drive Access", "path": "/datasources/DS0016/#Drive Access", "domains": ["enterprise"], "children": []}, {"name": "Drive Creation", "id": "Drive Creation", "path": "/datasources/DS0016/#Drive Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Drive Modification", "id": "Drive Modification", "path": "/datasources/DS0016/#Drive Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Driver", "id": "DS0027", "path": "/datasources/DS0027/", "children": [{"name": "Driver Load", "id": "Driver Load", "path": "/datasources/DS0027/#Driver Load", "domains": ["enterprise"], "children": []}, {"name": "Driver Metadata", "id": "Driver Metadata", "path": "/datasources/DS0027/#Driver Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "File", "id": "DS0022", "path": "/datasources/DS0022/", "children": [{"name": "File Access", "id": "File Access", "path": "/datasources/DS0022/#File Access", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Creation", "id": "File Creation", "path": "/datasources/DS0022/#File Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Deletion", "id": "File Deletion", "path": "/datasources/DS0022/#File Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Metadata", "id": "File Metadata", "path": "/datasources/DS0022/#File Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Modification", "id": "File Modification", "path": "/datasources/DS0022/#File Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Firewall", "id": "DS0018", "path": "/datasources/DS0018/", "children": [{"name": "Firewall Disable", "id": "Firewall Disable", "path": "/datasources/DS0018/#Firewall Disable", "domains": ["enterprise"], "children": []}, {"name": "Firewall Enumeration", "id": "Firewall Enumeration", "path": "/datasources/DS0018/#Firewall Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Firewall Metadata", "id": "Firewall Metadata", "path": "/datasources/DS0018/#Firewall Metadata", "domains": ["enterprise"], "children": []}, {"name": "Firewall Rule Modification", "id": "Firewall Rule Modification", "path": "/datasources/DS0018/#Firewall Rule Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Firmware", "id": "DS0001", "path": "/datasources/DS0001/", "children": [{"name": "Firmware Modification", "id": "Firmware Modification", "path": "/datasources/DS0001/#Firmware Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Group", "id": "DS0036", "path": "/datasources/DS0036/", "children": [{"name": "Group Enumeration", "id": "Group Enumeration", "path": "/datasources/DS0036/#Group Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Group Metadata", "id": "Group Metadata", "path": "/datasources/DS0036/#Group Metadata", "domains": ["enterprise"], "children": []}, {"name": "Group Modification", "id": "Group Modification", "path": "/datasources/DS0036/#Group Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Image", "id": "DS0007", "path": "/datasources/DS0007/", "children": [{"name": "Image Creation", "id": "Image Creation", "path": "/datasources/DS0007/#Image Creation", "domains": ["enterprise"], "children": []}, {"name": "Image Deletion", "id": "Image Deletion", "path": "/datasources/DS0007/#Image Deletion", "domains": ["enterprise"], "children": []}, {"name": "Image Metadata", "id": "Image Metadata", "path": "/datasources/DS0007/#Image Metadata", "domains": ["enterprise"], "children": []}, {"name": "Image Modification", "id": "Image Modification", "path": "/datasources/DS0007/#Image Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Instance", "id": "DS0030", "path": "/datasources/DS0030/", "children": [{"name": "Instance Creation", "id": "Instance Creation", "path": "/datasources/DS0030/#Instance Creation", "domains": ["enterprise"], "children": []}, {"name": "Instance Deletion", "id": "Instance Deletion", "path": "/datasources/DS0030/#Instance Deletion", "domains": ["enterprise"], "children": []}, {"name": "Instance Enumeration", "id": "Instance Enumeration", "path": "/datasources/DS0030/#Instance Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Instance Metadata", "id": "Instance Metadata", "path": "/datasources/DS0030/#Instance Metadata", "domains": ["enterprise"], "children": []}, {"name": "Instance Modification", "id": "Instance Modification", "path": "/datasources/DS0030/#Instance Modification", "domains": ["enterprise"], "children": []}, {"name": "Instance Start", "id": "Instance Start", "path": "/datasources/DS0030/#Instance Start", "domains": ["enterprise"], "children": []}, {"name": "Instance Stop", "id": "Instance Stop", "path": "/datasources/DS0030/#Instance Stop", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Internet Scan", "id": "DS0035", "path": "/datasources/DS0035/", "children": [{"name": "Response Content", "id": "Response Content", "path": "/datasources/DS0035/#Response Content", "domains": ["enterprise"], "children": []}, {"name": "Response Metadata", "id": "Response Metadata", "path": "/datasources/DS0035/#Response Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Kernel", "id": "DS0008", "path": "/datasources/DS0008/", "children": [{"name": "Kernel Module Load", "id": "Kernel Module Load", "path": "/datasources/DS0008/#Kernel Module Load", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Logon Session", "id": "DS0028", "path": "/datasources/DS0028/", "children": [{"name": "Logon Session Creation", "id": "Logon Session Creation", "path": "/datasources/DS0028/#Logon Session Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Logon Session Metadata", "id": "Logon Session Metadata", "path": "/datasources/DS0028/#Logon Session Metadata", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Malware Repository", "id": "DS0004", "path": "/datasources/DS0004/", "children": [{"name": "Malware Content", "id": "Malware Content", "path": "/datasources/DS0004/#Malware Content", "domains": ["enterprise"], "children": []}, {"name": "Malware Metadata", "id": "Malware Metadata", "path": "/datasources/DS0004/#Malware Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Module", "id": "DS0011", "path": "/datasources/DS0011/", "children": [{"name": "Module Load", "id": "Module Load", "path": "/datasources/DS0011/#Module Load", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Named Pipe", "id": "DS0023", "path": "/datasources/DS0023/", "children": [{"name": "Named Pipe Metadata", "id": "Named Pipe Metadata", "path": "/datasources/DS0023/#Named Pipe Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Network Share", "id": "DS0033", "path": "/datasources/DS0033/", "children": [{"name": "Network Share Access", "id": "Network Share Access", "path": "/datasources/DS0033/#Network Share Access", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Network Traffic", "id": "DS0029", "path": "/datasources/DS0029/", "children": [{"name": "Network Connection Creation", "id": "Network Connection Creation", "path": "/datasources/DS0029/#Network Connection Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Content", "id": "Network Traffic Content", "path": "/datasources/DS0029/#Network Traffic Content", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Flow", "id": "Network Traffic Flow", "path": "/datasources/DS0029/#Network Traffic Flow", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Operational Databases", "id": "DS0040", "path": "/datasources/DS0040/", "children": [{"name": "Device Alarm", "id": "Device Alarm", "path": "/datasources/DS0040/#Device Alarm", "domains": ["ics"], "children": []}, {"name": "Process History/Live Data", "id": "Process History/Live Data", "path": "/datasources/DS0040/#Process History/Live Data", "domains": ["ics"], "children": []}, {"name": "Process/Event Alarm", "id": "Process/Event Alarm", "path": "/datasources/DS0040/#Process/Event Alarm", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Persona", "id": "DS0021", "path": "/datasources/DS0021/", "children": [{"name": "Social Media", "id": "Social Media", "path": "/datasources/DS0021/#Social Media", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Pod", "id": "DS0014", "path": "/datasources/DS0014/", "children": [{"name": "Pod Creation", "id": "Pod Creation", "path": "/datasources/DS0014/#Pod Creation", "domains": ["enterprise"], "children": []}, {"name": "Pod Enumeration", "id": "Pod Enumeration", "path": "/datasources/DS0014/#Pod Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Pod Modification", "id": "Pod Modification", "path": "/datasources/DS0014/#Pod Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Process", "id": "DS0009", "path": "/datasources/DS0009/", "children": [{"name": "OS API Execution", "id": "OS API Execution", "path": "/datasources/DS0009/#OS API Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Access", "id": "Process Access", "path": "/datasources/DS0009/#Process Access", "domains": ["enterprise"], "children": []}, {"name": "Process Creation", "id": "Process Creation", "path": "/datasources/DS0009/#Process Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Metadata", "id": "Process Metadata", "path": "/datasources/DS0009/#Process Metadata", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Modification", "id": "Process Modification", "path": "/datasources/DS0009/#Process Modification", "domains": ["enterprise"], "children": []}, {"name": "Process Termination", "id": "Process Termination", "path": "/datasources/DS0009/#Process Termination", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Scheduled Job", "id": "DS0003", "path": "/datasources/DS0003/", "children": [{"name": "Scheduled Job Creation", "id": "Scheduled Job Creation", "path": "/datasources/DS0003/#Scheduled Job Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Scheduled Job Metadata", "id": "Scheduled Job Metadata", "path": "/datasources/DS0003/#Scheduled Job Metadata", "domains": ["enterprise"], "children": []}, {"name": "Scheduled Job Modification", "id": "Scheduled Job Modification", "path": "/datasources/DS0003/#Scheduled Job Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Script", "id": "DS0012", "path": "/datasources/DS0012/", "children": [{"name": "Script Execution", "id": "Script Execution", "path": "/datasources/DS0012/#Script Execution", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Sensor Health", "id": "DS0013", "path": "/datasources/DS0013/", "children": [{"name": "Host Status", "id": "Host Status", "path": "/datasources/DS0013/#Host Status", "domains": ["enterprise", "mobile"], "children": []}], "domains": ["enterprise", "mobile"]}, {"name": "Service", "id": "DS0019", "path": "/datasources/DS0019/", "children": [{"name": "Service Creation", "id": "Service Creation", "path": "/datasources/DS0019/#Service Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Metadata", "id": "Service Metadata", "path": "/datasources/DS0019/#Service Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Modification", "id": "Service Modification", "path": "/datasources/DS0019/#Service Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Snapshot", "id": "DS0020", "path": "/datasources/DS0020/", "children": [{"name": "Snapshot Creation", "id": "Snapshot Creation", "path": "/datasources/DS0020/#Snapshot Creation", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Deletion", "id": "Snapshot Deletion", "path": "/datasources/DS0020/#Snapshot Deletion", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Enumeration", "id": "Snapshot Enumeration", "path": "/datasources/DS0020/#Snapshot Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Metadata", "id": "Snapshot Metadata", "path": "/datasources/DS0020/#Snapshot Metadata", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Modification", "id": "Snapshot Modification", "path": "/datasources/DS0020/#Snapshot Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "User Account", "id": "DS0002", "path": "/datasources/DS0002/", "children": [{"name": "User Account Authentication", "id": "User Account Authentication", "path": "/datasources/DS0002/#User Account Authentication", "domains": ["enterprise", "ics"], "children": []}, {"name": "User Account Creation", "id": "User Account Creation", "path": "/datasources/DS0002/#User Account Creation", "domains": ["enterprise"], "children": []}, {"name": "User Account Deletion", "id": "User Account Deletion", "path": "/datasources/DS0002/#User Account Deletion", "domains": ["enterprise"], "children": []}, {"name": "User Account Metadata", "id": "User Account Metadata", "path": "/datasources/DS0002/#User Account Metadata", "domains": ["enterprise"], "children": []}, {"name": "User Account Modification", "id": "User Account Modification", "path": "/datasources/DS0002/#User Account Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "User Interface", "id": "DS0042", "path": "/datasources/DS0042/", "children": [{"name": "Permissions Request", "id": "Permissions Request", "path": "/datasources/DS0042/#Permissions Request", "domains": ["mobile"], "children": []}, {"name": "System Notifications", "id": "System Notifications", "path": "/datasources/DS0042/#System Notifications", "domains": ["mobile"], "children": []}, {"name": "System Settings", "id": "System Settings", "path": "/datasources/DS0042/#System Settings", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Volume", "id": "DS0034", "path": "/datasources/DS0034/", "children": [{"name": "Volume Creation", "id": "Volume Creation", "path": "/datasources/DS0034/#Volume Creation", "domains": ["enterprise"], "children": []}, {"name": "Volume Deletion", "id": "Volume Deletion", "path": "/datasources/DS0034/#Volume Deletion", "domains": ["enterprise"], "children": []}, {"name": "Volume Enumeration", "id": "Volume Enumeration", "path": "/datasources/DS0034/#Volume Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Volume Metadata", "id": "Volume Metadata", "path": "/datasources/DS0034/#Volume Metadata", "domains": ["enterprise"], "children": []}, {"name": "Volume Modification", "id": "Volume Modification", "path": "/datasources/DS0034/#Volume Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Web Credential", "id": "DS0006", "path": "/datasources/DS0006/", "children": [{"name": "Web Credential Creation", "id": "Web Credential Creation", "path": "/datasources/DS0006/#Web Credential Creation", "domains": ["enterprise"], "children": []}, {"name": "Web Credential Usage", "id": "Web Credential Usage", "path": "/datasources/DS0006/#Web Credential Usage", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Windows Registry", "id": "DS0024", "path": "/datasources/DS0024/", "children": [{"name": "Windows Registry Key Access", "id": "Windows Registry Key Access", "path": "/datasources/DS0024/#Windows Registry Key Access", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Creation", "id": "Windows Registry Key Creation", "path": "/datasources/DS0024/#Windows Registry Key Creation", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Deletion", "id": "Windows Registry Key Deletion", "path": "/datasources/DS0024/#Windows Registry Key Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "Windows Registry Key Modification", "id": "Windows Registry Key Modification", "path": "/datasources/DS0024/#Windows Registry Key Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "WMI", "id": "DS0005", "path": "/datasources/DS0005/", "children": [{"name": "WMI Creation", "id": "WMI Creation", "path": "/datasources/DS0005/#WMI Creation", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}]}, "notes": null, "created": "20 October 2021", "modified": "18 April 2025", "name": "Network Traffic", "version": "1.2", "contributors_list": ["Center for Threat-Informed Defense (CTID)", "ExtraHop"], "descr": "Data transmitted across a network (ex: Web, DNS, Mail, File, etc.), that is either summarized (ex: Netflow) and/or captured as raw data in an analyzable format (ex: PCAP)", "platforms": "Android, ESXi, IaaS, Linux, Windows, iOS, macOS", "collection_layers": "Cloud Control Plane, Host, Network", "datacomponents_list": [{"name": "Network Connection Creation", "descr": "The initial establishment of a network session, where a system or process initiates a connection to a local or remote endpoint. This typically involves capturing socket information (source/destination IP, ports, protocol) and tracking session metadata. Monitoring these events helps detect lateral movement, exfiltration, and command-and-control (C2) activities.\n\n*Data Collection Measures:*\n\n- Windows:\n    - Event ID 5156 \u2013 Filtering Platform Connection - Logs network connections permitted by Windows Filtering Platform (WFP).\n    - Sysmon Event ID 3 \u2013 Network Connection Initiated - Captures process, source/destination IP, ports, and parent process.\n- Linux/macOS:\n    - Netfilter (iptables), nftables logs - Tracks incoming and outgoing network connections.\n    - AuditD (`connect` syscall) - Logs TCP, UDP, and ICMP connections.\n    - Zeek (`conn.log`) - Captures protocol, duration, and bytes transferred.\n- Cloud & Network Infrastructure:\n    - AWS VPC Flow Logs / Azure NSG Flow Logs - Logs IP traffic at the network level in cloud environments.\n    - Zeek (conn.log) or Suricata (network events) - Captures packet metadata for detection and correlation.\n- Endpoint Detection & Response (EDR):\n    - Detect anomalous network activity such as new C2 connections or data exfiltration attempts.", "techniques": [{"technique_used": true, "domain": "mobile", "id": "T1638", "name": "Adversary-in-the-Middle", "descr": "Mobile security products can potentially detect rogue Wi-Fi access points if the adversary is attempting to decrypt traffic using an untrusted SSL certificate. ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1020", "name": "Automated Exfiltration", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Traffic Duplication", "descr": "Monitor for creation of unauthorized traffic mirroring sessions, unexpected outbound network connections from routers or cloud instances, configuration changes in network devices related to traffic forwarding or unusual new network flows, particularly on ports associated with traffic analysis tools.\n\nAnalytic 1 - Detecting Unauthorized Traffic Mirroring Sessions\n\n<code> (EventCode=\"CreateTrafficMirrorSession\" OR EventCode=\"VirtualNetworkTapCreated\" OR source=\"firewall_logs\" message=\"Mirror Port Config Change\")\n| eval risk_score=case(\n    EventCode=\"CreateTrafficMirrorSession\", 9,\n    EventCode=\"VirtualNetworkTapCreated\", 8,\n    EventCode=\"ModifyTrafficMirrorSession\", 7\n)\n| where risk_score >= 7\n| stats count by _time, host, user, EventCode, risk_score</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections associated with processes performing collection activity, especially those involving abnormal/untrusted hosts. \n\nAnalytic 1 - Detecting Automated Exfiltration via Network \n\n<code> (EventCode=3)\nOR (source=\"zeek_conn.log\" dest_port IN (21, 22, 443, 53) AND bytes_out > 5000000)\nOR (source=\"firewall_logs\" bytes_out > 10000000)\n| eval risk_score=case(\n    bytes_out > 10000000, 9,\n    bytes_out > 5000000, 8\n)\n| where risk_score >= 8\n| stats count by _time, host, user, dest_ip, dest_port, bytes_out, risk_score </code>"}, {"technique_used": true, "domain": "enterprise", "id": "T1197", "name": "BITS Jobs", "descr": "Monitor for newly constructed network activity generated by BITS. BITS jobs use HTTP(S) and SMB for remote connections and are tethered to the creating user and will only function when that user is logged on (this rule applies even if a user attaches the job to a service account).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1612", "name": "Build Image on Host", "descr": "Monitor for established network communications with anomalous IPs that have never been seen before in the environment that may indicate the download of malicious code.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1602", "name": "Data from Configuration Repository", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "SNMP (MIB Dump)", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts or uncommon data flows. Consider analyzing packet contents to detect application layer protocols, leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows(e.g. snmp traffic originating from unauthorized or untrusted hosts, signature detection for strings mapped to device configuration(s), and anomolies in snmp request(s))", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Network Device Configuration Dump", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts or uncommon data flows. Consider analyzing packet contents to detect application layer protocols, leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g. unauthorized, gratuitous, or anomalous traffic patterns attempting to access network configuration content)", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts or uncommon data flows. Consider analyzing packet contents to detect application layer protocols, leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g. unauthorized, gratuitous, or anomalous traffic patterns attempting to access configuration content)"}, {"technique_used": true, "domain": "enterprise", "id": "T1039", "name": "Data from Network Shared Drive", "descr": "Monitor for newly constructed network connections that may search network shares on computers they have compromised to find files of interest. Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on network protocols such as SMB that revolve around network shares.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1030", "name": "Data Transfer Size Limits", "descr": "Monitor for processes that initiate persistent outbound connections with steady data transfer, multiple small-sized data transfers within a short timeframe to external destinations, network connections originating from unexpected processes or unauthorized ports, or repeated use of the same destination for outbound traffic across multiple sessions.\n\nAnalytic 1 - Detecting Repeated Small-Size Data Transfers\n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (bytes_out > 100 AND bytes_out < 50000)  // Detects small packet sizes  \n| bucket span=5m _time\n| stats count by _time, host, process, dest_ip, bytes_out\n| where count > 10  // Ensures frequent occurrence\n| stats count by host, dest_ip, count, earliest(_time), latest(_time)\n| where count >= 10\n| eval risk_score=case(\n    count >= 20, 9,\n    count >= 10, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, count, earliest, latest, risk_score</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1189", "name": "Drive-by Compromise", "descr": "Monitor for newly constructed network connections to untrusted hosts that are used to send or receive data. Identify browser processes initiating connections to known malicious domains.\nDetect browser requests to suspicious IPs or domains classified under newly registered domains.\nLook for anomalous DNS queries and HTTP request patterns.\n\n<code>(sourcetype=\"WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=3 process=\"chrome.exe\" OR process=\"firefox.exe\")\nOR (source=\"cloud_dns_logs\" category=\"newly_registered_domain\")\nOR (source=\"/var/log/zeek/conn.log\" dest_ip IN (malicious_ip_list))\n| stats count by src_ip, dest_ip, domain, process\n| where count > 5 </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0817", "name": "Drive-by Compromise", "descr": "Monitor for newly constructed network connections to untrusted hosts that are used to send or receive data.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1568", "name": "Dynamic Resolution", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Fast Flux DNS", "descr": "Monitor for newly constructed network connections that may use Fast Flux DNS to hide a command and control channel behind an array of rapidly changing IP addresses linked to a single domain resolution.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1114", "name": "Email Collection", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Remote Email Collection", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1048", "name": "Exfiltration Over Alternative Protocol", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration Over Symmetric Encrypted Non-C2 Protocol", "descr": "Monitor for outbound network connections using traditionally non-encrypted protocols, connections where data sent is significantly larger than data received, traffic spikes over uncommon ports (e.g., FTP, SMB, SMTP, ICMP), or traffic patterns indicative of encrypted payload transmission.\n\nAnalytic 1 - Detecting Symmetric Encrypted Exfiltration via Alternative Protocols\n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (dest_port IN (21, 25, 53, 139, 445, 587, 990) AND bytes_out > 10000000)\n| stats count, sum(bytes_out) as total_bytes by _time, host, process, dest_ip, dest_port\n| where count >= 3 AND total_bytes > 50000000\n| eval risk_score=case(\n    total_bytes > 100000000, 9,\n    total_bytes > 50000000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, dest_port, risk_score</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Exfiltration Over Asymmetric Encrypted Non-C2 Protocol", "descr": "Monitor for outbound network connections using TLS-based encryption over non-standard ports, processes initiating large encrypted data transfers that typically do not communicate, or encrypted traffic with long-duration sessions indicative of large data exfiltration.\n\nAnalytic 1 - Detecting Exfiltration Over Asymmetric Encrypted Channels \n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (dest_port IN (22, 443, 465, 993, 995) AND bytes_out > 10000000)\n| stats count, sum(bytes_out) as total_bytes by _time, host, process, dest_ip, dest_port\n| where count >= 3 AND total_bytes > 50000000\n| eval risk_score=case(\n    total_bytes > 100000000, 9,\n    total_bytes > 50000000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, dest_port, risk_score</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Exfiltration Over Unencrypted Non-C2 Protocol", "descr": "Monitor for unencrypted outbound network connections involving file transfer protocols, processes sending significantly more data than they receive, or outbound data transfers occurring at unusual times.\n\nAnalytic 1 - Detecting Exfiltration Over Unencrypted Alternative Protocols \n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (dest_port IN (21, 53, 69, 139, 445, 8080) AND bytes_out > 10000000)\n| stats count, sum(bytes_out) as total_bytes by _time, host, process, dest_ip, dest_port\n| where count >= 3 AND total_bytes > 50000000\n| eval risk_score=case(\n    total_bytes > 100000000, 9,\n    total_bytes > 50000000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, dest_port, risk_score</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for outbound connections using non-standard ports for FTP, SMTP, or SMB, new processes generating large amounts of outbound traffic, or traffic flows that do not align with normal business usage patterns.\n\nAnalytic 1 - Detecting Exfiltration Over Alternative Protocols \n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (dest_port IN (21, 25, 53, 139, 445, 587, 465, 990))\n| bucket span=1h _time\n| stats count, sum(bytes_out) as total_bytes by _time, host, process, dest_ip, dest_port\n| where count >= 5 AND total_bytes > 10000000\n| eval risk_score=case(\n    total_bytes > 50000000, 9,\n    total_bytes > 10000000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, dest_port, risk_score</code> "}, {"technique_used": true, "domain": "enterprise", "id": "T1041", "name": "Exfiltration Over C2 Channel", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. \n\nNote: Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on TCP network connection creation.  \n\nAnalytic 1 - Detecting Outbound Network Connections for C2 Exfiltration \n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (bytes_out > 1000000 AND bytes_out > bytes_in * 5) // High outbound traffic\n| bucket span=1h _time\n| stats count by _time, host, process, dest_ip, bytes_out\n| where count > 5\n| stats count by host, dest_ip, count, earliest(_time), latest(_time)\n| where count >= 5\n| eval risk_score=case(\n    count >= 10, 9,\n    count >= 5, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, count, earliest, latest, risk_score</code> ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1011", "name": "Exfiltration Over Other Network Medium", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration Over Bluetooth", "descr": "Monitor for unusual Bluetooth device pairings, inbound or outbound Bluetooth connections from unexpected processes, or unexpected activation of Bluetooth Personal Area Network (PAN) services.\n\nAnalytic 1 - Detecting Unauthorized Bluetooth Network Connections\n\n<code>(EventCode=3 OR EventCode=10400)\nOR (source=\"zeek_conn.log\" interface IN (\"bt0\"))\n| eval risk_score=case(\n    interface IN (\"bt0\"), 9,\n    process_name IN (\"bluetoothctl\", \"bttransfer\"), 8\n)\n| where risk_score >= 8\n| stats count by _time, host, user, interface, dest_device, risk_score </code>", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that may attempt to exfiltrate data over a different network medium than the command and control channel. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.\n\nNote: Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on TCP network connection creation. The below analytic is using an event ID from OSQuery. \n\nAnalytic 1 - Detecting Exfiltration via Alternate Network Connections \n\n<code> (EventCode=3 OR EventCode=10400)\nOR (source=\"zeek_conn.log\" interface IN (\"wlan0\", \"ppp0\", \"bt0\", \"usb0\"))\n| eval risk_score=case(\n    interface IN (\"wlan0\", \"usb0\"), 9,\n    interface IN (\"ppp0\", \"bt0\"), 8\n)\n| where risk_score >= 8\n| stats count by _time, host, user, interface, dest_ip, risk_score</code>"}, {"domain": "enterprise", "id": "T1567", "name": "Exfiltration Over Web Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Exfiltration to Cloud Storage", "descr": "Monitor for unusual outbound connections to cloud storage domains, processes sending significantly more data than they receive, or high-bandwidth file transfers to cloud services.\n\nAnalytic 1 - Detecting Large Data Transfers to Cloud Storage\n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (dest_ip IN (known_cloud_services) AND bytes_out > 5000000)\n| stats count, sum(bytes_out) as total_bytes by _time, host, process, dest_ip\n| where total_bytes > 50000000\n| eval risk_score=case(\n    total_bytes > 100000000, 9,\n    total_bytes > 50000000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, risk_score</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections to web and cloud services associated with abnormal or non-browser processes.\n\nAnalytic 1 - Detecting Large Data Transfers to Web Services \n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (dest_ip IN (known_cloud_services) AND bytes_out > 5000000)\n| stats count, sum(bytes_out) as total_bytes by _time, host, process, dest_ip\n| where total_bytes > 50000000\n| eval risk_score=case(\n    total_bytes > 100000000, 9,\n    total_bytes > 50000000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, risk_score</code>"}, {"technique_used": true, "domain": "enterprise", "id": "T1133", "name": "External Remote Services", "descr": "Monitor for newly constructed network connections that may use Valid Accounts to access and/or persist within a network using External Remote Services. Use of External Remote Services may be legitimate depending on the environment and how it\u2019s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior using External Remote Services.\n\nAnalytic 1 - Connections to common remote service ports \n\n<code> index=network sourcetype=\"network_traffic\"\n| stats count by src_ip, dest_ip, dest_port, protocol\n| where dest_port=22 OR dest_port=3389 OR dest_port=8443\n| table _time, src_ip, dest_ip, dest_port, protocol </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1008", "name": "Fallback Channels", "descr": "Monitor for newly constructed network connections that may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds. Processes utilizing the network that do not normally have network communication or have never been seen before may be suspicious.\n\nNote: Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on TCP network connection creation. The below analytic is using an event ID from OSQuery. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1105", "name": "Ingress Tool Transfer", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts or creating files on-system may be suspicious. Abnormal use of utilities such as FTP may also be suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1104", "name": "Multi-Stage Channels", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1542", "name": "Pre-OS Boot", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "TFTP Boot", "descr": "Monitor for newly constructed network device configuration and system image against a known-good version to discover unauthorized changes to system boot, startup configuration, or the running OS. (Citation: Cisco IOS Software Integrity Assurance - Secure Boot) (Citation: Cisco IOS Software Integrity Assurance - Image File Verification) The same process can be accomplished through a comparison of the run-time memory, though this is non-trivial and may require assistance from the vendor.", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network device configuration and system image against a known-good version to discover unauthorized changes to system boot, startup configuration, or the running OS. The same process can be accomplished through a comparison of the run-time memory, though this is non-trivial and may require assistance from the vendor."}, {"technique_used": true, "domain": "enterprise", "id": "T1572", "name": "Protocol Tunneling", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1090", "name": "Proxy", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Internal Proxy", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "External Proxy", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Multi-hop Proxy", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. "}, {"domain": "enterprise", "id": "T1219", "name": "Remote Access Tools", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "IDE Tunneling", "descr": "Network traffic directed to `*.tunnels.api.visualstudio.com` or `*.devtunnels.ms` indicate that a system is attempting to initiate or maintain a Visual Studio Code remote tunnel.(Citation: Mnemonic misuse visual studio)\n\nAnalytic 1 - Detect active IDE tunnel to VSCode or JetBrains cloud relay \n\n<code> sourcetype=\"stream:http\" OR sourcetype=\"stream:tcp\"\n(dest_domain=\"*.tunnels.api.visualstudio.com\" OR dest_domain=\"*.devtunnels.ms\")\n| stats count by _time, src_ip, dest_ip, dest_domain, uri_path\n| sort _time desc\n</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Remote Desktop Software", "descr": "Monitor for Outbound connections to known RMM service endpoints (e.g., *.teamviewer.com, *.anydesk.com)\nNew connections from internal systems to unexpected IPs on:\nTCP 5938 (TeamViewer)\nTCP 7070\u20137071 (AnyDesk)\nTCP 5650 (Ammyy Admin)\nTCP/UDP 443, 80, or randomized ports\n\nAnalytic 1 - Detect network traffic for Remote Desktop software \n\n<code> sourcetype=WinEventLog:Microsoft-Windows-Sysmon/Operational EventCode=3\n(DestinationHostname IN (\"*.teamviewer.com\", \"*.anydesk.com\", \"*.logmein.com\", \"*.screenconnect.com\"))\nOR (DestinationPort IN (5938, 7070, 7071, 443) AND Image=\"*\")\n| stats count by Image, DestinationIp, DestinationPort, CommandLine, host, _time\n| sort -_time\n</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. "}, {"domain": "enterprise", "id": "T1021", "name": "Remote Services", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Remote Desktop Protocol", "descr": "Monitor for newly constructed network connections (typically over port 3389) that may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.\n\nAnalytic 1 - Abnormal RDP Network Connections\n\n<code> sourcetype=zeek \n| search dest_port=3389 // Default RDP port\n| stats count by src_ip, dest_ip, dest_port\n| where src_ip!=\"trusted_ips\" AND dest_ip!=\"internal_servers\"</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "SMB/Windows Admin Shares", "descr": "Monitor for newly constructed network connections (typically over ports 139 or 445), especially those that are sent or received by abnormal or untrusted hosts. Correlate these network connections with remote login events and associated SMB-related activity such as file transfers and remote process execution.\n\nNote: Event ID is for Zeek but can also be implemented in other Network Analysis Frameworks by parsing & decoding captured SMB2 network traffic. Preference would be to detect smb2_write_response event (instead of smb2_write_request), because it would confirm the file was actually written to the remote destination. Unfortunately, Bro/Zeek does not have an event for that SMB message-type yet. From a network traffic capture standpoint, it\u2019s important to capture the right traffic for this type of detection to function (e.g., all endpoint to endpoint if possible or workstation to server and workstation to workstation). As such, it is helpful to have a centralized server area where it is possible to monitor communications between servers and endpoints.\n\nAnalytic 1 and 2 are very similar, with the key difference being that Implementation 2 is intended to capture multiple attempts at lateral movement originating from the same host within a short time period (5 minutes).\n\n- smb2_write_request, smb1_write_andx_response is indication of an SMB file write to a Windows Admin File Share: ADMIN$ or C$\n\n- smb2_tree_connect_request, smb1_tree_connect_andx_request is observed originating from the same host, regardless of write-attempts and regardless of whether or not any connection is successful \u2014just connection attempts\u2014 within a specified period of time (REPEATS 5 TIMES WITHIN 5 MINUTES FROM SAME src_ip).\n\nFrom a network traffic capture standpoint, it\u2019s important to capture the right traffic for this type of detection to function (e.g., all endpoint to endpoint if possible or workstation to server and workstation to workstation). As such, it is helpful to have a centralized server area where it is possible to monitor communications between servers and endpoints.The Service Control Manager (SCM) can be used to copy a file to the ADMIN$ share and execute it as a service. This can be detected by looking for incoming RPC network connections to the Service Control Manager, followed by services.exe spawning a child process.\n\nAnalytic 1 - Basic\n\n<code>sourcetype=\"Zeek:SMB_Files\" EventCode IN (\"smb2_write_request\", \"smb1_write_andx_response\", \"smb2_tree_connect_request\", \"smb1_tree_connect_andx_request\") AND (Path=\"ADMIN$\" OR Path=\"C$\")</code>\n\nAnalytic 2 - Port 445 Monitoring \n\n<code> sourcetype=\"network_connection\"\n| search dest_port=445\n| stats count by src_ip, dest_ip, dest_port, _time\n| eval smb_activity=if(count > threshold AND src_ip NOT IN (\"trusted_sources\"), \"suspicious\", \"normal\")\n| where smb_activity=\"suspicious\"\n| table _time, src_ip, dest_ip, dest_port, smb_activity</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Distributed Component Object Model", "descr": "Monitor for newly constructed network connections that may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with remote machines using Distributed Component Object Model (DCOM). Monitor for any influxes or abnormal increases in DCOM related Distributed Computing Environment/Remote Procedure Call (DCE/RPC) traffic (typically over port 135).\n\nRemote Procedure Call (RPC) traffic, especially over port 135, used for DCOM communication. Look for patterns indicating high volumes of RPC calls or connections between systems.\n\nNote: Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on RPC network flows. Traffic to the RPC Endpoint Mapper will always have the destination port of 135. Assuming success, RPC traffic will continue to the endpoint. The endpoint and the client both bind to dynamically assigned ports (on Windows, this is typically greater than 49152). The traffic between the client and endpoint can be detected by looking at traffic to 135 followed by traffic where the source and destination ports are at least 49152.\n\n<code>sourcetype=\"seek\"\n| search dest_port=135 protocol=\"DCE/RPC\"\n| stats count by src_ip, dest_ip, dest_port, _time\n| eval rpc_activity=if(count > threshold AND src_ip NOT IN (\"trusted_ips\"), \"suspicious\", \"normal\")\n| where rpc_activity=\"suspicious\"\n| table _time, src_ip, dest_ip, dest_port, rpc_activity </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "SSH", "descr": "Monitor for newly constructed network connections (typically port 22) that may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into remote machines using Secure Shell (SSH). Use of SSH may be legitimate depending on the environment and how it\u2019s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with SSH.\n\nNetwork Analysis Frameworks such as Zeek can be used to capture, decode, and alert on network traffic. Accordingly, they can be used to look for the creation of SSH network connections.\n\n<code> sourcetype=\"zeek\" dest_port=22 protocol=\"tcp\"\n| stats count by src_ip, dest_ip, dest_port, _time\n| eval ssh_connection_anomaly=if(count > threshold OR src_ip IN (\"untrusted_ips\"), \"suspicious\", \"normal\")\n| where ssh_connection_anomaly=\"suspicious\"\n| table _time, src_ip, dest_ip, ssh_connection_anomaly</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "VNC", "descr": "Monitor for newly constructed network connections that may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely control machines using Virtual Network Computing (VNC). Use of VNC may be legitimate depending on the environment and how it\u2019s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior using VNC. \n\n<code> sourcetype=\"network_traffic\" dest_port=5900 protocol=\"tcp\"\n| stats count by src_ip, dest_ip, dest_port, _time\n| eval vnc_connection_anomaly=if(count > threshold OR src_ip IN (\"untrusted_ips\"), \"suspicious\", \"normal\")\n| where vnc_connection_anomaly=\"suspicious\"\n| table _time, src_ip, dest_ip, vnc_connection_anomaly</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Windows Remote Management", "descr": "\nMonitor for newly constructed network connections using Windows Remote Management (WinRM), such as remote WMI connection attempts (typically over port 5985 when using HTTP and 5986 for HTTPS).\n\n<code> sourcetype=network dest_port IN (5985, 5986) protocol=\"tcp\"\n| stats count by src_ip, dest_ip, dest_port, _time\n| eval network_anomaly=if(count > threshold OR src_ip IN (\"untrusted_ips\"), \"suspicious\", \"normal\")\n| where network_anomaly=\"suspicious\"\n| table _time, src_ip, dest_ip, dest_port, network_anomaly</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a service specifically designed to accept remote connections, such as RDP, telnet, SSH, and VNC. Monitor network connections involving common remote management protocols, such as ports tcp:3283 and tcp:5900, as well as ports tcp: 3389 and tcp:22 for remote login.\n\n<code> index=\"network_logs\" sourcetype=\"network_connection\"\n| search protocol IN (\"tcp/22\", \"tcp/3389\", \"tcp/5900\")\n| stats count by src_ip, dest_ip, dest_port, _time\n| eval suspicious_connection=if(src_ip NOT IN (\"trusted_sources\") AND count > threshold, \"high\", \"normal\")\n| where suspicious_connection=\"high\"\n| table _time, src_ip, dest_ip, dest_port, suspicious_connection</code>\n\n"}, {"technique_used": true, "domain": "ics", "id": "T0886", "name": "Remote Services", "descr": "Monitor for newly constructed network connections into a service specifically designed to accept remote connections, such as RDP, Telnet, SSH, and VNC. Monitor network connections involving common remote management protocols, such as ports tcp:3283 and tcp:5900, as well as ports tcp:3389 and tcp:22 for remote logins. The adversary may use [Valid Accounts](https://attack.mitre.org/techniques/T0859) to enable remote logins.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1018", "name": "Remote System Discovery", "descr": "Monitor for newly constructed network connections associated with pings/scans that may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1496", "name": "Resource Hijacking", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Compute Hijacking", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. Look for connections to/from strange ports, as well as reputation of IPs and URLs related to cryptocurrency hosts. In AWS environments, configure GuardDuty to alert when EC2 instances query IP addresses associated with known cryptocurrency activity.(Citation: AWS GuardDuty EC2 finding types)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Bandwidth Hijacking", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. Look for connections to/from strange ports. ", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts, look for connections to/from strange ports, as well as reputation of IPs and URLs related cryptocurrency hosts. "}, {"technique_used": true, "domain": "enterprise", "id": "T1029", "name": "Scheduled Transfer", "descr": "Monitor for repeated outbound connections to the same destination at scheduled intervals, connections from processes that typically do not initiate network communications, transfers using non-standard ports or unexpected encryption methods.\n\nAnalytic 1 - Detecting Recurring Network Connections for Exfiltration\n\n<code> (EventCode=3)\nOR (source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (dest_ip IN (suspicious_ip_list) OR bytes_out > 5000000)\n| bucket span=1h _time\n| stats count by _time, host, process, dest_ip, bytes_out\n| where count > 3\n| stats count by host, dest_ip, count, earliest(_time), latest(_time)\n| where count >= 3\n| eval risk_score=case(\n    count >= 5, 9,\n    count = 3 OR 4, 7\n)\n| where risk_score >= 7\n| table host, dest_ip, count, earliest, latest, risk_score</code>", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1176", "name": "Software Extensions", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Browser Extensions", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. "}, {"domain": "enterprise", "id": "T1218", "name": "System Binary Proxy Execution", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "CMSTP", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts, such as Sysmon Event 3 (Network connection) where Image contains CMSTP.exe and DestinationIP is external.\n\nNote: Event IDs are for Sysmon (Event ID 1 - process create) and Windows Security Log (Event ID 4688 - a new process has been created). The Analytic looks for the creation of a new CMSTP.exe process which initiates a network connection to a non-local IP address. This is a specific implementation where CMSTP.exe can be leveraged to setup listeners that will receive and install malware from remote sources in a trusted fashion.\n\nAnalytic 1 - CMSTP\n\n<code>(sourcetype=WinEventLog:Microsoft-Windows-Sysmon/Operational EventCode=\"3\") Image=\"C:\\\\Windows\\\\System32\\\\CMSTP.exe\" | WHERE ((!cidrmatch(\"10.0.0.0/8\", SourceIp) AND !cidrmatch(\"192.168.0.0/16\", SourceIp) AND !cidrmatch(\"172.16.0.0/12\", SourceIp))</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Mshta", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "Msiexec", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "010", "name": "Regsvr32", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. "}, {"technique_used": true, "domain": "enterprise", "id": "T1221", "name": "Template Injection", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1205", "name": "Traffic Signaling", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Port Knocking", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Socket Filters", "descr": "Monitor recently started applications creating raw socket connections.(Citation: crowdstrike bpf socket filters)", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. "}, {"technique_used": true, "domain": "enterprise", "id": "T1204", "name": "User Execution", "descr": "Monitor network traffic patterns associated with web-based user actions, such as clicking on phishing links or executing malware that tries to establish C2 communication.\n\nAnalytic 1 - Web-based network connections to suspicious destinations.\n\n<code>sourcetype=sysmon EventCode=3\n| search process_name IN (\"winword.exe\", \"chrome.exe\", \"firefox.exe\") \n| stats count by src_ip dest_ip dest_port process_name\n| where dest_ip NOT IN (\"<known_good_ips>\") </code>", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Malicious Link", "descr": "Monitor for network connections to suspicious or external sites shortly after a user clicks on a link, especially if the URL is linked to phishing or malicious activities.\n\nAnalytic 1 - Web-based network connections to suspicious destinations.\n\n<code>sourcetype=network_connection\n| search process_name IN (\"chrome.exe\", \"firefox.exe\", \"iexplore.exe\", \"msedge.exe\") OR src_ip IN (\"<suspicious_ips>\")</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Malicious Copy and Paste", "descr": "Monitor network traffic patterns associated with user actions, such as initiating connections to suspicious sites. ", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0863", "name": "User Execution", "descr": "Monitor for newly constructed web-based network connections that are sent to malicious or suspicious destinations (e.g., destinations attributed to phishing campaigns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments (e.g., monitor anomalies in use of files that do not normally initiate network connections or unusual connections initiated by regsvr32.exe, rundll.exe, SCF, HTA, MSI, DLLs, or msiexec.exe). ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1102", "name": "Web Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Bidirectional Communication", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "One-Way Communication", "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. ", "subtechniques": [], "color": 1}], "descr": "Monitor for newly constructed network connections that are sent or received by untrusted hosts. "}, {"domain": "mobile", "id": "T1481", "name": "Web Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "mobile", "id": "001", "name": "Dead Drop Resolver", "descr": "Many properly configured firewalls may naturally block command and control traffic.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "mobile", "id": "002", "name": "Bidirectional Communication", "descr": "Many properly configured firewalls may naturally block bidirectional command and control traffic.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "mobile", "id": "003", "name": "One-Way Communication", "descr": "Many properly configured firewalls may naturally block one-way command and control traffic.", "subtechniques": [], "color": 1}], "descr": "Many properly configured firewalls may naturally block command and control traffic."}, {"technique_used": true, "domain": "enterprise", "id": "T1669", "name": "Wi-Fi Networks", "descr": "Monitor for newly constructed network connections that are sent to or received by abnormal or untrusted hosts.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1047", "name": "Windows Management Instrumentation", "descr": "Monitor network traffic for WMI connections for potential use to remotely edit configuration, start services, or query files. When remote WMI requests are over RPC it connects to a DCOM interface within the RPC group <code>netsvcs</code>. To detect this activity, a sensor is needed at the network level that can decode RPC traffic or on the host where the communication can be detected more natively, such as\u00a0Event Tracing for Windows. Using wireshark/tshark decoders, the WMI interfaces can be extracted so that WMI activity over RPC can be detected. Although the description details how to detect remote WMI precisely, a decent estimate has been to look for the string RPCSS within the initial RPC connection on 135/tcp. It returns a superset of this activity, and will trigger on all DCOM-related services running within RPC, which is likely to also be activity that should be detected between hosts. More about RPCSS at :\u00a0rpcss_dcom_interfaces.html\n\nLook for instances of the WMI querying in network traffic, and find the cases where a process is launched immediately after a connection is seen. This essentially merges the request to start a remote process via WMI with the process execution. If other processes are spawned from wmiprvse.exe in this time frame, it is possible for race conditions to occur, and the wrong process may be merged. If this is the case, it may be useful to look deeper into the network traffic to see if the desired command can be extracted.\n\nAfter the WMI connection has been initialized, a process can be remotely launched using the command:\u00a0<code>wmic /node:\"<hostname>\" process call create \"<command line>\"</code>, which is detected in the third Detection Pseudocode. \n\nThis leaves artifacts at both a network (RPC) and process (command line) level. When <code>wmic.exe</code> (or the schtasks API) is used to remotely create processes, Windows uses RPC (135/tcp) to communicate with the the remote machine.\n\nAfter RPC authenticates, the RPC endpoint mapper opens a high port connection, through which the schtasks Remote Procedure Call is actually implemented. With the right packet decoders, or by looking for certain byte streams in raw data, these functions can be identified.\n\nWhen the command line is executed, it has the parent process of\u00a0<code>C:\\windows\\system32\\wbem\\WmiPrvSE.exe</code>. This analytic looks for these two events happening in sequence, so that the network connection and target process are output.\n\nCertain strings can be identifiers of the WMI by looking up the interface UUID for <code>IRemUnknown2</code> in different formats\n- UUID\u00a0<code>00000143-0000-0000-c000-000000000046</code>\u00a0(decoded)\n- Hex\u00a0<code>43 01 00 00 00 00 00 00 c0 00 00 00 00 00 00 46</code>\u00a0(raw)\n- ASCII\u00a0<code>CF</code>\u00a0(printable text only)\n\nThis identifier is present three times during the RPC request phase. Any sensor that has access to the byte code as raw, decoded, or ASCII could implement this analytic. The transfer syntax is\n- UUID\u00a0<code>8a885d04-1ceb-11c9-9fe8-08002b104860</code>\u00a0(decoded)\n- Hex\u00a0<code>04 5d 88 8a eb 1c c9 11 9f e8 08 00 2b 10 48 60</code>\u00a0(raw)\n- ASCII <code>`]+H``</code> (printable text only)\n\nThus, a great ASCII based signature is\n- <code>*CF*]+H*CF*CF*host*\"</code>\n\nNote: To detect WMI over RPC (using DCOM), a sensor needs to exist that has the insight into individual connections and can actually decode and make sense of RPC traffic. Specifically, WMI can be detected by looking at RPC traffic where the target interface matches that of WMI, which is IRemUnknown2. Look for instances of the WMI querying in network traffic, and find the cases where a process is launched immediately after a connection is seen. This essentially merges the request to start a remote process via WMI with the process execution. If other processes are spawned from\u00a0wmiprvse.exe in this time frame, it is possible for race conditions to occur, and the wrong process may be merged. If this is the case, it may be useful to look deeper into the network traffic to see if the desired command can be extracted.\n\nAnalytic 1 - Monitor for WMI over RPC (DCOM) connections. Look for the string RPCSS within the initial RPC connection on port 135/tcp.\n\n<code> index=windows_logs sourcetype=WinEventLog:Security OR sourcetype=WinEventLog:Microsoft-Windows-Sysmon/Operational OR sourcetype=WinEventLog:Microsoft-Windows-Security-Auditing\n| eval ProcessName=lower(ProcessName), CommandLine=lower(CommandLine)\n| search ProcessName IN (\"wmic.exe\", \"powershell.exe\", \"wmiprvse.exe\", \"wmiadap.exe\", \"scrcons.exe\", \"wbemtool.exe\")\n| search CommandLine IN (\"*process call create*\", \"*win32_process*\", \"*win32_service*\", \"*shadowcopy delete*\", \"*network*\")\n| search (sourcetype=\"WinEventLog:Security\" EventCode=4688) OR (sourcetype=\"WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1)\n| join ProcessName [ search index=windows_logs sourcetype=WinEventLog:Microsoft-Windows-Sysmon/Operational EventCode=3 \n| eval DestinationIp = coalesce(DestinationIp, dest_ip)\n| eval DestinationPort = coalesce(DestinationPort, dest_port)\n| search DestinationPort IN (135, 5985, 5986) ]\n| stats count by _time, ComputerName, User, ProcessName, CommandLine, DestinationIp, DestinationPort, dest, src_ip, dest_ip\n| eval alert_message=\"Suspicious WMI Network Connection Detected: \" + ProcessName + \" executed by \" + User + \" on \" + ComputerName + \" with command: \" + CommandLine + \" connecting to \" + DestinationIp + \":\" + DestinationPort\n| where NOT (User=\"SYSTEM\" OR ProcessName=\"wmiprvse.exe\" OR (src_ip=\"trusted_ip_range\" AND DestinationIp=\"trusted_ip_range\"))\n| table _time, ComputerName, User, ProcessName, CommandLine, DestinationIp, DestinationPort, src_ip, dest_ip, alert_message</code>", "subtechniques": [], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise", "mobile", "ics"]}, {"name": "Network Traffic Content", "descr": "The full packet capture (PCAP) or session data that logs both protocol headers and payload content. This allows analysts to inspect command and control (C2) traffic, exfiltration, and other suspicious activity within network communications. Unlike metadata-based logs, full content analysis enables deeper protocol inspection, payload decoding, and forensic investigations.\n\n*Data Collection Measures:*\n\n- Network Packet Capture (Full Content Logging)\n    - Wireshark / tcpdump / tshark\n        - Full packet captures (PCAP files) for manual analysis or IDS correlation. `tcpdump -i eth0 -w capture.pcap`\n    - Zeek (formerly Bro)\n        - Extracts protocol headers and payload details into structured logs. `echo \"redef Log::default_store = Log::ASCII;\" > local.zeek | zeek -Cr capture.pcap local.zeek`\n    - Suricata / Snort (IDS/IPS with PCAP Logging)\n        - Deep packet inspection (DPI) with signature-based and behavioral analysis. `suricata -c /etc/suricata/suricata.yaml -i eth0 -l /var/log/suricata`\n- Host-Based Collection\n    - Sysmon Event ID 22 \u2013 DNS Query Logging, Captures DNS requests made by processes, useful for detecting C2 domains.\n    - Sysmon Event ID 3 \u2013 Network Connection Initiated, Logs process-to-network connection relationships.\n    - AuditD (Linux) \u2013 syscall=connect, Monitors outbound network requests from processes. `auditctl -a always,exit -F arch=b64 -S connect -k network_activity`\n- Cloud & SaaS Traffic Collection\n    - AWS VPC Flow Logs / Azure NSG Flow Logs / Google VPC Flow Logs, Captures metadata about inbound/outbound network traffic.\n    - Cloud IDS (AWS GuardDuty, Azure Sentinel, Google Chronicle), Detects malicious activity in cloud environments by analyzing network traffic patterns.", "techniques": [{"domain": "enterprise", "id": "T1087", "name": "Account Discovery", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Domain Account", "descr": "Monitor and analyze traffic patterns and packet inspection associated to LDAP and MSRPC that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure).", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "ics", "id": "T0800", "name": "Activate Firmware Update Mode", "descr": "Monitor ICS automation network protocols for information that an asset has been placed into Firmware Update Mode.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1595", "name": "Active Scanning", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Scanning IP Blocks", "descr": "Monitoring the content of network traffic can help detect patterns associated with active scanning activities. This can include identifying repeated connection attempts, unusual scanning behaviors, or probing activity targeting multiple IP addresses across a network.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Vulnerability Scanning", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Wordlist Scanning", "descr": "Monitor for suspicious network traffic that could be indicative of scanning, such as large quantities originating from a single source (especially if the source is known to be associated with an adversary/botnet).", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"technique_used": true, "domain": "enterprise", "id": "T1557", "name": "Adversary-in-the-Middle", "descr": "Monitor network traffic for anomalies associated with known AiTM behavior.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "LLMNR/NBT-NS Poisoning and SMB Relay", "descr": "Monitor for traffic on ports UDP 5355 and UDP 137 if LLMNR/NetBIOS is disabled by security policy.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "ARP Cache Poisoning", "descr": "Monitor network traffic for unusual ARP traffic, gratuitous ARP replies may be suspicious. Consider collecting changes to ARP caches across endpoints for signs of ARP poisoning. For example, if multiple IP addresses map to a single MAC address, this could be an indicator that the ARP cache has been poisoned.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "DHCP Spoofing", "descr": "Monitor network traffic for suspicious/malicious behavior involving DHCP, such as changes in DNS and/or gateway parameters. Additionally, monitor network traffic for rogue DHCPv6 activity.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Evil Twin", "descr": "Monitor network traffic for suspicious/malicious behavior involving evil twin attacks. Intrusion prevention systems (WIDS) can identify traffic patterns indicative of activity associated with evil twins, rogue access points, and adversary-in-the-middle activity.\n", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0830", "name": "Adversary-in-the-Middle", "descr": "Monitor network traffic for anomalies associated with known AiTM behavior. For Collection activity where transmitted data is not manipulated, anomalies may be present in network management protocols (e.g., ARP, DHCP).", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1071", "name": "Application Layer Protocol", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Web Protocols", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "File Transfer Protocols", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Mail Protocols", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "DNS", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for DNS over TLS (DoT) and DNS over HTTPS (DoH), that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Publish/Subscribe Protocols", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"technique_used": true, "domain": "ics", "id": "T0802", "name": "Automated Collection", "descr": "Monitor for information collection on assets that may indicate deviations from standard operational tools. Examples include unexpected industrial automation protocol functions, new high volume communication sessions, or broad collection across many hosts within the network. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1020", "name": "Automated Exfiltration", "descr": "Monitor network traffic content for evidence of data exfiltration, such as gratuitous or anomalous outbound traffic containing collected data. Consider correlation with process monitoring and command lines associated with collection and exfiltration.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0806", "name": "Brute Force I/O", "descr": "Monitor network traffic for ICS functions related to write commands for an excessive number of I/O points or manipulating a single value an excessive number of times.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1612", "name": "Build Image on Host", "descr": "Monitor for network traffic associated with requests and/or downloads of container images, especially those that may be anomalous or known malicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0892", "name": "Change Credential", "descr": "Monitor for device credential changes observable in automation or management network protocols.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0858", "name": "Change Operating Mode", "descr": "Monitor ICS management protocols for functions that change an asset\u2019s operating mode.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0885", "name": "Commonly Used Port", "descr": "Monitor for mismatches between protocols and their expected ports (e.g., non-HTTP traffic on tcp:80). Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1586", "name": "Compromise Accounts", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Social Media Accounts", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0884", "name": "Connection Proxy", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g., extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g., monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1659", "name": "Content Injection", "descr": "Monitor for other unusual network traffic that may indicate additional malicious content transferred to the system. Use network intrusion detection systems, sometimes with SSL/TLS inspection, to look for known malicious payloads, content obfuscation, and exploit code.\n\nAnalytic 1 - Detecting Content Injection in Network Traffic\n\n<code> (EventCode=3)\nOR (source=\"zeek_http_logs\" response_code IN (302, 307) AND url IN (malicious_redirect_list))\nOR (source=\"proxy_logs\" response_body_content IN (suspicious_script_list))\n| eval risk_score=case(\n    response_code=302 AND url IN (malicious_redirect_list), 9,\n    response_body_content IN (suspicious_script_list), 8,\n    url LIKE \"%@%\", 7\n)\n| where risk_score >= 7\n| stats count by _time, host, user, url, response_code, risk_score</code>", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1132", "name": "Data Encoding", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Standard Encoding", "descr": "Monitor for network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Non-Standard Encoding", "descr": "Monitor for network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.", "subtechniques": [], "color": 1}], "descr": "Monitor for network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.\n\nNote: Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on network protocols and packet contents. "}, {"technique_used": true, "domain": "enterprise", "id": "T1602", "name": "Data from Configuration Repository", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g. unauthorized, gratuitous, or anomalous traffic patterns attempting to access configuration content)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "SNMP (MIB Dump)", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flow (e.g. snmp traffic originating from unauthorized or untrusted hosts, signature detection for strings mapped to device configuration(s), and anomolies in snmp request(s))", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Network Device Configuration Dump", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g. unauthorized, gratuitous, or anomalous traffic patterns attempting to access network configuration content)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1039", "name": "Data from Network Shared Drive", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1565", "name": "Data Manipulation", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Transmitted Data Manipulation", "descr": "Monitor for networks that solicits and obtains the configuration information of the queried device. ", "subtechniques": [], "color": 1}], "descr": "Monitor for networks that solicits and obtains the configuration information of the queried device. "}, {"domain": "enterprise", "id": "T1001", "name": "Data Obfuscation", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Junk Data", "descr": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Steganography", "descr": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Protocol or Service Impersonation", "descr": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)", "subtechniques": [], "color": 1}], "descr": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)"}, {"technique_used": true, "domain": "enterprise", "id": "T1491", "name": "Defacement", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g. unauthorized, gratuitous, or anomalous traffic patterns attempting to access internal and external websites and services). Consider correlating with application monitoring for indication of unplanned service interruptions or unauthorized content changes.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Internal Defacement", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "External Defacement", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0812", "name": "Default Credentials", "descr": "Monitor network traffic for default credential use in protocols that allow unencrypted authentication.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0814", "name": "Denial of Service", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g., extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g., monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0868", "name": "Detect Operating Mode", "descr": "Monitor ICS automation network protocols for functions related to reading an asset\u2019s operating mode. In some cases, there may be multiple ways to detect a device\u2019s operating mode, one of which is typically used in the operational environment. Monitor for the operating mode being checked in unexpected ways.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0816", "name": "Device Restart/Shutdown", "descr": "Monitor ICS automation protocols for functions that restart or shutdown a device. Commands to restart or shutdown devices may also be observable in traditional IT management protocols.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1482", "name": "Domain Trust Discovery", "descr": "Monitor and analyze traffic patterns and packet inspection associated to LDAP and MSRPC that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "mobile", "id": "T1407", "name": "Download New Code at Runtime", "descr": "Mobile security products may provide URL inspection services that could determine if a domain being visited is malicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1189", "name": "Drive-by Compromise", "descr": "Detect suspicious script execution over HTTP/S. Identify JavaScript payloads with obfuscation or encoded execution. Look for exploit attempts in network payloads.\n\n<code> (EventCode=5156 dest_port=80 OR dest_port=443 process=\"chrome.exe\" OR process=\"firefox.exe\")\nOR (source=\"/var/log/zeek/http.log\" method=\"GET\" uri IN (suspicious_js_files))\n| stats count by src_ip, dest_ip, uri, user_agent\n| where count > 3</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0817", "name": "Drive-by Compromise", "descr": "Monitor for unusual network traffic that may indicate additional tools transferred to the system. Use network intrusion detection systems, sometimes with SSL/TLS inspection, to look for known malicious scripts (recon, heap spray, and browser identification scripts have been frequently reused), common script obfuscation, and exploit code.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1568", "name": "Dynamic Resolution", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "DNS Calculation", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1573", "name": "Encrypted Channel", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Symmetric Cryptography", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Asymmetric Cryptography", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"domain": "enterprise", "id": "T1499", "name": "Endpoint Denial of Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "OS Exhaustion Flood", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Service Exhaustion Flood", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Application Exhaustion Flood", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Application or System Exploitation", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"domain": "enterprise", "id": "T1585", "name": "Establish Accounts", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Social Media Accounts", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"domain": "enterprise", "id": "T1048", "name": "Exfiltration Over Alternative Protocol", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration Over Symmetric Encrypted Non-C2 Protocol", "descr": "Monitor for encrypted payloads using symmetric cryptography over plaintext channels, detection of RC4, AES, or Blowfish in network traffic, or HTTP, FTP, or DNS packets containing unusually long Base64 or XOR-encoded strings.\n\nAnalytic 1 - Detecting Encrypted Payloads in Alternative Protocols\n\n<code> (EventCode=3 OR source=\"zeek_http.log\" OR source=\"dns.log\")\n| where (uri_length > 200 OR request_body_length > 5000)\n| eval encoded_data=if(match(uri, \"([A-Za-z0-9+/=]{100,})\") OR match(request_body, \"([A-Za-z0-9+/=]{100,})\"), 1, 0)\n| where encoded_data=1\n| stats count by _time, host, user, uri, request_body_length, risk_score\n| eval risk_score=case(\n    request_body_length > 10000, 9,\n    request_body_length > 5000, 8\n)\n| where risk_score >= 8\n| table host, uri, request_body_length, risk_score</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Exfiltration Over Asymmetric Encrypted Non-C2 Protocol", "descr": "Monitor for asymmetric encryption key exchange over unexpected network channels, detection of long Base64, PEM, or PGP keys transmitted in network payloads, or TLS handshakes or encrypted payloads in non-TLS standard traffic.\n\nAnalytic 1 - Detecting Encrypted Payloads in Non-C2 Channels\n\n<code>(EventCode=3 OR source=\"zeek_http.log\" OR source=\"dns.log\")\n| where (uri_length > 200 OR request_body_length > 5000)\n| eval encoded_data=if(match(uri, \"-----BEGIN (RSA|EC|PGP) PRIVATE KEY-----\") OR match(request_body, \"-----BEGIN (RSA|EC|PGP) PUBLIC KEY-----\"), 1, 0)\n| where encoded_data=1\n| stats count by _time, host, user, uri, request_body_length, risk_score\n| eval risk_score=case(\n    request_body_length > 10000, 9,\n    request_body_length > 5000, 8\n)\n| where risk_score >= 8\n| table host, uri, request_body_length, risk_score </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Exfiltration Over Unencrypted Non-C2 Protocol", "descr": "Monitor for data obfuscation methods such as Base64, XOR, or URL encoding in HTTP requests, use of TFTP, FTP, or DNS for data exfiltration, or outbound requests containing encoded strings in GET or POST parameters.\n\nAnalytic 1 - Detecting Encoded Data in Unencrypted Alternative Protocols \n\n<code> (EventCode=3 OR source=\"zeek_http.log\" OR source=\"dns.log\")\n| where (uri_length > 200 OR request_body_length > 5000)\n| eval encoded_data=if(match(uri, \"([A-Za-z0-9+/=]{100,})\") OR match(request_body, \"([A-Za-z0-9+/=]{100,})\"), 1, 0)\n| where encoded_data=1\n| stats count by _time, host, user, uri, request_body_length, risk_score\n| eval risk_score=case(\n    request_body_length > 10000, 9,\n    request_body_length > 5000, 8\n)\n| where risk_score >= 8\n| table host, uri, request_body_length, risk_score</code>", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"technique_used": true, "domain": "enterprise", "id": "T1041", "name": "Exfiltration Over C2 Channel", "descr": "Hidden or encoded data inside normal C2 traffic (e.g., Base64, XOR, custom encoding).\nHTTP/S payloads with unusual long strings in GET/POST requests.\nDNS tunneling techniques used to bypass security controls.\n\nAnalytic 1 - Detecting Encoded or Hidden Data in C2 Channels\n\n<code>(EventCode=3 OR source=\"zeek_http.log\" OR source=\"dns.log\")\n| where (uri_length > 200 OR request_body_length > 5000)\n| eval encoded_data=if(match(uri, \"([A-Za-z0-9+/=]{100,})\") OR match(request_body, \"([A-Za-z0-9+/=]{100,})\"), 1, 0)\n| where encoded_data=1\n| stats count by _time, host, user, uri, request_body_length, risk_score\n| eval risk_score=case(\n    request_body_length > 10000, 9,\n    request_body_length > 5000, 8\n)\n| where risk_score >= 8\n| table host, uri, request_body_length, risk_score </code>", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1011", "name": "Exfiltration Over Other Network Medium", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration Over Bluetooth", "descr": "Monitor high-volume data transfers over Bluetooth, Bluetooth PAN being used to route exfiltrated data, or Unusual Bluetooth protocol usage on enterprise endpoints.\n\nAnalytic 1 - Detecting Large Data Exfiltration via Bluetooth\n\n<code> (EventCode=3)\nOR (source=\"zeek_conn.log\" protocol=\"bluetooth\" bytes_out > 5000000)\nOR (source=\"firewall_logs\" protocol=\"bluetooth\" bytes_out > 10000000)\n| eval risk_score=case(\n    bytes_out > 10000000, 9,\n    bytes_out > 5000000, 8\n)\n| where risk_score >= 8\n| stats count by _time, host, user, dest_device, bytes_out, risk_score</code>", "subtechniques": [], "color": 1}], "descr": "Monitor high-volume data transfers over secondary network connections, outbound SSH/SFTP connections over unauthorized networks, or anomalous encryption methods used for data exfiltration.\n\nAnalytic 1 - Detecting Large Data Exfiltration via Alternate Network \n\n<code> (EventCode=3)\nOR (source=\"zeek_conn.log\" dest_port IN (22, 443, 53) AND bytes_out > 5000000)\nOR (source=\"firewall_logs\" bytes_out > 10000000)\n| eval risk_score=case(\n    bytes_out > 10000000, 9,\n    bytes_out > 5000000, 8\n)\n| where risk_score >= 8\n| stats count by _time, host, user, dest_ip, dest_port, bytes_out, risk_score</code>"}, {"domain": "enterprise", "id": "T1567", "name": "Exfiltration Over Web Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration to Code Repository", "descr": "Monitor for outbound network connections to code repository services (e.g., github.com, gitlab.com), web API calls to repository endpoints (POST https://api.github.com/repos/...), or SSH traffic to Git services (git@github.com:username/repo.git).\n\nAnalytic 1 - Detecting Outbound Connections to Code Repositories \n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (dest_ip IN (known_code_repos) AND bytes_out > 5000000)\n| stats count, sum(bytes_out) as total_bytes by _time, host, process, dest_ip\n| where total_bytes > 50000000\n| eval risk_score=case(\n    total_bytes > 100000000, 9,\n    total_bytes > 50000000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, risk_score</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Exfiltration to Cloud Storage", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Exfiltration to Text Storage Sites", "descr": "Monitor and analyze network traffic for exfiltration attempts using text storage sites, i.e. POST requests to text storage sites, Base64 or other obfuscated data within outbound web requests, or unusual user-agent strings indicating API-based exfiltration.'\n\nAnalytic 1 - Detecting Large Data Transfers to Pastebin or Similar Services \n\n<code> (EventCode=3 OR source=\"zeek_http.log\" OR source=\"firewall_logs\")\n| where (dest_domain LIKE \"*.pastebin.com\" OR dest_domain LIKE \"*.hastebin.com\" OR dest_domain LIKE \"*.rentry.co\" OR dest_domain LIKE \"*.ghostbin.com\")\n| where (http_method=\"POST\")\n| stats count, sum(bytes_out) as total_bytes by _time, host, user, dest_domain, user_agent\n| where total_bytes > 500000\n| eval risk_score=case(\n    total_bytes > 10000000, 9,\n    total_bytes > 500000, 8\n)\n| where risk_score >= 8\n| table host, user, dest_domain, total_bytes, user_agent, risk_score</code> ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Exfiltration Over Webhook", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g., extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g., monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)). ", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"technique_used": true, "domain": "enterprise", "id": "T1190", "name": "Exploit Public-Facing Application", "descr": "Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection strings or known payloads. For example, monitor for successively chained functions that adversaries commonly abuse (i.e. gadget chaining) through unsafe deserialization to exploit publicly facing applications for initial access.(Citation: Now You Serial) In AWS environments, monitor VPC flow logs and/or Elastic Load Balancer (ELB) logs going to and from instances hosting externally accessible applications.\n\n<code> (source=\"/var/log/zeek/http.log\" OR source=\"C:\\\\Windows\\\\System32\\\\LogFiles\\\\Firewall\")\n| regex http_request=\"(?i)select.*from|union.*select|cmd=.*|exec=.*\"\n| stats count by src_ip, dest_ip, http_method, uri_path\n| where count > 10\n| table _time, src_ip, dest_ip, http_method, uri_path, count</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0819", "name": "Exploit Public-Facing Application", "descr": "Use deep packet inspection to look for artifacts of common exploit traffic, such as known payloads.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1210", "name": "Exploitation of Remote Services", "descr": "Use deep packet inspection to look for artifacts of common exploit traffic, such as known payloads.\n\n<code> sourcetype=\"network:packet_capture\" OR sourcetype=\"ids:alert\"\n| search (alert IN (\"SMB Exploit Detected\", \"RDP Exploit Attempt\", \"MySQL Exploit Attempt\")) OR (src_port IN (445, 3389, 3306))\n| stats count by src_ip, dest_ip, dest_port, protocol, signature, _time\n| eval anomaly_detected=if(count > threshold OR match(signature, \"Exploit Attempt|Remote Code Execution\"), \"suspicious\", \"normal\")\n| where anomaly_detected=\"suspicious\"\n| table _time, src_ip, dest_ip, dest_port, protocol, signature, anomaly_detected</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "mobile", "id": "T1428", "name": "Exploitation of Remote Services", "descr": "Network traffic analysis could reveal patterns of compromise if devices attempt to access unusual targets or resources. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0866", "name": "Exploitation of Remote Services", "descr": "Use deep packet inspection to look for artifacts of common exploit traffic, such as known payloads.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1133", "name": "External Remote Services", "descr": "Analyze traffic to detect anomalous requests, API usage, or data transfers. Anomalous content within network traffic, such as unexpected API calls, file transfers, or large data uploads.\nUnusual commands or payloads transmitted through remote service channels.\n\nAnalytic 1 - Large data transfers over remote service connections \n\n<code> index=network sourcetype=\"network_packet_capture\"\n| stats count by src_ip, dest_ip, data_size, protocol\n| where data_size > 1000000\n| table _time, src_ip, dest_ip, data_size, protocol </code> ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1187", "name": "Forced Authentication", "descr": "For internal traffic, monitor the workstation-to-workstation unusual (vs. baseline) SMB traffic. For many networks there should not be any, but it depends on how systems on the network are configured and where resources are located.\n\nAnalytic 1 - Detection of NTLM hash traffic or other suspicious authentication traffic.\n\n<code> index=network sourcetype=\"stream:tcp\" (dest_port=445 OR dest_port=80 OR dest_port=443) | eval Protocol=case(dest_port==445, \"SMB\", dest_port==80, \"HTTP\", dest_port==443, \"HTTPS\", true(), \"Unknown\")\n| search (command IN (\"NTLMSSP_NEGOTIATE\", \"NTLMSSP_AUTH\")) | eval SuspiciousAuth=case(\n    match(_raw, \"NTLMSSP_NEGOTIATE\"), \"NTLM Negotiate\",\n    match(_raw, \"NTLMSSP_AUTH\"), \"NTLM Authentication\",\n    true(), \"Unknown\"\n)</code>", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1589", "name": "Gather Victim Identity Information", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Email Addresses", "descr": "Monitor for suspicious network traffic that could be indicative of probing for email addresses and/or usernames, such as large/iterative quantities of authentication requests originating from a single source (especially if the source is known to be associated with an adversary/botnet). Analyzing web metadata may also reveal artifacts that can be attributed to potentially malicious activity, such as referer or user-agent string HTTP/S fields.", "subtechniques": [], "color": 1}], "descr": "Monitor for suspicious network traffic that could be indicative of probing for user information, such as large/iterative quantities of authentication requests originating from a single source (especially if the source is known to be associated with an adversary/botnet). Analyzing web metadata may also reveal artifacts that can be attributed to potentially malicious activity, such as referer or user-agent string HTTP/S fields."}, {"technique_used": true, "domain": "enterprise", "id": "T1615", "name": "Group Policy Discovery", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0891", "name": "Hardcoded Credentials", "descr": "Monitor network traffic for hardcoded credential use in protocols that allow unencrypted authentication.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1665", "name": "Hide Infrastructure", "descr": "Network detection systems may be able to identify traffic for specific adversary command and control infrastructure. Correlate network traffic with data and patterns from Internet-facing resources gathered from scans to gain further insight into potential adversary C2 networks.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1070", "name": "Indicator Removal", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Network Share Connection Removal", "descr": "Monitoring for SMB traffic between systems may also be captured and decoded to look for related network share session and file transfer activity.", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"technique_used": true, "domain": "enterprise", "id": "T1105", "name": "Ingress Tool Transfer", "descr": "Monitor network traffic content for files and other potentially malicious content, especially data coming in from abnormal/unknown domain and IPs.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1534", "name": "Internal Spearphishing", "descr": "Monitor for communication traffic containing suspicious payloads or URLs, especially those associated with internal email or chat systems. Analyze for outbound or inbound traffic related to known or newly registered domains that could be used for credential phishing or payload delivery.\n\n<code> sourcetype=\"network:packet_capture\" OR sourcetype=\"ids:alert\"\n| search (http_request_uri=\"*.php?login\" OR dns IN (\"suspiciousdomain.com\", \"newly-registered-domain.com\")) OR (http_method=\"POST\" AND url_length > threshold)\n| stats count by src_ip, dest_ip, dest_port, protocol, http_request_uri, _time\n| eval anomaly_detected=if(count > threshold OR match(http_request_uri, \"login|credentials|reset\"), \"suspicious\", \"normal\")\n| where anomaly_detected=\"suspicious\"\n| table _time, src_ip, dest_ip, http_request_uri, protocol, anomaly_detected</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0883", "name": "Internet Accessible Device", "descr": "Monitor for unusual logins to Internet connected devices or unexpected protocols to/from the Internet. Network traffic content will provide valuable context and details about the content of network flows.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1570", "name": "Lateral Tool Transfer", "descr": "Monitor for unusual processes with internal network connections creating files on-system may be suspicious \n\nNote: Analytic Event Type is for Zeek but can also be implemented in other Network Analysis Frameworks by parsing & decoding captured SMB2 network traffic. From a network traffic capture standpoint, it\u2019s important to capture the right traffic for this type of detection to function (e.g., all endpoint to endpoint if possible or workstation to server and workstation to workstation). As such, it is helpful to have a centralized server area where it is possible to monitor communications between servers and endpoints.\n", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0867", "name": "Lateral Tool Transfer", "descr": "Monitor for unusual processes with internal network connections creating files on-system which may be suspicious. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0838", "name": "Modify Alarm Settings", "descr": "Monitor for alarm setting changes observable in automation or management network protocols.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0836", "name": "Modify Parameter", "descr": "Monitor ICS management protocols for parameter changes, including for unexpected values, changes far exceeding standard values, or for parameters being changed in an unexpected way (e.g., via a new function, at an unusual time).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0889", "name": "Modify Program", "descr": "Monitor device management protocols for functions that modify programs such as online edit and program append events.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0839", "name": "Module Firmware", "descr": "Monitor ICS management protocols / file transfer protocols for protocol functions related to firmware changes.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0801", "name": "Monitor Process State", "descr": "Monitor ICS automation network protocols for functions related to reading an operational process state (e.g., \u201cRead\u201d function codes in protocols like DNP3 or Modbus). In some cases, there may be multiple ways to monitor an operational process\u2019 state, one of which is typically used in the operational environment. Monitor for the operating mode being checked in unexpected ways.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1599", "name": "Network Boundary Bridging", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Network Address Translation Traversal", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1095", "name": "Non-Application Layer Protocol", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).\n\nWhile VMCI traffic is invisible to most traditional network sniffing tools, there are ways to potentially monitor this traffic.(Citation: Google Cloud Threat Intelligence ESXi Hardening 2023)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1571", "name": "Non-Standard Port", "descr": "Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1003", "name": "OS Credential Dumping", "descr": "Monitor for network protocols  (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft NRPC Dec 2017) and other replication requests (Citation: Microsoft SAMR) from IPs not associated with known domain controllers. (Citation: AdSecurity DCSync Sept 2015)\n\nAnalytic 1 - Anomalous network traffic content related to credential managers \n\n<code>index=network sourcetype=\"stream:tcp\" dest_port=389 NOT [| inputlookup known_dc_ip_addresses | fields ip]\n| eval SourceIP = src_ip, DestinationIP = dest_ip, Protocol = proto\n| search (content=\"LDAPSearchRequest\") OR (content=\"LDAPModifyRequest\") OR (content=\"bindRequest\") OR (content=\"searchResEntry\") OR (content=\"NTDS.dit\")</code>", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "DCSync", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1566", "name": "Phishing", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Spearphishing Attachment", "descr": "Monitor for clicks on phishing links leading to credential harvesting, traffic to newly registered or suspicious domains, hidden redirect chains embedded in phishing emails, or downloads of secondary payloads from phishing domains.\n\nAnalytic 1 - Detecting Phishing URL Clicks\n\n<code>(EventCode=3)\nOR (source=\"zeek_http_logs\" uri IN (malicious_url_list))\nOR (source=\"proxy_logs\" url IN (malicious_url_list))\n| eval risk_score=case(\n    domain IN (\"bit.ly\", \"tinyurl.com\"), 8,\n    domain IN (\"*.xyz\", \"*.top\"), 7,\n    uri IN (malicious_url_list), 9\n)\n| where risk_score >= 7\n| stats count by _time, host, user, uri, domain, risk_score </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Spearphishing Link", "descr": "Monitor and analyze SSL/TLS traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g. extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).\n\nFurthermore, monitor network traffic for cloned sites as well as homographs via the use of internationalized domain names abusing different character sets (e.g. Cyrillic vs Latin versions of trusted sites). \n\nAnalytic 1 - Detecting Clicks on Malicious Links in Phishing Emails\n\n<code> (EventCode=3)\nOR (source=\"zeek_http_logs\" uri IN (malicious_url_list))\nOR (source=\"proxy_logs\" url IN (malicious_url_list))\n| eval risk_score=case(\n    domain IN (\"bit.ly\", \"tinyurl.com\"), 8,\n    domain IN (\"*.xyz\", \"*.top\"), 7,\n    uri IN (malicious_url_list), 9\n)\n| where risk_score >= 7\n| stats count by _time, host, user, uri, domain, risk_score</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Spearphishing via Service", "descr": "Monitor for outbound connections to personal email, social media, or file-sharing platforms, shortened URLs or redirect chains in chat messages, links leading to newly registered or uncommon domains, or encrypted traffic indicating potential TLS phishing interactions.\n\nAnalytic 1 - Detecting Spearphishing Links from Third-Party Services\n\n<code> (EventCode=3)\nOR (source=\"zeek_http_logs\" uri IN (malicious_url_list))\nOR (source=\"proxy_logs\" url IN (malicious_url_list))\n| eval risk_score=case(\n    domain IN (\"bit.ly\", \"tinyurl.com\"), 8,\n    domain IN (\"*.xyz\", \"*.top\"), 7,\n    uri IN (malicious_url_list), 9\n)\n| where risk_score >= 7\n| stats count by _time, host, user, uri, domain, risk_score</code>", "subtechniques": [], "color": 1}], "descr": "Monitor for clicking on malicious links leading to credential phishing, traffic to newly registered or suspicious domains, malicious redirect chains embedded in emails, or downloading of executables from phishing sites.\n\nAnalytic 1 - Detecting Phishing Link Clicks in Emails\n\n<code> (EventCode=3)\nOR (source=\"zeek_http_logs\" uri IN (malicious_url_list))\nOR (source=\"proxy_logs\" url IN (malicious_url_list))\n| eval risk_score=case(\n    domain IN (\"bit.ly\", \"tinyurl.com\"), 8,\n    domain IN (\"*.xyz\", \"*.top\"), 7,\n    uri IN (malicious_url_list), 9\n)\n| where risk_score >= 7\n| stats count by _time, host, user, uri, domain, risk_score</code>"}, {"technique_used": true, "domain": "mobile", "id": "T1660", "name": "Phishing", "descr": "Mobile security products may provide URL inspection services that could determine if a domain being visited is malicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1598", "name": "Phishing for Information", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Spearphishing Service", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Spearphishing Attachment", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Spearphishing Link", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).\n\nFurthermore, monitor network traffic for homographs via the use of internationalized domain names abusing different character sets (e.g. Cyrillic vs Latin versions of trusted sites). Also monitor and analyze traffic patterns and packet inspection for indicators of cloned websites. For example, if adversaries use HTTrack to clone websites,  <code> Mirrored from (victim URL)</code> may be visible in the HTML section of packets. ", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0861", "name": "Point & Tag Identification", "descr": "Monitor ICS automation protocols for anomalies related to reading point or tag data, such as new assets using these functions, changes in volume or timing, or unusual information being queried. Many protocols provide multiple ways to achieve the same result (e.g., functions with/without an acknowledgment or functions that operate on a single point vs. multiple points). Monitor for changes in the functions used.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0843", "name": "Program Download", "descr": "Monitor for protocol functions related to program download or modification. Program downloads may be observable in ICS automation protocols and remote management protocols.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0845", "name": "Program Upload", "descr": "Program uploads may be observable in ICS management protocols or file transfer protocols. Note when protocol functions related to program uploads occur. In cases where the ICS protocols is not well understood, one option is to examine network traffic for the program files themselves using signature-based tools.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1572", "name": "Protocol Tunneling", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1090", "name": "Proxy", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Internal Proxy", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "External Proxy", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Multi-hop Proxy", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Domain Fronting", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1219", "name": "Remote Access Tools", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Remote Desktop Software", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g. extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g. extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}, {"domain": "enterprise", "id": "T1563", "name": "Remote Service Session Hijacking", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "SSH Hijacking", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "RDP Hijacking", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)). Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on network protocols including RDP.", "subtechniques": [], "color": 1}], "descr": "Monitor network traffic for signs of hijacked sessions, such as unusual traffic patterns or unexpected session resumptions. Identify suspicious remote connections that align with ongoing user sessions.\n\n<code>sourcetype=flow\n| search (dest_port=22 OR dest_port=3389 OR dest_port=23) AND (connection_state=\"ESTABLISHED\")\n| eval session_hijack=if(session_duration > threshold_duration AND connection_origin=\"suspicious_ip\", \"possible_hijack\", \"normal\")\n| where session_hijack=\"possible_hijack\"\n| stats count by src_ip, dest_ip, dest_port, connection_state, _time\n| table _time, src_ip, dest_ip, dest_port, session_hijack </code>"}, {"technique_used": true, "domain": "ics", "id": "T0846", "name": "Remote System Discovery", "descr": "Monitor for anomalies related to discovery related ICS functions, including devices that have not previously used these functions or for functions being sent to many outstations. Note that some ICS protocols use broadcast or multicast functionality, which may produce false positives. Also monitor for hosts enumerating network connected resources using non-ICS enterprise protocols.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0888", "name": "Remote System Information Discovery", "descr": "Monitor for anomalies related to discovery related ICS functions, including devices that have not previously used these functions or for functions being sent to many outstations. Note that some ICS protocols use broadcast or multicast functionality, which may produce false positives. Also monitor for hosts enumerating network connected resources using non-ICS enterprise protocols.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1496", "name": "Resource Hijacking", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Compute Hijacking", "descr": "Monitor network traffic content for resources of co-opted systems to complete resource-intensive tasks, which may impact system and/or hosted service availability.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Bandwidth Hijacking", "descr": "Monitor network traffic content for strange or unusual patterns. ", "subtechniques": [], "color": 1}], "descr": "Monitor network traffic content for resources of co-opted systems to complete resource-intensive tasks, which may impact system and/or hosted service availability.\n\nNote: Destination Host Name is not a comprehensive list of potential cryptocurrency URLs. This analytic has a hardcoded domain name which may change. \n"}, {"technique_used": true, "domain": "enterprise", "id": "T1207", "name": "Rogue Domain Controller", "descr": "Monitor and analyze network traffic associated with data replication (such as calls to DrsAddEntry, DrsReplicaAdd, and especially GetNCChanges) between DCs as well as to/from non DC hosts. (Citation: GitHub DCSYNCMonitor)(Citation: DCShadow Blog)\u00a0DC replication will naturally take place every 15 minutes but can be triggered by an adversary or by legitimate urgent changes (ex: passwords).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0848", "name": "Rogue Master", "descr": "Monitor for unexpected ICS protocol functions from new and existing devices. Monitoring known devices requires ICS function level insight to determine if an unauthorized device is issuing commands (e.g., a historian).", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1505", "name": "Server Software Component", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Web Shell", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)). (Citation: US-CERT Alert TA15-314A Web Shells)"}, {"technique_used": true, "domain": "ics", "id": "T0865", "name": "Spearphishing Attachment", "descr": "Monitor network traffic for suspicious email attachments. Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g., monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)). Use web proxies to review content of emails including sender information, headers, and attachments for potentially malicious content.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0856", "name": "Spoof Reporting Message", "descr": "Spoofed reporting messages may be detected by reviewing the content of automation protocols, either through detecting based on expected values or comparing to other out of band process data sources. Spoofed messages may not precisely match legitimate messages which may lead to malformed traffic, although traffic may be malformed for many benign reasons. Monitor reporting messages for changes in how they are constructed.\n\nVarious techniques enable spoofing a reporting message. Consider monitoring for [Rogue Master](https://attack.mitre.org/techniques/T0848) and [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T0830) activity.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0869", "name": "Standard Application Layer Protocol", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g., extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns  (e.g., monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0857", "name": "System Firmware", "descr": "Monitor ICS management protocols / file transfer protocols for protocol functions related to firmware changes.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1033", "name": "System Owner/User Discovery", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).\n\nNote: Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on network protocols.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1221", "name": "Template Injection", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1205", "name": "Traffic Signaling", "descr": "Monitor and analyze network packet contents to detect application layer protocols, leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, protocol port mismatch, anomalous syntax, or structure). Consider packet inspection for Wake-on-LAN magic packet consists of 6 bytes of <code>FF</code> followed by sixteen repetitions of the target system's IEEE address. Seeing this string anywhere in a packet's payload may be indicative of a Wake-on-LAN attempt.(Citation: GitLab WakeOnLAN)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1537", "name": "Transfer Data to Cloud Account", "descr": "Monitor network traffic content for evidence of data exfiltration, such as gratuitous or anomalous internal traffic containing collected data. Consider correlation with process monitoring and command lines associated with collection and exfiltration.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1199", "name": "Trusted Relationship", "descr": "Monitor network traffic associated with third-party provider access, focusing on unusual data transfers, remote session activity, and access to sensitive resources. Identify unexpected communication patterns, data exfiltration attempts, or traffic to/from suspicious IP addresses.\n\nAnalytic 1 - Detecting unusual network activity from trusted 3rd parties \n\n<code>(EventCode=3)\nOR (source=\"/var/log/zeek/conn.log\" \"SSH\")\nOR (source=\"aws_vpc_logs\" dest_port IN (3389, 22, 443))\n| eval risk_score=case(\n    like(src_ip, \"%thirdparty%\"), 8,\n    lateral_movement_detected=true, 7,\n    new_connection_from_cloud=true, 9\n)\n| where risk_score >= 7\n| stats count by _time, host, src_ip, dest_ip, protocol, risk_score </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0855", "name": "Unauthorized Command Message", "descr": "Monitor for unexpected ICS protocol command functions to controllers from existing master devices (including from new processes) or from new devices. The latter is like detection for [Rogue Master](https://attack.mitre.org/techniques/T0848) but requires ICS function level insight to determine if an unauthorized device is issuing commands (e.g., a historian).\n\nMonitoring for unexpected or problematic values below the function level will provide better insights into potentially malicious activity but at the cost of additional false positives depending on the underlying operational process.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1204", "name": "User Execution", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Malicious Link", "descr": "Inspect the content of the network traffic to look for signs of suspicious web traffic, such as phishing links or abnormal HTTP GET/POST requests.\n\nAnalytic 1 - Suspicious network traffic content\n\n<code> sourcetype=network_traffic_content\n| search http_method=\"GET\" OR http_method=\"POST\"\n| stats count by url domain http_method\n| where domain NOT IN (\"<known_legit_domains>\")</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Malicious Copy and Paste", "descr": "Monitor and analyze traffic patterns and packet inspection associated with web-based network connections that are sent to malicious or suspicious destinations (e.g. destinations attributed to malicious actors). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments. ", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated with web-based network connections that are sent to malicious or suspicious destinations (e.g. destinations attributed to phishing campaigns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments (e.g. monitor anomalies in use of files that do not normally initiate network connections or unusual connections initiated by regsvr32.exe, rundll.exe, .SCF, HTA, MSI, DLLs, or msiexec.exe)."}, {"technique_used": true, "domain": "ics", "id": "T0863", "name": "User Execution", "descr": "Monitor and analyze traffic patterns and packet inspection associated with web-based network connections that are sent to malicious or suspicious destinations (e.g., destinations attributed to phishing campaigns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments (e.g., monitor anomalies in use of files that do not normally initiate network connections or unusual connections initiated by regsvr32.exe, rundll.exe, SCF, HTA, MSI, DLLs, or msiexec.exe).", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1102", "name": "Web Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Dead Drop Resolver", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Bidirectional Communication", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "One-Way Communication", "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s))."}], "add_datacomponent_ref": true, "domains": ["enterprise", "mobile", "ics"]}, {"name": "Network Traffic Flow", "descr": "Summarized network packet data that captures session-level details such as source/destination IPs, ports, protocol types, timestamps, and data volume, without storing full packet payloads. This is commonly used for traffic analysis, anomaly detection, and network performance monitoring.\n\n*Data Collection Measures:*\n\n- Network Flow Logs (Metadata Collection)\n    - NetFlow \n        - Summarized metadata for network conversations (no packet payloads).\n    - sFlow (Sampled Flow Logging)\n        - Captures sampled packets from switches and routers.\n        - Used for real-time traffic monitoring and anomaly detection.\n    - Zeek (Bro) Flow Logs\n        - Zeek logs session-level details in logs like conn.log, http.log, dns.log, etc.\n- Host-Based Collection\n    - Sysmon Event ID 3 \u2013 Network Connection Initiated\n        - Logs process-level network activity, useful for detecting malicious outbound connections.\n    - AuditD (Linux) \u2013 syscall=connect\n        - Monitors system calls for network connections. `auditctl -a always,exit -F arch=b64 -S connect -k network_activity`\n- Cloud & SaaS Flow Monitoring\n    - AWS VPC Flow Logs\n        - Captures metadata for traffic between EC2 instances, security groups, and internet gateways.\n    - Azure NSG Flow Logs / Google VPC Flow Logs\n        - Logs ingress/egress traffic for cloud-based resources.", "techniques": [{"technique_used": true, "domain": "enterprise", "id": "T1595", "name": "Active Scanning", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Scanning IP Blocks", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Vulnerability Scanning", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1557", "name": "Adversary-in-the-Middle", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "LLMNR/NBT-NS Poisoning and SMB Relay", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "ARP Cache Poisoning", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "DHCP Spoofing", "descr": "Monitor network traffic for anomalies associated with known AiTM behavior. Consider monitoring for modifications to system configuration files involved in shaping network traffic flow.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Evil Twin", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing), as well as usage of network management protocols such as enabling DHCP snooping, may be helpful in identifying rogue hardware.(Citation: cisco dhcp snooping)  Additionally, wireless pentesting hardware is often limited to older <code>802.11</code> protocols such as <code>802.11g</code> or <code>802.11a</code>.(Citation: specter ops evil twin)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0830", "name": "Adversary-in-the-Middle", "descr": "Monitor for network traffic originating from unknown/unexpected hosts. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware. For added context on adversary procedures and background see [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) and applicable sub-techniques.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0878", "name": "Alarm Suppression", "descr": "Monitor for loss of network traffic which could indicate alarms are being suppressed. A loss of expected communications associated with network protocols used to communicate alarm events or process data could indicate this technique is being used. This will not directly detect the technique\u2019s execution, but instead may provide additional evidence that the technique has been used and may complement other detections.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1071", "name": "Application Layer Protocol", "descr": "Monitor and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Web Protocols", "descr": "Monitor for web traffic to/from known-bad or suspicious domains and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "File Transfer Protocols", "descr": "Monitor and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Mail Protocols", "descr": "Monitor and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "DNS", "descr": "Monitor for DNS traffic to/from known-bad or suspicious domains and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Publish/Subscribe Protocols", "descr": "Monitor for traffic leveraging common publish/subscribe protocols to/from known-bad or suspicious domains and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1020", "name": "Automated Exfiltration", "descr": "Monitor and analyze network flows associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider analyzing newly constructed network connections that are sent or received by untrusted hosts, unexpected hardware devices, or other uncommon data flows.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Traffic Duplication", "descr": "Monitor and analyze network flows associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider analyzing newly constructed network connections that are sent or received by untrusted hosts, unexpcted hardware devices, or other uncommon data flows.\n\nAnalytic 1 - Detecting Traffic Duplication and Unexpected Mirroring Behavior \n\n<code> (source=\"zeek_conn.log\" OR source=\"firewall_logs\" OR source=\"cloud_network_logs\")\n| where (flow_type=\"asymmetric\" OR flow_type=\"mirrored\")\n| where (dest_port IN (4789, 4790, 8000, 5000) OR bytes_out > 10000000)\n| eval risk_score=case(\n    flow_type=\"asymmetric\" AND dest_port IN (4789, 4790), 9,\n    flow_type=\"mirrored\" AND bytes_out > 10000000, 8\n)\n| where risk_score >= 8\n| stats count by _time, host, source_ip, dest_ip, bytes_out, risk_score</code>", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0803", "name": "Block Command Message", "descr": "Monitor for a loss of network communications, which may indicate this technique is being used.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0804", "name": "Block Reporting Message", "descr": "Monitor for a loss of network communications, which may indicate this technique is being used.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0805", "name": "Block Serial COM", "descr": "Monitor for a loss of network communications, which may indicate this technique is being used.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1612", "name": "Build Image on Host", "descr": "Monitor for established network communications with anomalous IPs that have never been seen before in the environment that may indicate the download of malicious code.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0885", "name": "Commonly Used Port", "descr": "Analyze network data for uncommon data flows (e.g., new protocols in use between hosts, unexpected ports in use). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0884", "name": "Connection Proxy", "descr": "Monitor for known proxy protocols (e.g., SOCKS, Tor, peer-to-peer protocols) and tool usage (e.g., Squid,  peer-to-peer software) on the network that are not part of normal operations. Also monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1543", "name": "Create or Modify System Process", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Windows Service", "descr": "Monitor for several ways that code can execute\u00a0on a remote host. One of the most common methods is via the Windows\u00a0Service Control Manager\u00a0(SCM), which allows authorized users to remotely create and modify services. Several tools, such as\u00a0[PsExec](https://attack.mitre.org/software/S0029), use this functionality.\n\nWhen a client remotely communicates with the Service Control Manager, there are two observable behaviors. First, the client connects to the\u00a0RPC Endpoint Mapper\u00a0over 135/tcp. This handles authentication, and tells the client what port the endpoint\u2014in this case the SCM\u2014is listening on. Then, the client connects directly to the listening port on\u00a0services.exe. If the request is to start an existing service with a known command line, the the SCM process will run the corresponding command.\n\nThis compound behavior can be detected by looking for\u00a0services.exe\u00a0receiving a network connection and immediately spawning a child process.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1039", "name": "Data from Network Shared Drive", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on network protocols such as SMB that revolve around network shares. Although there may be more native ways to detect detailed SMB events on the host, they can be extracted out of network traffic. With the right protocol decoders, port 445 traffic can be filtered and even the file path (relative to the share) can be retrieved.\n\nLooking at this activity more closely to obtain an adequate sense of situational awareness may make it possible to detect adversaries moving between hosts in a way that deviates from normal activity. Because SMB traffic is heavy in many environments, this analytic may be difficult to turn into something that can be used to quickly detect an APT. In some cases, it may make more sense to run this analytic in a forensic fashion. Looking through and filtering its output after an intrusion has been discovered may be helpful in identifying the scope of compromise.\n", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1565", "name": "Data Manipulation", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Transmitted Data Manipulation", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1030", "name": "Data Transfer Size Limits", "descr": "Monitor and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).\n\nAnalytic 1 - Detecting Timed Small-Sized Data Transfers for Exfiltration\n\n<code> (EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (bytes_out > 100 AND bytes_out < 50000)\n| bucket span=10m _time\n| stats count, sum(bytes_out) as total_bytes by _time, host, dest_ip\n| where count > 5  // Ensures repeated transfers within 10-minute intervals\n| stats count by host, dest_ip, total_bytes, earliest(_time), latest(_time)\n| where count >= 5\n| eval risk_score=case(\n    total_bytes > 500000, 9,\n    total_bytes > 100000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, earliest, latest, risk_score</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0814", "name": "Denial of Service", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0816", "name": "Device Restart/Shutdown", "descr": "Monitor for a loss of network communications, which may indicate a device has been shutdown or restarted. This will not directly detect the technique\u2019s execution, but instead may provide additional evidence that the technique has been used and may complement other detections.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1568", "name": "Dynamic Resolution", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Fast Flux DNS", "descr": "In general, detecting usage of fast flux DNS is difficult due to web traffic load balancing that services client requests quickly. In single flux cases only IP addresses change for static domain names. In double flux cases, nothing is static. Defenders such as domain registrars and service providers are likely in the best position for detection.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Domain Generation Algorithms", "descr": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more. (Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.\nMachine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain is related to a legitimate host or DGA. (Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated(Citation: Elastic Predicting DGA)]", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1667", "name": "Email Bombing", "descr": "Monitor network data for uncommon data flows. Abnormal spikes in incoming traffic volume to specific victim e-mail addresses or servers may indicate an email bombing attempt.\n\nAnalytic 1 - Suspicious network traffic \n\n<code> sourcetype=\"zeek:conn\" dest_port=25 OR dest_port=465 OR dest_port=587\n| stats count avg(bytes_in) by src_ip, dest_ip, dest_port, _time\n| eventstats avg(count) as avg_flows, stdev(count) as std_flows by dest_ip\n| eval anomaly=if(count > avg_flows + (2*std_flows), 1, 0)\n| search anomaly=1\n| table _time, src_ip, dest_ip, dest_port, count, avg_flows </code>", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1499", "name": "Endpoint Denial of Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "OS Exhaustion Flood", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Service Exhaustion Flood", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Application Exhaustion Flood", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Application or System Exploitation", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious."}, {"domain": "enterprise", "id": "T1048", "name": "Exfiltration Over Alternative Protocol", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration Over Symmetric Encrypted Non-C2 Protocol", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Exfiltration Over Asymmetric Encrypted Non-C2 Protocol", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Exfiltration Over Unencrypted Non-C2 Protocol", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious."}, {"technique_used": true, "domain": "enterprise", "id": "T1041", "name": "Exfiltration Over C2 Channel", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1011", "name": "Exfiltration Over Other Network Medium", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration Over Bluetooth", "descr": "Monitor network data for uncommon data flows., such as the usage of abnormal/unexpected protocols.", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows., such as the usage of abnormal/unexpected protocols."}, {"domain": "enterprise", "id": "T1567", "name": "Exfiltration Over Web Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration to Code Repository", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Monitor for use of code repositories for data exfiltration. \n", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Exfiltration to Cloud Storage", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Monitor for cloud storages for data exfiltration. \n", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Exfiltration to Text Storage Sites", "descr": "Monitor network data for uncommon data flows, specifically to text storage sites such as `Pastebin[.]com`, `Paste[.]ee`, and `Pastebin[.]pl`.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Exfiltration Over Webhook", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. ", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious."}, {"technique_used": true, "domain": "enterprise", "id": "T1203", "name": "Exploitation for Client Execution", "descr": "Look for unusual outbound connections following abnormal process execution, as this could indicate an adversary has established a foothold and is initiating communication with C2 infrastructure.\n\nAnalytic 1 - monitors for network traffic generated by exploited processes\n\n<code> sourcetype=network_flow OR (sourcetype=Sysmon AND EventCode=3)\n| search process_name IN (\"chrome.exe\", \"firefox.exe\", \"winword.exe\", \"excel.exe\", \"acrord32.exe\", \"flashplayer.exe\")\n| stats count by src_ip dest_ip dest_port process_name\n| where dest_ip NOT IN (\"<known_good_ips>\")</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1133", "name": "External Remote Services", "descr": "Track the flow of traffic to/from external sources to detect anomalies or unusual patterns. Unusual patterns or high-volume traffic flows between internal and external systems.\nConnections to/from known malicious IPs or geolocations.\n\nAnalytic 1 - High-Volume data transfers \n\n<code> index=network sourcetype=\"network_traffic_flow\"\n| stats count by src_ip, dest_ip, bytes_sent, bytes_received\n| where bytes_sent > 1000000 OR bytes_received > 1000000\n| table _time, src_ip, dest_ip, bytes_sent, bytes_received </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0822", "name": "External Remote Services", "descr": "Monitor for network traffic originating from unknown/unexpected systems.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1008", "name": "Fallback Channels", "descr": "Monitor network data for uncommon data flows, such as unexpected surges or other abnormal inbound/outbound patterns.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1187", "name": "Forced Authentication", "descr": "Monitor for SMB traffic on TCP ports 139, 445 and UDP port 137 and WebDAV traffic attempting to exit the network to unknown external systems.If attempts are detected, then investigate endpoint data sources to find the root cause.\n\nAnalytic 1 - Unusual network traffic patterns indicative of forced authentication attempts.\n\n<code> index=network sourcetype=\"stream:tcp\" (dest_port=445 OR dest_port=80 OR dest_port=443)\n| eval Protocol=case(dest_port==445, \"SMB\", dest_port==80, \"HTTP\", dest_port==443, \"HTTPS\", true(), \"Unknown\")\n| eval SuspiciousConn=if((Protocol=\"SMB\" AND src_ip!=dest_ip AND (src_ip!=\"known_ip1\" AND dest_ip!=\"known_ip2\")), 1, 0)\n| where SuspiciousConn=1 </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1200", "name": "Hardware Additions", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware.\n\nAnalytic 1 - Detecting Unauthorized Network Devices\n\n<code>(EventCode=10400)\nOR (source=\"/var/log/syslog\" \"new MAC address detected\")\nOR (source=\"firewall_logs\" \"DHCP Lease Granted\" mac_address NOT IN (trusted_macs))\n| eval risk_score=case(\n    like(mac_address, \"%00:0C:29%\"), 8,\n    like(mac_address, \"%Unknown%\"), 9,\n    like(mac_address, \"%RaspberryPi%\"), 7\n)\n| where risk_score >= 7\n| stats count by _time, host, mac_address, ip_address, risk_score </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1105", "name": "Ingress Tool Transfer", "descr": "Monitor network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1534", "name": "Internal Spearphishing", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0883", "name": "Internet Accessible Device", "descr": "Monitor for unexpected protocols to/from the Internet. While network traffic content and logon session metadata may directly identify a login event, new Internet-based network flows may also be a reliable indicator of this technique.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1570", "name": "Lateral Tool Transfer", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0867", "name": "Lateral Tool Transfer", "descr": "Monitor for network traffic originating from unknown/unexpected hosts. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware.", "subtechniques": [], "color": 1}, {"domain": "mobile", "id": "T1430", "name": "Location Tracking", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "mobile", "id": "002", "name": "Impersonate SS7 Nodes", "descr": "Network carriers may be able to use firewalls, Intrusion Detection Systems (IDS), or Intrusion Prevention Systems (IPS) to detect and/or block SS7 exploitation.(Citation: CSRIC5-WG10-FinalReport) The CSRIC also suggests threat information sharing between telecommunications industry members.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1112", "name": "Modify Registry", "descr": "Remote access to the registry can be achieved via\n\n- Windows API function\u00a0`RegConnectRegistry`\n- command line via\u00a0`reg.exe`\n- graphically via\u00a0`regedit.exe`\n\nAll of these behaviors call into the Windows API, which uses the NamedPipe\u00a0WINREG\u00a0over SMB to handle the protocol information. This network can be decoded with Wireshark or a similar sensor, and can also be detected by hooking the API function.\n\nAnalytic 1 - Remote Registry\n\n<code>source=\"*Zeek:*\" (dest_port=\"445\" AND proto_info.pipe=\"WINREG\") OR (proto_info.function=\"Create*\" OR proto_info.function=\"SetValue*\")</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1104", "name": "Multi-Stage Channels", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1599", "name": "Network Boundary Bridging", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Network Address Translation Traversal", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious."}, {"domain": "enterprise", "id": "T1498", "name": "Network Denial of Service", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Direct Network Flood", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Reflection Amplification", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious."}, {"technique_used": true, "domain": "enterprise", "id": "T1046", "name": "Network Service Discovery", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. It should be noted that when a host/ port/ service scan is performed from a compromised machine, a single machine makes multiple calls to other hosts in the network to identify live hosts and services.\n\nAfter compromising an initial machine, adversaries commonly attempt to laterally move across the network. The first step to attempt the [Lateral Movement](https://attack.mitre.org/tactics/TA0008) often involves conducting host identification, port and service scans on the internal network via the compromised machine using tools such as Nmap, Cobalt Strike, etc.\n\nNote: It should be noted that when a host/ port/ service scan is performed from a compromised machine, a single machine makes multiple calls to other hosts in the network to identify live hosts and services. This can be detected using the following query\n\nAnalytic 1 - Identifying Port Scanning Activity\n\n<code>sourcetype='firewall_logs' dest_ip='internal_subnet' | stats dc(dest_port) as pcount by src_ip | where pcount >5</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1095", "name": "Non-Application Layer Protocol", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.\n\nWhile VMCI traffic is invisible to most traditional network sniffing tools, there are ways to potentially monitor this traffic.(Citation: Google Cloud Threat Intelligence ESXi Hardening 2023)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1571", "name": "Non-Standard Port", "descr": "Monitor network data flows for unexpected patterns and metadata that may be indicative of a mismatch between protocol and utilized port.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "mobile", "id": "T1509", "name": "Non-Standard Port", "descr": "Many properly configured firewalls may also naturally block command and control traffic over non-standard ports.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1003", "name": "OS Credential Dumping", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.\n\nAnalytic 1 - Unusual network communication patterns.\n\n<code> index=network sourcetype=\"stream:tcp\" dest_port=389 NOT [| inputlookup known_dc_ip_addresses | fields ip] </code>", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "DCSync", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1566", "name": "Phishing", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Spearphishing Attachment", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Spearphishing Link", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Spearphishing via Service", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.\n\nAnalytic 1 - Detecting Malicious Network Traffic Post-Phishing Execution\n\n<code>(EventCode=3)\nOR (source=\"zeek_conn.log\" dest_ip IN (malicious_ip_list))\nOR (source=\"proxy_logs\" url IN (malicious_url_list))\n| eval risk_score=case(\n    dest_ip IN (malicious_ip_list), 9,\n    dest_port IN (4444, 1337, 8080), 8,\n    user_agent LIKE \"%curl%\", 7\n)\n| where risk_score >= 7\n| stats count by _time, host, user, dest_ip, dest_port, risk_score </code>"}, {"technique_used": true, "domain": "mobile", "id": "T1660", "name": "Phishing", "descr": "Enterprises may be able to detect anomalous traffic originating from mobile devices, which could indicate compromise.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1598", "name": "Phishing for Information", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Spearphishing Service", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Spearphishing Attachment", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Spearphishing Link", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious."}, {"technique_used": true, "domain": "ics", "id": "T0845", "name": "Program Upload", "descr": "Monitor device communication patterns to identify irregular bulk transfers of data between the embedded ICS asset and other nodes within the network. Note these indicators are dependent on the profile of normal operations and the capabilities of the industrial automation protocols involved (e.g., partial program uploads).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1572", "name": "Protocol Tunneling", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1090", "name": "Proxy", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Internal Proxy", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "External Proxy", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Multi-hop Proxy", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "mobile", "id": "T1604", "name": "Proxy Through Victim", "descr": "Enterprises may be able to detect anomalous traffic originating from mobile devices, which could indicate compromise.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1219", "name": "Remote Access Tools", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.\n", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1563", "name": "Remote Service Session Hijacking", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "SSH Hijacking", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "RDP Hijacking", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. RDP sessions may be split up into multiple flows and would therefore need to be aggregated.\n\nAnomaly detection using machine learning or other methods based on baselined RDP network flows may be a viable approach to alerting on potential RDP session hijacking.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1021", "name": "Remote Services", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Remote Desktop Protocol", "descr": "Monitor network traffic for uncommon data flows that may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a computer using the Remote Desktop Protocol (RDP).\n\nThe\u00a0Remote Desktop Protocol\u00a0(RDP), built in to Microsoft operating systems, allows a user to remotely log in to the desktop of another host. It allows for interactive access of the running windows, and forwards key presses, mouse clicks, etc. Network administrators, power users, and end-users may use RDP for day-to-day operations. From an adversary\u2019s perspective, RDP provides a means to\u00a0laterally move\u00a0to a new host. Determining which RDP connections correspond to adversary activity can be a difficult problem in highly dynamic environments, but will be useful in identifying the scope of a compromise.\nRemote Desktop can be detected in several ways\n\n- Network connections to port 3389/tcp (assuming use of the default port)\n- Packet capture analysis\n- Detecting network connections from\u00a0<code>mstsc.exe</code>\n- Execution of the process\u00a0<code>rdpclip.exe</code>\n- Runs as the clipboard manager on the RDP target if clipboard sharing is enabled\n\nAnalytic 1 - Suspicious RDP\n\n<code><code> sourcetype=netflow LogonType=\"10\"\n| search dest_port=3389 // Default RDP port\n| stats count by src_ip, dest_ip, dest_port\n| where src_ip!=\"trusted_ips\" AND dest_ip!=\"internal_servers\"</code>\n", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "SMB/Windows Admin Shares", "descr": "Monitor network data for uncommon SMB data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on SMB network flows.\n\nNotes:\n\n- The logic for Implementation 1 is based around detecting on SMB write requests, which are often used by adversaries to move laterally to another host. Unlike SMB Reads, SMB Write requests typically require an additional level of access, resulting in less activity. Focusing on SMB Write activity narrows the field to looking at techniques associated with actively changing remote hosts, instead of passively reading files.\n- The logic for Implementation 2 is based around detection of new processes that were created from a file written to an SMB share.  First, a file is remotely written to a host via an SMB share; then, a variety of\u00a0Execution techniques can be used to remotely establish execution of the file or script. To detect this behavior, look for files that are written to a host over SMB and then later run directly as a process or in the command line arguments. SMB File Writes and Remote Execution may happen normally in an environment, but the combination of the two behaviors is less frequent and more likely to indicate adversarial activity.\n\nAnalytic 1 - SMB Write\n\n<code>sourcetype=\"Zeek:SMB_Files\" port=\"445\" AND protocol=\"smb.write\"</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Windows Remote Management", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on RPC network flows.\n\nWhen a\u00a0Windows Remote Management\u00a0connection is opened, the client sends HTTP requests to port 5985 for HTTP or 5986 for HTTPS on the target host. Each HTTP(S) request to the URI \u201c/wsman\u201d is called, and other information is set in the headers. Depending on the operation, the HTTP method may vary (i.e., GET, POST, etc.). This analytic would detect Remote PowerShell, as well as other communications that rely on WinRM. Additionally, it outputs the executable on the client host, the connection information, and the hostname of the target host. Look for network connections to port 5985 and 5986. To really decipher what is going on, these outputs should be fed into something that can do packet analysis.\n\nNote: Traffic to the RPC Endpoint Mapper will always have the destination port of 135. Assuming success, RPC traffic will continue to the endpoint. The endpoint and the client both bind to dynamically assigned ports (on Windows, this is typically greater than 49152). The traffic between the client and endpoint can be detected by looking at traffic to 135 followed by traffic where the source and destination ports are at least 49152.\n", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows that may be related to abuse of [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a service specifically designed to accept remote connections, such as RDP, telnet, SSH, and VNC.\n\nNote: Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on network service protocols such as SSH and RDP.\n\nAnalytic 1 - Suspicious Protocols\n\n<code>sourcetype=\"netflow\" \n| search dest_port=22 OR dest_port=3389 OR dest_port=5900 OR dest_port=3283  // SSH, RDP, VNC, ARD</code>"}, {"technique_used": true, "domain": "ics", "id": "T0886", "name": "Remote Services", "descr": "Monitor network data for uncommon  data flows (e.g., time of day, unusual source/destination address) that may be related to abuse of [Valid Accounts](https://attack.mitre.org/techniques/T0859) to log into a service specifically designed to accept remote connections, such as RDP, Telnet, SSH, and VNC.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0846", "name": "Remote System Discovery", "descr": "Monitor for new ICS protocol connections to existing assets or for device scanning (i.e., a host connecting to many devices) over ICS and enterprise protocols (e.g., ICMP, DCOM, WinRM). For added context on adversary enterprise procedures and background see [Remote System Discovery Mitigation](https://attack.mitre.org/mitigations/T1018).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0888", "name": "Remote System Information Discovery", "descr": "Monitor for new ICS protocol connections to existing assets or for device scanning (i.e., a host connecting to many devices) over ICS and enterprise protocols (e.g., ICMP, DCOM, WinRM).", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1496", "name": "Resource Hijacking", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Compute Hijacking", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Bandwidth Hijacking", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. ", "subtechniques": [], "color": 1}], "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious."}, {"technique_used": true, "domain": "ics", "id": "T0848", "name": "Rogue Master", "descr": "Monitor for network traffic originating from unknown/unexpected devices or addresses.  Local network traffic metadata could be used to identify unexpected connections, including unknown/unexpected source MAC addresses connecting to ports associated with operational protocols. Also, network management protocols such as DHCP and ARP may be helpful in identifying unexpected devices. ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1053", "name": "Scheduled Task/Job", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "At", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. When AT.exe is used to remotely\u00a0schedule tasks, Windows uses named pipes over\u00a0SMB\u00a0to communicate with the API on the remote machine. After authentication over SMB, the Named Pipe <code>ATSVC</code> is opened, over which the JobAdd function is called. On the remote host, the job files are created by the Task Scheduler and follow the convention\u00a0<code>C:\\Windows\\System32\\AT<job\\_id></code>.\n\nThis pipe activity could be discovered with a network decoder, such as that in wireshark, that can inspect SMB traffic to identify the use of pipes. It could also be detected by looking for raw packet capture streams or from a custom sensor on the host that hooks the appropriate API functions. If no network or API level of visibility is possible, this traffic may inferred by looking at SMB connections over 445/tcp followed by the creation of files matching the pattern\u00a0<code>C:\\Windows\\System32\\AT\\<job_id\\></code>.\n\nTo detect AT via network traffic, a sensor is needed that has the ability to extract and decode PCAP information. Specifically, it needs to properly decode SMB and the functions that are implemented over it via NamedPipes. If a sensor meets these criteria, then the PCAP data needs to search for instances of the command\u00a0<code>JobAdd</code>\u00a0over the pipe\u00a0<code>ATSVC</code>, which is all implemented over Windows SMB 445/tcp.\n\nAnalytic 1 - Remotely Scheduled Tasks via AT\n\n<code>index=network dest_port=445 protocol=\"smb\" pipe=\"ATSVC\" command=\"JobAdd\"</code>\n", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Scheduled Task", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Look for RPC traffic after being mapped, which implies a destination port of at least 49152. If network inspection is available via packet captures or a NIDS, then traffic through the\u00a0<code>ITaskSchedulerService</code>\u00a0interface can be detected. Microsoft has a list of the possible methods that are implemented for the\u00a0<code>ITaskSchedulerService</code>\u00a0interface, which may be useful in differentiating read and query operations from creations and modifications.\n\nWhen scheduled tasks are created remotely, Windows uses RPC (135/tcp) to communicate with the Task Scheduler on the remote machine. Once an RPC connection is established, the client communicates with the Scheduled Tasks endpoint, which runs within the service group netsvcs. With packet capture and the right packet decoders or byte-stream based signatures, remote invocations of these functions can be identified.\nCertain strings can be identifiers of the schtasks, by looking up the interface UUID of ITaskSchedulerService in different formats\n\n- UUID\u00a0<code>86d35949-83c9-4044-b424-db363231fd0c</code>\u00a0(decoded)\n- Hex\u00a0<code>49 59 d3 86 c9 83 44 40 b4 24 db 36 32 31 fd 0c</code>\u00a0(raw)\n- ASCII\u00a0<code>IYD@$621</code>\u00a0(printable bytes only)\n\nThis identifier is present three times during the RPC request phase. Any sensor that has access to the byte code as raw, decoded, or ASCII could implement an analytic.\n\nAnalytic 1 - Look for RPC traffic with ITaskSchedulerService\u00a0interface usage.\n\n<code>sourcetype=Netflow OR sourcetype=PacketCapture OR sourcetype=WinEventLog:Security EventCode=5156 \n| search (dest_port=135 OR dest_port=5985 OR dest_port=5986) AND (protocol=\"tcp\" OR protocol=\"udp\")  AND (Image=\"taskeng.exe\" OR Image=\"schtasks.exe\")\n| stats count by src_ip dest_ip dest_port\n| where count > threshold </code>", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1029", "name": "Scheduled Transfer", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware.\n\nAnalytic 1 - Detecting High Volume Exfiltration at Specific Intervals \n\n<code>(EventCode=3 OR source=\"zeek_conn.log\" OR source=\"firewall_logs\")\n| where (bytes_out > 10000000)\n| bucket span=1h _time\n| stats sum(bytes_out) as total_bytes by _time, host, dest_ip\n| where total_bytes > 100000000\n| stats count by host, dest_ip, total_bytes, earliest(_time), latest(_time)\n| where count >= 3\n| eval risk_score=case(\n    total_bytes > 500000000, 9,\n    total_bytes > 100000000, 8\n)\n| where risk_score >= 8\n| table host, dest_ip, total_bytes, earliest, latest, risk_score </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1505", "name": "Server Software Component", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Web Shell", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1176", "name": "Software Extensions", "descr": "Monitor for network traffic directed towards software services from servers or network zones that should not be communicating with this service. ", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "IDE Extensions", "descr": "Monitor for network traffic directed towards IDE services, such as <code>global.rel.tunnels.api.visualstudio.com</code>, from servers or network zones that should not be communicating with this service.(Citation: Mnemonic misuse visual studio) \n\nAnalytic 1 - suspicious network connections \n\n<code> sourcetype=zeek:conn_log OR sourcetype=zeek:http_log OR sourcetype=suricata_flow\n(host=\"*.tunnels.api.visualstudio.com\" OR host=\"*.jetbrains.com\")\n| lookup endpoint_asset_zones ip AS src_ip OUTPUT zone\n| where zone=\"prod\" OR zone=\"non-dev\"\n| stats count by src_ip, dest_ip, host, uri_path, http_method, zone, _time\n| sort -_time\n</code>", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0856", "name": "Spoof Reporting Message", "descr": "Various techniques enable spoofing a reporting message. Consider monitoring for [Rogue Master](https://attack.mitre.org/techniques/T0848) and [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T0830) activity which may precede this technique.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0869", "name": "Standard Application Layer Protocol", "descr": "Monitor and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g., extraneous packets that do not belong to established flows    , or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g., monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1033", "name": "System Owner/User Discovery", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1569", "name": "System Services", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Service Execution", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1205", "name": "Traffic Signaling", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Port Knocking", "descr": "Monitor and analyze network flows associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider analyzing newly constructed network connections that are sent or received by untrusted hosts, unexpcted hardware devices, or other uncommon data flows.", "subtechniques": [], "color": 1}], "descr": "Monitor and analyze network flows associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider analyzing newly constructed network connections that are sent or received by untrusted hosts, unexpcted hardware devices, or other uncommon data flows."}, {"technique_used": true, "domain": "ics", "id": "T0864", "name": "Transient Cyber Asset", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) may be helpful in identifying transient assets.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0855", "name": "Unauthorized Command Message", "descr": "Monitor for new or unexpected connections to controllers, which could indicate an Unauthorized Command Message being sent via [Rogue Master](https://attack.mitre.org/techniques/T0848).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1102", "name": "Web Service", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Dead Drop Resolver", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Bidirectional Communication", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "One-Way Communication", "descr": "Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1669", "name": "Wi-Fi Networks", "descr": "Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0860", "name": "Wireless Compromise", "descr": "New or irregular network traffic flows may indicate potentially unwanted devices or sessions on wireless networks. In Wi-Fi networks monitor for changes such as rogue access points or low signal strength, indicating a device is further away from the access point then expected and changes in the physical layer signal.(Citation: Nzyme Alerts Intro) (Citation: Wireless Intrusion Detection) Network traffic content will provide important context, such as hardware (e.g., MAC) addresses, user accounts, and types of messages sent.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0887", "name": "Wireless Sniffing", "descr": "Purely passive network sniffing cannot be detected effectively. In cases where the adversary interacts with the wireless network (e.g., joining a Wi-Fi network) detection may be possible. Monitor for new or irregular network traffic flows which may indicate potentially unwanted devices or sessions on wireless networks.  In Wi-Fi networks monitor for changes such as rogue access points or low signal strength, indicating a device is further away from the access point then expected and changes in the physical layer signal.(Citation: Nzyme Alerts Intro) (Citation: Wireless Intrusion Detection)  Network traffic content will provide important context, such as hardware (e.g., MAC) addresses, user accounts, and types of messages sent.", "subtechniques": [], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise", "mobile", "ics"]}], "citations": {"current_number": 0, "Mnemonic misuse visual studio": {"description": "Mnemonic. (n.d.). Advisory: Misuse of Visual Studio Code for traffic tunnelling. Retrieved March 30, 2025.", "url": "https://www.mnemonic.io/resources/blog/misuse-of-visual-studio-code-for-traffic-tunnelling/", "number": null}, "Data Driven Security DGA": {"description": "Jacobs, J. (2014, October 2). Building a DGA Classifier: Part 2, Feature Engineering. Retrieved February 18, 2019.", "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/", "number": null}, "Pace University Detecting DGA May 2017": {"description": "Chen, L., Wang, T.. (2017, May 5). Detecting Algorithmically Generated Domains Using Data Visualization and N-Grams Methods . Retrieved April 26, 2019.", "url": "http://csis.pace.edu/~ctappert/srd2017/2017PDF/d4.pdf", "number": null}, "Elastic Predicting DGA": {"description": "Ahuja, A., Anderson, H., Grant, D., Woodbridge, J.. (2016, November 2). Predicting Domain Generation Algorithms with Long Short-Term Memory Networks. Retrieved April 26, 2019.", "url": "https://arxiv.org/pdf/1611.00791.pdf", "number": null}, "cisco dhcp snooping": {"description": "Cisco. (n.d.). Configuring DHCP Snooping. Retrieved September 17, 2024.", "url": "https://www.cisco.com/en/US/docs/general/Test/dwerblo/broken_guide/snoodhcp.html#wp1120427", "number": null}, "specter ops evil twin": {"description": "Ryan, Gabriel. (2019, October 28). Modern Wireless Tradecraft Pt I \u2014 Basic Rogue AP Theory \u2014 Evil Twin and Karma Attacks. Retrieved September 17, 2024.", "url": "https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee", "number": null}, "Google Cloud Threat Intelligence ESXi Hardening 2023": {"description": "Alex Marvi, Greg Blaum, and Ron Craft. (2023, June 28). Detection, Containment, and Hardening Opportunities for Privileged Guest Operations, Anomalous Behavior, and VMCI Backdoors on Compromised VMware Hosts. Retrieved March 26, 2025.", "url": "https://cloud.google.com/blog/topics/threat-intelligence/vmware-detection-containment-hardening", "number": null}, "CSRIC5-WG10-FinalReport": {"description": "Communications Security, Reliability, Interoperability Council (CSRIC). (2017, March). Working Group 10 Legacy Systems Risk Reductions Final Report. Retrieved May 24, 2017.", "url": "https://web.archive.org/web/20200330012714/https://www.fcc.gov/files/csric5-wg10-finalreport031517pdf", "number": null}, "Nzyme Alerts Intro": {"description": "Koopmann, Lennart. (n.d.). Nzyme Alerts Introduction. Retrieved November 17, 2024.", "url": "https://docs.nzyme.org/wifi/monitoring/network-monitoring/", "number": null}, "Wireless Intrusion Detection": {"description": "Tomko, A.; Rieser, C; Buell, H.; Zeret, D.; Turner, W.. (2007, March). Wireless Intrusion Detection. Retrieved September 26, 2022.", "url": "https://apps.dtic.mil/sti/pdfs/ADA466332.pdf", "number": null}, "AWS GuardDuty EC2 finding types": {"description": "AWS. (n.d.). GuardDuty EC2 finding types. Retrieved September 25, 2024.", "url": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html", "number": null}, "Cisco IOS Software Integrity Assurance - Secure Boot": {"description": "Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Secure Boot. Retrieved October 19, 2020.", "url": "https://tools.cisco.com/security/center/resources/integrity_assurance.html#35", "number": null}, "Cisco IOS Software Integrity Assurance - Image File Verification": {"description": "Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Cisco IOS Image File Verification. Retrieved October 19, 2020.", "url": "https://tools.cisco.com/security/center/resources/integrity_assurance.html#7", "number": null}, "crowdstrike bpf socket filters": {"description": "Jamie Harries. (2022, May 25). Hunting a Global Telecommunications Threat: DecisiveArchitect and Its Custom Implant JustForFun. Retrieved October 18, 2022.", "url": "https://www.crowdstrike.com/blog/how-to-hunt-for-decisivearchitect-and-justforfun-implant/", "number": null}, "AdSecurity DCSync Sept 2015": {"description": "Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017.", "url": "https://adsecurity.org/?p=1729", "number": null}, "Microsoft DRSR Dec 2017": {"description": "Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017.", "url": "https://msdn.microsoft.com/library/cc228086.aspx", "number": null}, "Microsoft NRPC Dec 2017": {"description": "Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017.", "url": "https://msdn.microsoft.com/library/cc237008.aspx", "number": null}, "Microsoft SAMR": {"description": "Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017.", "url": "https://msdn.microsoft.com/library/cc245496.aspx", "number": null}, "GitLab WakeOnLAN": {"description": "Perry, David. (2020, August 11). WakeOnLAN (WOL). Retrieved February 17, 2021.", "url": "https://gitlab.com/wireshark/wireshark/-/wikis/WakeOnLAN", "number": null}, "GitHub DCSYNCMonitor": {"description": "Spencer S. (2018, February 22). DCSYNCMonitor. Retrieved March 30, 2018.", "url": "https://github.com/shellster/DCSYNCMonitor", "number": null}, "DCShadow Blog": {"description": "Delpy, B. & LE TOUX, V. (n.d.). DCShadow. Retrieved March 20, 2018.", "url": "https://www.dcshadow.com/", "number": null}, "Now You Serial": {"description": "Rahman, Alyssa. (2021, December 13). Now You Serial, Now You Don\u2019t \u2014 Systematically Hunting for Deserialization Exploits. Retrieved November 28, 2023.", "url": "https://www.mandiant.com/resources/blog/hunting-deserialization-exploits", "number": null}, "University of Birmingham C2": {"description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf", "number": null}, "US-CERT Alert TA15-314A Web Shells": {"description": "US-CERT. (2015, November 13). Compromised Web Servers and Web Shells - Threat Awareness and Guidance. Retrieved June 8, 2016.", "url": "https://www.us-cert.gov/ncas/alerts/TA15-314A", "number": null}}, "versioning_feature": false}