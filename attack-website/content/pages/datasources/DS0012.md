Title: Script
Template: datasources/datasource
save_as: datasources/DS0012/index.html
data: {"attack_id": "DS0012", "side_menu_data": {"name": "Data Sources", "id": "datasources", "path": null, "children": [{"name": "Active Directory", "id": "DS0026", "path": "/datasources/DS0026/", "children": [{"name": "Active Directory Credential Request", "id": "Active Directory Credential Request", "path": "/datasources/DS0026/#Active Directory Credential Request", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Access", "id": "Active Directory Object Access", "path": "/datasources/DS0026/#Active Directory Object Access", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Creation", "id": "Active Directory Object Creation", "path": "/datasources/DS0026/#Active Directory Object Creation", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Deletion", "id": "Active Directory Object Deletion", "path": "/datasources/DS0026/#Active Directory Object Deletion", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Modification", "id": "Active Directory Object Modification", "path": "/datasources/DS0026/#Active Directory Object Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Application Log", "id": "DS0015", "path": "/datasources/DS0015/", "children": [{"name": "Application Log Content", "id": "Application Log Content", "path": "/datasources/DS0015/#Application Log Content", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Application Vetting", "id": "DS0041", "path": "/datasources/DS0041/", "children": [{"name": "API Calls", "id": "API Calls", "path": "/datasources/DS0041/#API Calls", "domains": ["mobile"], "children": []}, {"name": "Application Assets", "id": "Application Assets", "path": "/datasources/DS0041/#Application Assets", "domains": ["mobile"], "children": []}, {"name": "Network Communication", "id": "Network Communication", "path": "/datasources/DS0041/#Network Communication", "domains": ["mobile"], "children": []}, {"name": "Permissions Requests", "id": "Permissions Requests", "path": "/datasources/DS0041/#Permissions Requests", "domains": ["mobile"], "children": []}, {"name": "Protected Configuration", "id": "Protected Configuration", "path": "/datasources/DS0041/#Protected Configuration", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Asset", "id": "DS0039", "path": "/datasources/DS0039/", "children": [{"name": "Asset Inventory", "id": "Asset Inventory", "path": "/datasources/DS0039/#Asset Inventory", "domains": ["ics"], "children": []}, {"name": "Software", "id": "Software", "path": "/datasources/DS0039/#Software", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Certificate", "id": "DS0037", "path": "/datasources/DS0037/", "children": [{"name": "Certificate Registration", "id": "Certificate Registration", "path": "/datasources/DS0037/#Certificate Registration", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Service", "id": "DS0025", "path": "/datasources/DS0025/", "children": [{"name": "Cloud Service Disable", "id": "Cloud Service Disable", "path": "/datasources/DS0025/#Cloud Service Disable", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Enumeration", "id": "Cloud Service Enumeration", "path": "/datasources/DS0025/#Cloud Service Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Metadata", "id": "Cloud Service Metadata", "path": "/datasources/DS0025/#Cloud Service Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Modification", "id": "Cloud Service Modification", "path": "/datasources/DS0025/#Cloud Service Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Storage", "id": "DS0010", "path": "/datasources/DS0010/", "children": [{"name": "Cloud Storage Access", "id": "Cloud Storage Access", "path": "/datasources/DS0010/#Cloud Storage Access", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Creation", "id": "Cloud Storage Creation", "path": "/datasources/DS0010/#Cloud Storage Creation", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Deletion", "id": "Cloud Storage Deletion", "path": "/datasources/DS0010/#Cloud Storage Deletion", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Enumeration", "id": "Cloud Storage Enumeration", "path": "/datasources/DS0010/#Cloud Storage Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Metadata", "id": "Cloud Storage Metadata", "path": "/datasources/DS0010/#Cloud Storage Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Modification", "id": "Cloud Storage Modification", "path": "/datasources/DS0010/#Cloud Storage Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Command", "id": "DS0017", "path": "/datasources/DS0017/", "children": [{"name": "Command Execution", "id": "Command Execution", "path": "/datasources/DS0017/#Command Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Container", "id": "DS0032", "path": "/datasources/DS0032/", "children": [{"name": "Container Creation", "id": "Container Creation", "path": "/datasources/DS0032/#Container Creation", "domains": ["enterprise"], "children": []}, {"name": "Container Enumeration", "id": "Container Enumeration", "path": "/datasources/DS0032/#Container Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Container Start", "id": "Container Start", "path": "/datasources/DS0032/#Container Start", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Domain Name", "id": "DS0038", "path": "/datasources/DS0038/", "children": [{"name": "Active DNS", "id": "Active DNS", "path": "/datasources/DS0038/#Active DNS", "domains": ["enterprise"], "children": []}, {"name": "Domain Registration", "id": "Domain Registration", "path": "/datasources/DS0038/#Domain Registration", "domains": ["enterprise"], "children": []}, {"name": "Passive DNS", "id": "Passive DNS", "path": "/datasources/DS0038/#Passive DNS", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Drive", "id": "DS0016", "path": "/datasources/DS0016/", "children": [{"name": "Drive Access", "id": "Drive Access", "path": "/datasources/DS0016/#Drive Access", "domains": ["enterprise"], "children": []}, {"name": "Drive Creation", "id": "Drive Creation", "path": "/datasources/DS0016/#Drive Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Drive Modification", "id": "Drive Modification", "path": "/datasources/DS0016/#Drive Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Driver", "id": "DS0027", "path": "/datasources/DS0027/", "children": [{"name": "Driver Load", "id": "Driver Load", "path": "/datasources/DS0027/#Driver Load", "domains": ["enterprise"], "children": []}, {"name": "Driver Metadata", "id": "Driver Metadata", "path": "/datasources/DS0027/#Driver Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "File", "id": "DS0022", "path": "/datasources/DS0022/", "children": [{"name": "File Access", "id": "File Access", "path": "/datasources/DS0022/#File Access", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Creation", "id": "File Creation", "path": "/datasources/DS0022/#File Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Deletion", "id": "File Deletion", "path": "/datasources/DS0022/#File Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Metadata", "id": "File Metadata", "path": "/datasources/DS0022/#File Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Modification", "id": "File Modification", "path": "/datasources/DS0022/#File Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Firewall", "id": "DS0018", "path": "/datasources/DS0018/", "children": [{"name": "Firewall Disable", "id": "Firewall Disable", "path": "/datasources/DS0018/#Firewall Disable", "domains": ["enterprise"], "children": []}, {"name": "Firewall Enumeration", "id": "Firewall Enumeration", "path": "/datasources/DS0018/#Firewall Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Firewall Metadata", "id": "Firewall Metadata", "path": "/datasources/DS0018/#Firewall Metadata", "domains": ["enterprise"], "children": []}, {"name": "Firewall Rule Modification", "id": "Firewall Rule Modification", "path": "/datasources/DS0018/#Firewall Rule Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Firmware", "id": "DS0001", "path": "/datasources/DS0001/", "children": [{"name": "Firmware Modification", "id": "Firmware Modification", "path": "/datasources/DS0001/#Firmware Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Group", "id": "DS0036", "path": "/datasources/DS0036/", "children": [{"name": "Group Enumeration", "id": "Group Enumeration", "path": "/datasources/DS0036/#Group Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Group Metadata", "id": "Group Metadata", "path": "/datasources/DS0036/#Group Metadata", "domains": ["enterprise"], "children": []}, {"name": "Group Modification", "id": "Group Modification", "path": "/datasources/DS0036/#Group Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Image", "id": "DS0007", "path": "/datasources/DS0007/", "children": [{"name": "Image Creation", "id": "Image Creation", "path": "/datasources/DS0007/#Image Creation", "domains": ["enterprise"], "children": []}, {"name": "Image Deletion", "id": "Image Deletion", "path": "/datasources/DS0007/#Image Deletion", "domains": ["enterprise"], "children": []}, {"name": "Image Metadata", "id": "Image Metadata", "path": "/datasources/DS0007/#Image Metadata", "domains": ["enterprise"], "children": []}, {"name": "Image Modification", "id": "Image Modification", "path": "/datasources/DS0007/#Image Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Instance", "id": "DS0030", "path": "/datasources/DS0030/", "children": [{"name": "Instance Creation", "id": "Instance Creation", "path": "/datasources/DS0030/#Instance Creation", "domains": ["enterprise"], "children": []}, {"name": "Instance Deletion", "id": "Instance Deletion", "path": "/datasources/DS0030/#Instance Deletion", "domains": ["enterprise"], "children": []}, {"name": "Instance Enumeration", "id": "Instance Enumeration", "path": "/datasources/DS0030/#Instance Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Instance Metadata", "id": "Instance Metadata", "path": "/datasources/DS0030/#Instance Metadata", "domains": ["enterprise"], "children": []}, {"name": "Instance Modification", "id": "Instance Modification", "path": "/datasources/DS0030/#Instance Modification", "domains": ["enterprise"], "children": []}, {"name": "Instance Start", "id": "Instance Start", "path": "/datasources/DS0030/#Instance Start", "domains": ["enterprise"], "children": []}, {"name": "Instance Stop", "id": "Instance Stop", "path": "/datasources/DS0030/#Instance Stop", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Internet Scan", "id": "DS0035", "path": "/datasources/DS0035/", "children": [{"name": "Response Content", "id": "Response Content", "path": "/datasources/DS0035/#Response Content", "domains": ["enterprise"], "children": []}, {"name": "Response Metadata", "id": "Response Metadata", "path": "/datasources/DS0035/#Response Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Kernel", "id": "DS0008", "path": "/datasources/DS0008/", "children": [{"name": "Kernel Module Load", "id": "Kernel Module Load", "path": "/datasources/DS0008/#Kernel Module Load", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Logon Session", "id": "DS0028", "path": "/datasources/DS0028/", "children": [{"name": "Logon Session Creation", "id": "Logon Session Creation", "path": "/datasources/DS0028/#Logon Session Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Logon Session Metadata", "id": "Logon Session Metadata", "path": "/datasources/DS0028/#Logon Session Metadata", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Malware Repository", "id": "DS0004", "path": "/datasources/DS0004/", "children": [{"name": "Malware Content", "id": "Malware Content", "path": "/datasources/DS0004/#Malware Content", "domains": ["enterprise"], "children": []}, {"name": "Malware Metadata", "id": "Malware Metadata", "path": "/datasources/DS0004/#Malware Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Module", "id": "DS0011", "path": "/datasources/DS0011/", "children": [{"name": "Module Load", "id": "Module Load", "path": "/datasources/DS0011/#Module Load", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Named Pipe", "id": "DS0023", "path": "/datasources/DS0023/", "children": [{"name": "Named Pipe Metadata", "id": "Named Pipe Metadata", "path": "/datasources/DS0023/#Named Pipe Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Network Share", "id": "DS0033", "path": "/datasources/DS0033/", "children": [{"name": "Network Share Access", "id": "Network Share Access", "path": "/datasources/DS0033/#Network Share Access", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Network Traffic", "id": "DS0029", "path": "/datasources/DS0029/", "children": [{"name": "Network Connection Creation", "id": "Network Connection Creation", "path": "/datasources/DS0029/#Network Connection Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Content", "id": "Network Traffic Content", "path": "/datasources/DS0029/#Network Traffic Content", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Flow", "id": "Network Traffic Flow", "path": "/datasources/DS0029/#Network Traffic Flow", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Operational Databases", "id": "DS0040", "path": "/datasources/DS0040/", "children": [{"name": "Device Alarm", "id": "Device Alarm", "path": "/datasources/DS0040/#Device Alarm", "domains": ["ics"], "children": []}, {"name": "Process History/Live Data", "id": "Process History/Live Data", "path": "/datasources/DS0040/#Process History/Live Data", "domains": ["ics"], "children": []}, {"name": "Process/Event Alarm", "id": "Process/Event Alarm", "path": "/datasources/DS0040/#Process/Event Alarm", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Persona", "id": "DS0021", "path": "/datasources/DS0021/", "children": [{"name": "Social Media", "id": "Social Media", "path": "/datasources/DS0021/#Social Media", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Pod", "id": "DS0014", "path": "/datasources/DS0014/", "children": [{"name": "Pod Creation", "id": "Pod Creation", "path": "/datasources/DS0014/#Pod Creation", "domains": ["enterprise"], "children": []}, {"name": "Pod Enumeration", "id": "Pod Enumeration", "path": "/datasources/DS0014/#Pod Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Pod Modification", "id": "Pod Modification", "path": "/datasources/DS0014/#Pod Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Process", "id": "DS0009", "path": "/datasources/DS0009/", "children": [{"name": "OS API Execution", "id": "OS API Execution", "path": "/datasources/DS0009/#OS API Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Access", "id": "Process Access", "path": "/datasources/DS0009/#Process Access", "domains": ["enterprise"], "children": []}, {"name": "Process Creation", "id": "Process Creation", "path": "/datasources/DS0009/#Process Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Metadata", "id": "Process Metadata", "path": "/datasources/DS0009/#Process Metadata", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Modification", "id": "Process Modification", "path": "/datasources/DS0009/#Process Modification", "domains": ["enterprise"], "children": []}, {"name": "Process Termination", "id": "Process Termination", "path": "/datasources/DS0009/#Process Termination", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Scheduled Job", "id": "DS0003", "path": "/datasources/DS0003/", "children": [{"name": "Scheduled Job Creation", "id": "Scheduled Job Creation", "path": "/datasources/DS0003/#Scheduled Job Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Scheduled Job Metadata", "id": "Scheduled Job Metadata", "path": "/datasources/DS0003/#Scheduled Job Metadata", "domains": ["enterprise"], "children": []}, {"name": "Scheduled Job Modification", "id": "Scheduled Job Modification", "path": "/datasources/DS0003/#Scheduled Job Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Script", "id": "DS0012", "path": "/datasources/DS0012/", "children": [{"name": "Script Execution", "id": "Script Execution", "path": "/datasources/DS0012/#Script Execution", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Sensor Health", "id": "DS0013", "path": "/datasources/DS0013/", "children": [{"name": "Host Status", "id": "Host Status", "path": "/datasources/DS0013/#Host Status", "domains": ["enterprise", "mobile"], "children": []}], "domains": ["enterprise", "mobile"]}, {"name": "Service", "id": "DS0019", "path": "/datasources/DS0019/", "children": [{"name": "Service Creation", "id": "Service Creation", "path": "/datasources/DS0019/#Service Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Metadata", "id": "Service Metadata", "path": "/datasources/DS0019/#Service Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Modification", "id": "Service Modification", "path": "/datasources/DS0019/#Service Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Snapshot", "id": "DS0020", "path": "/datasources/DS0020/", "children": [{"name": "Snapshot Creation", "id": "Snapshot Creation", "path": "/datasources/DS0020/#Snapshot Creation", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Deletion", "id": "Snapshot Deletion", "path": "/datasources/DS0020/#Snapshot Deletion", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Enumeration", "id": "Snapshot Enumeration", "path": "/datasources/DS0020/#Snapshot Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Metadata", "id": "Snapshot Metadata", "path": "/datasources/DS0020/#Snapshot Metadata", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Modification", "id": "Snapshot Modification", "path": "/datasources/DS0020/#Snapshot Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "User Account", "id": "DS0002", "path": "/datasources/DS0002/", "children": [{"name": "User Account Authentication", "id": "User Account Authentication", "path": "/datasources/DS0002/#User Account Authentication", "domains": ["enterprise", "ics"], "children": []}, {"name": "User Account Creation", "id": "User Account Creation", "path": "/datasources/DS0002/#User Account Creation", "domains": ["enterprise"], "children": []}, {"name": "User Account Deletion", "id": "User Account Deletion", "path": "/datasources/DS0002/#User Account Deletion", "domains": ["enterprise"], "children": []}, {"name": "User Account Metadata", "id": "User Account Metadata", "path": "/datasources/DS0002/#User Account Metadata", "domains": ["enterprise"], "children": []}, {"name": "User Account Modification", "id": "User Account Modification", "path": "/datasources/DS0002/#User Account Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "User Interface", "id": "DS0042", "path": "/datasources/DS0042/", "children": [{"name": "Permissions Request", "id": "Permissions Request", "path": "/datasources/DS0042/#Permissions Request", "domains": ["mobile"], "children": []}, {"name": "System Notifications", "id": "System Notifications", "path": "/datasources/DS0042/#System Notifications", "domains": ["mobile"], "children": []}, {"name": "System Settings", "id": "System Settings", "path": "/datasources/DS0042/#System Settings", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Volume", "id": "DS0034", "path": "/datasources/DS0034/", "children": [{"name": "Volume Creation", "id": "Volume Creation", "path": "/datasources/DS0034/#Volume Creation", "domains": ["enterprise"], "children": []}, {"name": "Volume Deletion", "id": "Volume Deletion", "path": "/datasources/DS0034/#Volume Deletion", "domains": ["enterprise"], "children": []}, {"name": "Volume Enumeration", "id": "Volume Enumeration", "path": "/datasources/DS0034/#Volume Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Volume Metadata", "id": "Volume Metadata", "path": "/datasources/DS0034/#Volume Metadata", "domains": ["enterprise"], "children": []}, {"name": "Volume Modification", "id": "Volume Modification", "path": "/datasources/DS0034/#Volume Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Web Credential", "id": "DS0006", "path": "/datasources/DS0006/", "children": [{"name": "Web Credential Creation", "id": "Web Credential Creation", "path": "/datasources/DS0006/#Web Credential Creation", "domains": ["enterprise"], "children": []}, {"name": "Web Credential Usage", "id": "Web Credential Usage", "path": "/datasources/DS0006/#Web Credential Usage", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Windows Registry", "id": "DS0024", "path": "/datasources/DS0024/", "children": [{"name": "Windows Registry Key Access", "id": "Windows Registry Key Access", "path": "/datasources/DS0024/#Windows Registry Key Access", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Creation", "id": "Windows Registry Key Creation", "path": "/datasources/DS0024/#Windows Registry Key Creation", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Deletion", "id": "Windows Registry Key Deletion", "path": "/datasources/DS0024/#Windows Registry Key Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "Windows Registry Key Modification", "id": "Windows Registry Key Modification", "path": "/datasources/DS0024/#Windows Registry Key Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "WMI", "id": "DS0005", "path": "/datasources/DS0005/", "children": [{"name": "WMI Creation", "id": "WMI Creation", "path": "/datasources/DS0005/#WMI Creation", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}]}, "notes": null, "created": "20 October 2021", "modified": "18 April 2025", "name": "Script", "version": "1.2", "contributors_list": ["Center for Threat-Informed Defense (CTID)"], "descr": "A file or stream containing a list of commands, allowing them to be launched in sequence(Citation: Microsoft PowerShell Logging)(Citation: FireEye PowerShell Logging)(Citation: Microsoft AMSI)", "platforms": "ESXi, Windows", "collection_layers": "Host", "datacomponents_list": [{"name": "Script Execution", "descr": "The execution of a text file that contains code via the interpreter.\n\n*Data Collection Measures:*\n\n- Windows Event Logs:\n    - Event ID 4104 (PowerShell Script Block Logging) \u2013 Captures full command-line execution of PowerShell scripts.\n    - Event ID 4688 (Process Creation) \u2013 Detects script execution by tracking process launches (`powershell.exe`, `wscript.exe`, `cscript.exe`).\n    - Event ID 5861 (Script Execution) \u2013 Captures script execution via Windows Defender AMSI logging.\n- Sysmon (Windows):\n    - Event ID 1 (Process Creation) \u2013 Monitors script execution initiated by scripting engines.\n    - Event ID 11 (File Creation) \u2013 Detects new script files written to disk before execution.\n- Endpoint Detection and Response (EDR) Tools:\n    - Track script execution behavior, detect obfuscated commands, and prevent malicious scripts.\n- PowerShell Logging:\n    - Enable Module Logging: Logs all loaded modules and cmdlets.\n    - Enable Script Block Logging: Captures complete PowerShell script execution history.\n- SIEM Detection Rules:\n    - Detect script execution with obfuscated, encoded, or remote URLs.\n    - Alert on script executions using `-EncodedCommand` or `iex(iwr)`.", "techniques": [{"domain": "enterprise", "id": "T1560", "name": "Archive Collected Data", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Archive via Library", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Archive via Custom Method", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}], "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. "}, {"technique_used": true, "domain": "enterprise", "id": "T1119", "name": "Automated Collection", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0802", "name": "Automated Collection", "descr": "Monitor for any suspicious attempts to enable script execution on a system. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible, to determine their actions and intent.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1020", "name": "Automated Exfiltration", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. \n\nAnalytic 1 - Detecting Automated Script Execution for Exfiltration\n\n<code>(EventCode=1 OR source=\"/var/log/audit/audit.log\" type=\"execve\")\n| where (script_path IN (\"*.ps1\", \"*.sh\", \"*.py\", \"*.bat\"))\n| where (command IN (\"scp\", \"rsync\", \"ftp\", \"curl\", \"wget\"))\n| eval risk_score=case(\n    script_path LIKE \"%.ps1\", 9,\n    script_path LIKE \"%.sh\", 8,\n    script_path LIKE \"%.bat\", 7\n)\n| where risk_score >= 8\n| stats count by _time, host, user, script_path, command, risk_score </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1651", "name": "Cloud Administration Command", "descr": "Monitor the execution of scripts within virtual machines, especially those initiated via cloud management services like Azure RunCommand. In Azure, usage of Azure RunCommand can be identified via the Azure Activity Logs, and additional details on the result of  executed jobs are available in the `C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows` directory on Windows virtual machines.(Citation: Mandiant Azure Run Command 2021)\n\nAnalytic 1 - Unauthorized script execution\n\n<code> sourcetype=azure:activity\n| search script_name IN (\"script.sh\", \"run.ps1\", \"start.cmd\")\n| where script_name IN (\"script.sh\", \"run.ps1\", \"start.cmd\") AND user NOT IN (\"known_admins\")\n</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1059", "name": "Command and Scripting Interpreter", "descr": "Monitor for any attempts to enable scripts running on a system that would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. \n\nAnalytic 1 - Look for attempts to enable scripts on the system.\n\n<code> index=windows (EventCode=1 OR EventCode=4688 OR EventCode=4103 OR EventCode=4104) (CommandLine=\"*script*\")\n| search script_name IN (\"*.ps1\", \"*.sh\", \"*.py\", \"*.rb\", \"*.js\", \"*.vbs\")\n| eval suspicious_script=if(like(script_name, \"%.sh\") AND hour(_time) NOT BETWEEN 8 AND 18, \"Yes\", \"No\")\n| where suspicious_script=\"Yes\"</code>", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "PowerShell", "descr": "Monitor for any attempts to enable scripts running on a system that would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. \n\nAnalytic 1 - Script Block Logging Events\n\n<code> (source=WinEventLog:\"Microsoft-Windows-PowerShell/Operational\" EventID=\"4104\u201d AND Image=\"powershell.exe\" AND (CommandLine=\"\\-enc*\" OR CommandLine=\"*-ep bypass*\" OR CommandLine=\"*-noni*\")<code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Visual Basic", "descr": "Monitor for any attempts to enable scripts running on a system that would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. \n\nNote: Be aware of VBScript execution from temporary or unusual file locations, which may indicate malicious activity.\n\nAnalytic 1 - Script Execution from Temporary Locations \n\n<code> (source=WinEventLog:\"*Microsoft-Windows-PowerShell/Operational\" EventID=\"4103\") | WHERE CommandLine LIKE \"*AppData*.vbs*\" OR CommandLine LIKE \"*AppData*.vbe*\" OR CommandLine LIKE \"*AppData*.vba*\" </code>\n", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "JavaScript", "descr": "Monitor for any attempts to enable scripts running on a system that would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "011", "name": "Lua", "descr": "Monitor for any attempts to enable scripts running on a system that would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1005", "name": "Data from Local System", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.  Data may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0893", "name": "Data from Local System", "descr": "Monitor for any suspicious attempts to enable scripts running on a system. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Data may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1140", "name": "Deobfuscate/Decode Files or Information", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1482", "name": "Domain Trust Discovery", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1615", "name": "Group Policy Discovery", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1564", "name": "Hide Artifacts", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Hidden Window", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "VBA Stomping", "descr": "Detection efforts should be placed finding differences between VBA source code and p-code.(Citation: Walmart Roberts Oct 2018) VBA code can be extracted from p-code before execution with tools such as the pcodedmp disassembler. The oletools toolkit leverages the pcodedmp disassembler to detect VBA stomping by comparing keywords present in the VBA source code and p-code.(Citation: pcodedmp Bontchev)(Citation: oletools toolkit)", "subtechniques": [], "color": 1}], "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent."}, {"technique_used": true, "domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Disable Windows Event Logging", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1056", "name": "Input Capture", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "GUI Input Capture", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1674", "name": "Input Injection", "descr": "Monitor for any attempts to enable scripts running on a system that would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. \n\nAnalytic 1 - Scripts injected via clipboard or keystroke simulation \n\n<code> (index=main sourcetype=\"WinEventLog:Microsoft-Windows-PowerShell/Operational\" EventCode=4104)\nOR (index=main sourcetype=sysmon EventCode=1 CommandLine=\"*osascript*\" OR CommandLine=\"*python*\" OR CommandLine=\"*bash*\")\n| transaction user maxspan=15s\n| join user\n    [\n        search index=wineventlog sourcetype=\"WinEventLog:System\" (EventCode=400 OR EventCode=20001)\n        | search DeviceName=\"*HID*\" OR DeviceName=\"*Keyboard*\"\n        | stats count by user, _time, DeviceName\n    ]\n| table _time, user, CommandLine, DeviceName </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1559", "name": "Inter-Process Communication", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Component Object Model", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. Enumeration of COM objects, via\u00a0[Query Registry](https://attack.mitre.org/techniques/T1012)\u00a0or\u00a0[PowerShell](https://attack.mitre.org/techniques/T1059/001), may also proceed malicious use.(Citation: Fireeye Hunting COM June 2019)(Citation: Enigma MMC20 COM Jan 2017)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Dynamic Data Exchange", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. OLE and Office Open XML files can be scanned for \u2018DDEAUTO', \u2018DDE\u2019, and other strings indicative of DDE execution.https://blog.nviso.be/2017/10/11/detecting-dde-in-ms-office-documents/", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1556", "name": "Modify Authentication Process", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Reversible Encryption", "descr": "Consider monitoring and/or blocking suspicious execution of Active Directory PowerShell modules, such as <code>Set-ADUser</code> and <code>Set-ADAccountControl</code>, that change account configurations.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "ics", "id": "T0840", "name": "Network Connection Enumeration", "descr": "Monitor for any suspicious attempts to enable script execution on a system. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1027", "name": "Obfuscated Files or Information", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "010", "name": "Command Obfuscation", "descr": "Monitor executed scripts for indicators of obfuscation and potentially suspicious command syntax, such as uninterpreted escape characters (e.g., `^`).\n\nAlso monitor commands within scripts for syntax-specific signs of obfuscation, such as encoded or otherwise unreadable blobs of characters.", "subtechniques": [], "color": 1}], "descr": "Monitor executed scripts for indicators of obfuscation and potentially suspicious command syntax, such as uninterpreted escape characters (e.g., `^`).\n\nAlso monitor commands within scripts for syntax-specific signs of obfuscation, such as encoded or otherwise unreadable blobs of characters."}, {"technique_used": true, "domain": "enterprise", "id": "T1620", "name": "Reflective Code Loading", "descr": "Similarly, AMSI / ETW traces can be used to identify signs of arbitrary code execution from within the memory of potentially compromised processes.(Citation: MDSec Detecting DOTNET)(Citation: Introducing Donut)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0853", "name": "Scripting", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "ics", "id": "T0894", "name": "System Binary Proxy Execution", "descr": "Monitor for any suspicious attempts to enable script execution on a system. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1016", "name": "System Network Configuration Discovery", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1216", "name": "System Script Proxy Execution", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "PubPrn", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "SyncAppvPublishingServer", "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "subtechniques": [], "color": 1}], "descr": "Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. "}], "add_datacomponent_ref": true, "domains": ["enterprise", "ics"]}], "citations": {"current_number": 0, "FireEye PowerShell Logging": {"description": "Dunwoody, M. (2016, February 11). Greater Visibility Through PowerShell Logging. Retrieved September 28, 2021.", "url": "https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html", "number": null}, "Microsoft AMSI": {"description": "Microsoft. (2019, April 19). Antimalware Scan Interface (AMSI). Retrieved September 28, 2021.", "url": "https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal", "number": null}, "Microsoft PowerShell Logging": {"description": "Microsoft. (2020, March 30). about_Logging_Windows. Retrieved September 28, 2021.", "url": "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7", "number": null}, "MDSec Detecting DOTNET": {"description": "MDSec Research. (n.d.). Detecting and Advancing In-Memory .NET Tradecraft. Retrieved October 4, 2021.", "url": "https://www.mdsec.co.uk/2020/06/detecting-and-advancing-in-memory-net-tradecraft/", "number": null}, "Introducing Donut": {"description": "The Wover. (2019, May 9). Donut - Injecting .NET Assemblies as Shellcode. Retrieved October 4, 2021.", "url": "https://thewover.github.io/Introducing-Donut/", "number": null}, "Walmart Roberts Oct 2018": {"description": "Sayre, K., Ogden, H., Roberts, C. (2018, October 10). VBA Stomping \u2014 Advanced Maldoc Techniques. Retrieved September 17, 2020.", "url": "https://medium.com/walmartglobaltech/vba-stomping-advanced-maldoc-techniques-612c484ab278", "number": null}, "pcodedmp Bontchev": {"description": "Bontchev, V. (2019, July 30). pcodedmp.py - A VBA p-code disassembler. Retrieved September 17, 2020.", "url": "https://github.com/bontchev/pcodedmp", "number": null}, "oletools toolkit": {"description": "decalage2. (2019, December 3). python-oletools. Retrieved September 18, 2020.", "url": "https://github.com/decalage2/oletools", "number": null}, "Fireeye Hunting COM June 2019": {"description": "Hamilton, C. (2019, June 4). Hunting COM Objects. Retrieved June 10, 2019.", "url": "https://www.fireeye.com/blog/threat-research/2019/06/hunting-com-objects.html", "number": null}, "Enigma MMC20 COM Jan 2017": {"description": "Nelson, M. (2017, January 5). Lateral Movement using the MMC20 Application COM Object. Retrieved November 21, 2017.", "url": "https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/", "number": null}, "Mandiant Azure Run Command 2021": {"description": "Adrien Bataille, Anders Vejlby, Jared Scott Wilson, and Nader Zaveri. (2021, December 14). Azure Run Command for Dummies. Retrieved March 13, 2023.", "url": "https://www.mandiant.com/resources/blog/azure-run-command-dummies", "number": null}}, "versioning_feature": false}