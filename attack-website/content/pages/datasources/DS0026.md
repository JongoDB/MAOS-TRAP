Title: Active Directory
Template: datasources/datasource
save_as: datasources/DS0026/index.html
data: {"attack_id": "DS0026", "side_menu_data": {"name": "Data Sources", "id": "datasources", "path": null, "children": [{"name": "Active Directory", "id": "DS0026", "path": "/datasources/DS0026/", "children": [{"name": "Active Directory Credential Request", "id": "Active Directory Credential Request", "path": "/datasources/DS0026/#Active Directory Credential Request", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Access", "id": "Active Directory Object Access", "path": "/datasources/DS0026/#Active Directory Object Access", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Creation", "id": "Active Directory Object Creation", "path": "/datasources/DS0026/#Active Directory Object Creation", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Deletion", "id": "Active Directory Object Deletion", "path": "/datasources/DS0026/#Active Directory Object Deletion", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Modification", "id": "Active Directory Object Modification", "path": "/datasources/DS0026/#Active Directory Object Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Application Log", "id": "DS0015", "path": "/datasources/DS0015/", "children": [{"name": "Application Log Content", "id": "Application Log Content", "path": "/datasources/DS0015/#Application Log Content", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Application Vetting", "id": "DS0041", "path": "/datasources/DS0041/", "children": [{"name": "API Calls", "id": "API Calls", "path": "/datasources/DS0041/#API Calls", "domains": ["mobile"], "children": []}, {"name": "Application Assets", "id": "Application Assets", "path": "/datasources/DS0041/#Application Assets", "domains": ["mobile"], "children": []}, {"name": "Network Communication", "id": "Network Communication", "path": "/datasources/DS0041/#Network Communication", "domains": ["mobile"], "children": []}, {"name": "Permissions Requests", "id": "Permissions Requests", "path": "/datasources/DS0041/#Permissions Requests", "domains": ["mobile"], "children": []}, {"name": "Protected Configuration", "id": "Protected Configuration", "path": "/datasources/DS0041/#Protected Configuration", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Asset", "id": "DS0039", "path": "/datasources/DS0039/", "children": [{"name": "Asset Inventory", "id": "Asset Inventory", "path": "/datasources/DS0039/#Asset Inventory", "domains": ["ics"], "children": []}, {"name": "Software", "id": "Software", "path": "/datasources/DS0039/#Software", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Certificate", "id": "DS0037", "path": "/datasources/DS0037/", "children": [{"name": "Certificate Registration", "id": "Certificate Registration", "path": "/datasources/DS0037/#Certificate Registration", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Service", "id": "DS0025", "path": "/datasources/DS0025/", "children": [{"name": "Cloud Service Disable", "id": "Cloud Service Disable", "path": "/datasources/DS0025/#Cloud Service Disable", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Enumeration", "id": "Cloud Service Enumeration", "path": "/datasources/DS0025/#Cloud Service Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Metadata", "id": "Cloud Service Metadata", "path": "/datasources/DS0025/#Cloud Service Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Modification", "id": "Cloud Service Modification", "path": "/datasources/DS0025/#Cloud Service Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Storage", "id": "DS0010", "path": "/datasources/DS0010/", "children": [{"name": "Cloud Storage Access", "id": "Cloud Storage Access", "path": "/datasources/DS0010/#Cloud Storage Access", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Creation", "id": "Cloud Storage Creation", "path": "/datasources/DS0010/#Cloud Storage Creation", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Deletion", "id": "Cloud Storage Deletion", "path": "/datasources/DS0010/#Cloud Storage Deletion", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Enumeration", "id": "Cloud Storage Enumeration", "path": "/datasources/DS0010/#Cloud Storage Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Metadata", "id": "Cloud Storage Metadata", "path": "/datasources/DS0010/#Cloud Storage Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Modification", "id": "Cloud Storage Modification", "path": "/datasources/DS0010/#Cloud Storage Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Command", "id": "DS0017", "path": "/datasources/DS0017/", "children": [{"name": "Command Execution", "id": "Command Execution", "path": "/datasources/DS0017/#Command Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Container", "id": "DS0032", "path": "/datasources/DS0032/", "children": [{"name": "Container Creation", "id": "Container Creation", "path": "/datasources/DS0032/#Container Creation", "domains": ["enterprise"], "children": []}, {"name": "Container Enumeration", "id": "Container Enumeration", "path": "/datasources/DS0032/#Container Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Container Start", "id": "Container Start", "path": "/datasources/DS0032/#Container Start", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Domain Name", "id": "DS0038", "path": "/datasources/DS0038/", "children": [{"name": "Active DNS", "id": "Active DNS", "path": "/datasources/DS0038/#Active DNS", "domains": ["enterprise"], "children": []}, {"name": "Domain Registration", "id": "Domain Registration", "path": "/datasources/DS0038/#Domain Registration", "domains": ["enterprise"], "children": []}, {"name": "Passive DNS", "id": "Passive DNS", "path": "/datasources/DS0038/#Passive DNS", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Drive", "id": "DS0016", "path": "/datasources/DS0016/", "children": [{"name": "Drive Access", "id": "Drive Access", "path": "/datasources/DS0016/#Drive Access", "domains": ["enterprise"], "children": []}, {"name": "Drive Creation", "id": "Drive Creation", "path": "/datasources/DS0016/#Drive Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Drive Modification", "id": "Drive Modification", "path": "/datasources/DS0016/#Drive Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Driver", "id": "DS0027", "path": "/datasources/DS0027/", "children": [{"name": "Driver Load", "id": "Driver Load", "path": "/datasources/DS0027/#Driver Load", "domains": ["enterprise"], "children": []}, {"name": "Driver Metadata", "id": "Driver Metadata", "path": "/datasources/DS0027/#Driver Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "File", "id": "DS0022", "path": "/datasources/DS0022/", "children": [{"name": "File Access", "id": "File Access", "path": "/datasources/DS0022/#File Access", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Creation", "id": "File Creation", "path": "/datasources/DS0022/#File Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Deletion", "id": "File Deletion", "path": "/datasources/DS0022/#File Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Metadata", "id": "File Metadata", "path": "/datasources/DS0022/#File Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Modification", "id": "File Modification", "path": "/datasources/DS0022/#File Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Firewall", "id": "DS0018", "path": "/datasources/DS0018/", "children": [{"name": "Firewall Disable", "id": "Firewall Disable", "path": "/datasources/DS0018/#Firewall Disable", "domains": ["enterprise"], "children": []}, {"name": "Firewall Enumeration", "id": "Firewall Enumeration", "path": "/datasources/DS0018/#Firewall Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Firewall Metadata", "id": "Firewall Metadata", "path": "/datasources/DS0018/#Firewall Metadata", "domains": ["enterprise"], "children": []}, {"name": "Firewall Rule Modification", "id": "Firewall Rule Modification", "path": "/datasources/DS0018/#Firewall Rule Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Firmware", "id": "DS0001", "path": "/datasources/DS0001/", "children": [{"name": "Firmware Modification", "id": "Firmware Modification", "path": "/datasources/DS0001/#Firmware Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Group", "id": "DS0036", "path": "/datasources/DS0036/", "children": [{"name": "Group Enumeration", "id": "Group Enumeration", "path": "/datasources/DS0036/#Group Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Group Metadata", "id": "Group Metadata", "path": "/datasources/DS0036/#Group Metadata", "domains": ["enterprise"], "children": []}, {"name": "Group Modification", "id": "Group Modification", "path": "/datasources/DS0036/#Group Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Image", "id": "DS0007", "path": "/datasources/DS0007/", "children": [{"name": "Image Creation", "id": "Image Creation", "path": "/datasources/DS0007/#Image Creation", "domains": ["enterprise"], "children": []}, {"name": "Image Deletion", "id": "Image Deletion", "path": "/datasources/DS0007/#Image Deletion", "domains": ["enterprise"], "children": []}, {"name": "Image Metadata", "id": "Image Metadata", "path": "/datasources/DS0007/#Image Metadata", "domains": ["enterprise"], "children": []}, {"name": "Image Modification", "id": "Image Modification", "path": "/datasources/DS0007/#Image Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Instance", "id": "DS0030", "path": "/datasources/DS0030/", "children": [{"name": "Instance Creation", "id": "Instance Creation", "path": "/datasources/DS0030/#Instance Creation", "domains": ["enterprise"], "children": []}, {"name": "Instance Deletion", "id": "Instance Deletion", "path": "/datasources/DS0030/#Instance Deletion", "domains": ["enterprise"], "children": []}, {"name": "Instance Enumeration", "id": "Instance Enumeration", "path": "/datasources/DS0030/#Instance Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Instance Metadata", "id": "Instance Metadata", "path": "/datasources/DS0030/#Instance Metadata", "domains": ["enterprise"], "children": []}, {"name": "Instance Modification", "id": "Instance Modification", "path": "/datasources/DS0030/#Instance Modification", "domains": ["enterprise"], "children": []}, {"name": "Instance Start", "id": "Instance Start", "path": "/datasources/DS0030/#Instance Start", "domains": ["enterprise"], "children": []}, {"name": "Instance Stop", "id": "Instance Stop", "path": "/datasources/DS0030/#Instance Stop", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Internet Scan", "id": "DS0035", "path": "/datasources/DS0035/", "children": [{"name": "Response Content", "id": "Response Content", "path": "/datasources/DS0035/#Response Content", "domains": ["enterprise"], "children": []}, {"name": "Response Metadata", "id": "Response Metadata", "path": "/datasources/DS0035/#Response Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Kernel", "id": "DS0008", "path": "/datasources/DS0008/", "children": [{"name": "Kernel Module Load", "id": "Kernel Module Load", "path": "/datasources/DS0008/#Kernel Module Load", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Logon Session", "id": "DS0028", "path": "/datasources/DS0028/", "children": [{"name": "Logon Session Creation", "id": "Logon Session Creation", "path": "/datasources/DS0028/#Logon Session Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Logon Session Metadata", "id": "Logon Session Metadata", "path": "/datasources/DS0028/#Logon Session Metadata", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Malware Repository", "id": "DS0004", "path": "/datasources/DS0004/", "children": [{"name": "Malware Content", "id": "Malware Content", "path": "/datasources/DS0004/#Malware Content", "domains": ["enterprise"], "children": []}, {"name": "Malware Metadata", "id": "Malware Metadata", "path": "/datasources/DS0004/#Malware Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Module", "id": "DS0011", "path": "/datasources/DS0011/", "children": [{"name": "Module Load", "id": "Module Load", "path": "/datasources/DS0011/#Module Load", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Named Pipe", "id": "DS0023", "path": "/datasources/DS0023/", "children": [{"name": "Named Pipe Metadata", "id": "Named Pipe Metadata", "path": "/datasources/DS0023/#Named Pipe Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Network Share", "id": "DS0033", "path": "/datasources/DS0033/", "children": [{"name": "Network Share Access", "id": "Network Share Access", "path": "/datasources/DS0033/#Network Share Access", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Network Traffic", "id": "DS0029", "path": "/datasources/DS0029/", "children": [{"name": "Network Connection Creation", "id": "Network Connection Creation", "path": "/datasources/DS0029/#Network Connection Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Content", "id": "Network Traffic Content", "path": "/datasources/DS0029/#Network Traffic Content", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Flow", "id": "Network Traffic Flow", "path": "/datasources/DS0029/#Network Traffic Flow", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Operational Databases", "id": "DS0040", "path": "/datasources/DS0040/", "children": [{"name": "Device Alarm", "id": "Device Alarm", "path": "/datasources/DS0040/#Device Alarm", "domains": ["ics"], "children": []}, {"name": "Process History/Live Data", "id": "Process History/Live Data", "path": "/datasources/DS0040/#Process History/Live Data", "domains": ["ics"], "children": []}, {"name": "Process/Event Alarm", "id": "Process/Event Alarm", "path": "/datasources/DS0040/#Process/Event Alarm", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Persona", "id": "DS0021", "path": "/datasources/DS0021/", "children": [{"name": "Social Media", "id": "Social Media", "path": "/datasources/DS0021/#Social Media", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Pod", "id": "DS0014", "path": "/datasources/DS0014/", "children": [{"name": "Pod Creation", "id": "Pod Creation", "path": "/datasources/DS0014/#Pod Creation", "domains": ["enterprise"], "children": []}, {"name": "Pod Enumeration", "id": "Pod Enumeration", "path": "/datasources/DS0014/#Pod Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Pod Modification", "id": "Pod Modification", "path": "/datasources/DS0014/#Pod Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Process", "id": "DS0009", "path": "/datasources/DS0009/", "children": [{"name": "OS API Execution", "id": "OS API Execution", "path": "/datasources/DS0009/#OS API Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Access", "id": "Process Access", "path": "/datasources/DS0009/#Process Access", "domains": ["enterprise"], "children": []}, {"name": "Process Creation", "id": "Process Creation", "path": "/datasources/DS0009/#Process Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Metadata", "id": "Process Metadata", "path": "/datasources/DS0009/#Process Metadata", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Modification", "id": "Process Modification", "path": "/datasources/DS0009/#Process Modification", "domains": ["enterprise"], "children": []}, {"name": "Process Termination", "id": "Process Termination", "path": "/datasources/DS0009/#Process Termination", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Scheduled Job", "id": "DS0003", "path": "/datasources/DS0003/", "children": [{"name": "Scheduled Job Creation", "id": "Scheduled Job Creation", "path": "/datasources/DS0003/#Scheduled Job Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Scheduled Job Metadata", "id": "Scheduled Job Metadata", "path": "/datasources/DS0003/#Scheduled Job Metadata", "domains": ["enterprise"], "children": []}, {"name": "Scheduled Job Modification", "id": "Scheduled Job Modification", "path": "/datasources/DS0003/#Scheduled Job Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Script", "id": "DS0012", "path": "/datasources/DS0012/", "children": [{"name": "Script Execution", "id": "Script Execution", "path": "/datasources/DS0012/#Script Execution", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Sensor Health", "id": "DS0013", "path": "/datasources/DS0013/", "children": [{"name": "Host Status", "id": "Host Status", "path": "/datasources/DS0013/#Host Status", "domains": ["enterprise", "mobile"], "children": []}], "domains": ["enterprise", "mobile"]}, {"name": "Service", "id": "DS0019", "path": "/datasources/DS0019/", "children": [{"name": "Service Creation", "id": "Service Creation", "path": "/datasources/DS0019/#Service Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Metadata", "id": "Service Metadata", "path": "/datasources/DS0019/#Service Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Modification", "id": "Service Modification", "path": "/datasources/DS0019/#Service Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Snapshot", "id": "DS0020", "path": "/datasources/DS0020/", "children": [{"name": "Snapshot Creation", "id": "Snapshot Creation", "path": "/datasources/DS0020/#Snapshot Creation", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Deletion", "id": "Snapshot Deletion", "path": "/datasources/DS0020/#Snapshot Deletion", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Enumeration", "id": "Snapshot Enumeration", "path": "/datasources/DS0020/#Snapshot Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Metadata", "id": "Snapshot Metadata", "path": "/datasources/DS0020/#Snapshot Metadata", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Modification", "id": "Snapshot Modification", "path": "/datasources/DS0020/#Snapshot Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "User Account", "id": "DS0002", "path": "/datasources/DS0002/", "children": [{"name": "User Account Authentication", "id": "User Account Authentication", "path": "/datasources/DS0002/#User Account Authentication", "domains": ["enterprise", "ics"], "children": []}, {"name": "User Account Creation", "id": "User Account Creation", "path": "/datasources/DS0002/#User Account Creation", "domains": ["enterprise"], "children": []}, {"name": "User Account Deletion", "id": "User Account Deletion", "path": "/datasources/DS0002/#User Account Deletion", "domains": ["enterprise"], "children": []}, {"name": "User Account Metadata", "id": "User Account Metadata", "path": "/datasources/DS0002/#User Account Metadata", "domains": ["enterprise"], "children": []}, {"name": "User Account Modification", "id": "User Account Modification", "path": "/datasources/DS0002/#User Account Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "User Interface", "id": "DS0042", "path": "/datasources/DS0042/", "children": [{"name": "Permissions Request", "id": "Permissions Request", "path": "/datasources/DS0042/#Permissions Request", "domains": ["mobile"], "children": []}, {"name": "System Notifications", "id": "System Notifications", "path": "/datasources/DS0042/#System Notifications", "domains": ["mobile"], "children": []}, {"name": "System Settings", "id": "System Settings", "path": "/datasources/DS0042/#System Settings", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Volume", "id": "DS0034", "path": "/datasources/DS0034/", "children": [{"name": "Volume Creation", "id": "Volume Creation", "path": "/datasources/DS0034/#Volume Creation", "domains": ["enterprise"], "children": []}, {"name": "Volume Deletion", "id": "Volume Deletion", "path": "/datasources/DS0034/#Volume Deletion", "domains": ["enterprise"], "children": []}, {"name": "Volume Enumeration", "id": "Volume Enumeration", "path": "/datasources/DS0034/#Volume Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Volume Metadata", "id": "Volume Metadata", "path": "/datasources/DS0034/#Volume Metadata", "domains": ["enterprise"], "children": []}, {"name": "Volume Modification", "id": "Volume Modification", "path": "/datasources/DS0034/#Volume Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Web Credential", "id": "DS0006", "path": "/datasources/DS0006/", "children": [{"name": "Web Credential Creation", "id": "Web Credential Creation", "path": "/datasources/DS0006/#Web Credential Creation", "domains": ["enterprise"], "children": []}, {"name": "Web Credential Usage", "id": "Web Credential Usage", "path": "/datasources/DS0006/#Web Credential Usage", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Windows Registry", "id": "DS0024", "path": "/datasources/DS0024/", "children": [{"name": "Windows Registry Key Access", "id": "Windows Registry Key Access", "path": "/datasources/DS0024/#Windows Registry Key Access", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Creation", "id": "Windows Registry Key Creation", "path": "/datasources/DS0024/#Windows Registry Key Creation", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Deletion", "id": "Windows Registry Key Deletion", "path": "/datasources/DS0024/#Windows Registry Key Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "Windows Registry Key Modification", "id": "Windows Registry Key Modification", "path": "/datasources/DS0024/#Windows Registry Key Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "WMI", "id": "DS0005", "path": "/datasources/DS0005/", "children": [{"name": "WMI Creation", "id": "WMI Creation", "path": "/datasources/DS0005/#WMI Creation", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}]}, "notes": null, "created": "20 October 2021", "modified": "25 April 2025", "name": "Active Directory", "version": "1.0", "contributors_list": ["Center for Threat-Informed Defense (CTID)"], "descr": "A database and set of services that allows administrators to manage permissions, access to network resources, and stored data objects (user, group, application, or devices)(Citation: Microsoft AD DS Getting Started)", "platforms": "Identity Provider, Windows", "collection_layers": "Cloud Control Plane, Host", "datacomponents_list": [{"name": "Active Directory Credential Request", "descr": "Requests for authentication credentials via Kerberos or other methods like NTLM and LDAP queries. Examples:\n\n- Kerberos TGT and Service Tickets (Event IDs 4768, 4769)\n- NTLM Authentication Events\n- LDAP Bind Requests\n\n*Data Collection Measures:*\n\n- Security Event Logging:\n    - Enable \"`Audit Kerberos Authentication Service`\" or \"`Audit Kerberos Service Ticket Operations`.\"\n    - Captured Events: IDs 4768, 4769, 4624.\n- Windows Event Forwarding (WEF): Forward domain controller logs to SIEM.\n- SIEM Integration: Use tools like Splunk or Azure Sentinel for log analysis.\n- Kerberos Debug Logging:\n    - Registry Key: HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Kerberos\\Parameters.\n    - Set DWORD LogLevel to 1.\n- Azure AD Logs: Monitor Sign-In Logs for authentication and policy issues.\n- Enable EDR Monitoring:\n    - Use EDR to detect suspicious processes querying authentication mechanisms (e.g., lsass.exe memory access).", "techniques": [{"technique_used": true, "domain": "enterprise", "id": "T1649", "name": "Steal or Forge Authentication Certificates", "descr": "Monitor AD CS certificate requests (ex: EID 4886) as well as issued certificates (ex: EID 4887) for abnormal activity, including unexpected certificate enrollments and signs of abuse within certificate attributes (such as abusable EKUs).(Citation: SpecterOps Certified Pre Owned)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1558", "name": "Steal or Forge Kerberos Tickets", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Golden Ticket", "descr": "Monitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4769, 4768), RC4 encryption within TGTs, and TGS requests without preceding TGT requests. Monitor the lifetime of TGT tickets for values that differ from the default domain duration. Monitor for indications of Pass the Ticket being used to move laterally.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Kerberoasting", "descr": "Monitor for anomalous Kerberos activity, such as enabling Audit Kerberos Service Ticket Operations to log Kerberos TGS service ticket requests. Particularly investigate irregular patterns of activity (ex: accounts making numerous requests, Event ID 4769, within a small time frame, especially if they also request RC4 encryption [Type 0x17]).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "AS-REP Roasting", "descr": "Monitor for anomalous activity, such as enabling Audit Kerberos Service Ticket Operations to log Kerberos TGS service ticket requests. Particularly investigate irregular patterns of activity (ex: accounts making numerous requests, Event ID 4768 and 4769, within a small time frame, especially if they also request RC4 encryption [Type 0x17], pre-authentication not required [Type: 0x0]).", "subtechniques": [], "color": 1}], "descr": "Monitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4624, 4672, 4634), RC4 encryption within ticket granting tickets (TGTs), and ticket granting service (TGS) requests without preceding TGT requests.(Citation: ADSecurity Detecting Forged Tickets)(Citation: Stealthbits Detect PtT 2019)(Citation: CERT-EU Golden Ticket Protection)Monitor the lifetime of TGT tickets for values that differ from the default domain duration.(Citation: Microsoft Kerberos Golden Ticket) Monitor for indications of [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003) being used to move laterally."}, {"technique_used": true, "domain": "enterprise", "id": "T1550", "name": "Use Alternate Authentication Material", "descr": "Monitor requests of new ticket granting ticket or service tickets to a Domain Controller, such as Windows EID 4769 or 4768, that may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Pass the Hash", "descr": "Monitor requests of new ticket granting ticket or service tickets to a Domain Controller. Windows Security events such as 4768 (A Kerberos authentication ticket (TGT) was requested) and 4769 (A Kerberos service ticket was requested) combined with logon session creation information may be indicative of an overpass the hash attempt.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Pass the Ticket", "descr": "Monitor requests of new ticket granting ticket or service tickets to a Domain Controller. Event ID 4769 is generated on the Domain Controller when using a golden ticket after the KRBTGT password has been reset twice, as mentioned in the mitigation section. The status code 0x1F indicates the action has failed due to \"Integrity check on decrypted field failed\" and indicates misuse by a previously invalidated golden ticket.(Citation: CERT-EU Golden Ticket Protection)", "subtechniques": [], "color": 1}], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Active Directory Object Access", "descr": "Object access refers to activities where AD objects (e.g., user accounts, groups, policies) are accessed or queried. Example: Windows Event ID 4661 logs object access attempts. Examples:\n\n- Attribute Access: e.g., `userPassword`, `memberOf`, `securityDescriptor`.\n- Group Enumeration: Enumerating critical group members (e.g., Domain Admins).\n- User Attributes: Commonly accessed attributes like `samAccountName`, `lastLogonTimestamp`.\n- Policy Access: Accessing GPOs to understand security settings.\n\n*Data Collection Measures:*\n\n- Audit Policies:\n    - Enable \"Audit Directory Service Access\" under Advanced Audit Policies (Success and Failure).\n    - Path: `Computer Configuration > Policies > Windows Settings > Security Settings > Advanced Audit Policy Configuration > Audit Policies > Object AccessEnable: Audit Directory Service Access` (Success and Failure).\n    - Captured Events: IDs 4661, 4662.\n- Event Forwarding: Use WEF to centralize logs for SIEM analysis.\n- SIEM Integration: Collect and parse logs (e.g., 4661, 4662) using tools like Splunk or Azure Sentinel.\n- Log Filtering:\n- Focus on sensitive objects/attributes like:\n    - `Domain Admins` group.\n    - `userPassword`, `ntSecurityDescriptor`.\n- Enable EDR Monitoring:\n    - Detect processes accessing sensitive AD objects (e.g., samAccountName, securityDescriptor).\n    - Log all attempts to enumerate critical groups (e.g., \"Domain Admins\").", "techniques": [{"technique_used": true, "domain": "enterprise", "id": "T1615", "name": "Group Policy Discovery", "descr": "Monitor for abnormal LDAP queries with filters for <code>groupPolicyContainer</code> and high volumes of LDAP traffic to domain controllers. Windows Event ID 4661 can also be used to detect when a directory service has been accessed.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1003", "name": "OS Credential Dumping", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "DCSync", "descr": "Monitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync.(Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers may not log replication requests originating from the default domain controller account.(Citation: Harmj0y DCSync Sept 2015)\n\nAnalytic 1 - Monitor for replication requests from IPs not associated with known domain controllers.\n\n<code> index=security sourcetype=\"WinEventLog:Security\" EventCode=4662 AccessMask=0x100 guid IN (\"1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\", \"1131f6aa-9c07-11d1-f79f-00c04fc2dcd2\", \"9923a32a-3607-11d2-b9be-0000f87a36b2\", \"89e95b76-444d-4c62-991a-0facbeda640c\") </code>", "subtechniques": [], "color": 1}], "descr": "Monitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync. (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers may not log replication requests originating from the default domain controller account. (Citation: Harmj0y DCSync Sept 2015). Monitor for replication requests (Citation: Microsoft SAMR) from IPs not associated with known domain controllers. (Citation: AdSecurity DCSync Sept 2015)\n\nAnalytic 1 - Suspicious Replication Requests\n\n<code> sourcetype=WinEventLog:Security EventCode=\"4662\" AND AccessMask= \"0x100\" AND (guid= \u201c1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\u201d OR guid= \u201c1131f6aa-9c07-11d1-f79f-00c04fc2dcd2\u201d OR guid= \u201c9923a32a-3607-11d2-b9be-0000f87a36b2\u201d OR guid= \u201c89e95b76-444d-4c62-991a-0facbeda640c\u201c) </code>"}, {"technique_used": true, "domain": "enterprise", "id": "T1033", "name": "System Owner/User Discovery", "descr": "Monitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync. (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers may not log replication requests originating from the default domain controller account. (Citation: Harmj0y DCSync Sept 2015). Monitor for replication requests (Citation: Microsoft SAMR) from IPs not associated with known domain controllers. (Citation: AdSecurity DCSync Sept 2015)", "subtechniques": [], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Active Directory Object Creation", "descr": "Creating new objects in AD, such as user accounts, groups, organizational units (OUs), or trust relationships. Logged as Event ID 5137. Examples:\n\n- User Account Creation: New user account.\n- Group Creation: New security/distribution group.\n- OU Creation: New organizational unit.\n- Service Account Creation: New service account for automation or malicious tasks.\n- Trust Object Creation: Trust relationship with another domain.\n\n*Data Collection Measures:*\n\n- Audit Policy:\n    - Enable \"Audit Directory Service Changes\" (Success and Failure).\n    - Path: `Computer Configuration > Policies > Windows Settings > Security Settings > Advanced Audit Policy Configuration > Audit Policies > Directory Service Changes`.\n    - Key Event: Event ID 5137 (object creation).\n- Log Forwarding: Use WEF to centralize logs for SIEM tools (e.g., Splunk).\n- Enable EDR Monitoring:\n    - Track processes that create new accounts or modify AD objects.\n    - Correlate object creation with suspicious commands (e.g., net user /add).", "techniques": [{"domain": "enterprise", "id": "T1098", "name": "Account Manipulation", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Additional Cloud Credentials", "descr": "Monitor M365 Audit logs for ```Add application``` or ```Add service\nprincipal``` operations involving the AzureActiveDirectory\nworkloads. Scrutinize extended properties such user agents, app display names, and RequiredAppPermissions (e.g., ImpersonationAccessGrants and DirectAccessGrants).\n\nAnalytic 1 - Creation of applications with unusual permissions or from suspicious user agents/IPs.\n\nNote: To detect the creation of potentially malicious applications using hijacked admin credentials or from unusual IP addresses.\n\n<code> \"index=\"\"m365_audit_logs\"\" Workload=\"\"AzureActiveDirectory\"\" Operation=\"\"Add application\"\"\n| search ActorUserPrincipalName!=\"\"expected_admin_user\"\"\n| table CreationTime, ActorUserPrincipalName, IPAddress, ExtendedProperties, ModifiedProperties\"</code>\n\nAnalytic 2 - Creation of service principals with suspicious user agents or from unusual IP addresses.\n\nNote: To detect the creation of potentially malicious service principals using hijacked admin credentials or from unusual IP addresses.\n\n<code> \"index=\"\"m365_audit_logs\"\" Workload=\"\"AzureActiveDirectory\"\" Operation=\"\"Add service principal\"\"\n| search ActorUserPrincipalName!=\"\"expected_admin_user\"\"\n| table CreationTime, ActorUserPrincipalName, IPAddress, ExtendedProperties, ModifiedProperties\"</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Device Registration", "descr": "Monitor for the registration or joining of new device objects in Active Directory. Raise alerts when new devices are registered or joined without using MFA.(Citation: Microsoft Azure AD Security Operations for Devices)\n\nAnalytic 1 - Device registration events with suspicious user agents, unusual OS types, OS versions, or display names.\n\nNote: To detect the registration of potentially malicious devices using hijacked admin credentials or from unusual IP addresses.\n\n<code> index=\"m365_audit_logs\" Workload=\"AzureActiveDirectory\" Operation IN (\"Add registered owner to device\", \"Add device\", \"Add registered users to device\")\n| search ActorUserPrincipalName!=\"expected_admin_user\"\n| table CreationTime, ActorUserPrincipalName, IPAddress, ExtendedProperties, ModifiedProperties</code>", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1484", "name": "Domain or Tenant Policy Modification", "descr": "Monitor for newly constructed active directory objects, such as Windows EID 5137.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Group Policy Modification", "descr": "Monitor for newly constructed active directory objects, such as Windows EID 5137.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Trust Modification", "descr": "Monitor for newly constructed active directory objects, such as Windows EID 5137.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1207", "name": "Rogue Domain Controller", "descr": "Baseline and periodically analyze the Configuration partition of the AD schema and alert on creation of nTDSDSA objects.(Citation: DCShadow Blog)", "subtechniques": [], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Active Directory Object Deletion", "descr": "Object deletion in AD (e.g., user accounts, groups, OUs) is logged as Event ID 5141. Examples:\n\n- User Account: Deleted user.\n- Group: Deleted security/distribution group.\n- Organizational Unit (OU): Loss of configurations or policies.\n- Service Account: Disrupted operations or cover tracks.\n- Trust Object: Removed domain trust, disrupting connectivity.\n\n*Data Collection Measures:*\n\n- Audit Policy:\n    - Enable \"Audit Directory Service Changes\" (Success and Failure).\n    - Path: `Computer Configuration > Policies > Windows Settings > Security Settings > Advanced Audit Policy Configuration > Audit Policies > Directory Service Changes`.\n    - Key Event: Event ID 5141.\n- Log Forwarding: Use WEF to centralize logs for SIEM tools (e.g., Splunk).\n- Enable EDR Monitoring:\n    - Detect processes or users that initiate unauthorized object deletions.\n    - Monitor tools and scripts that may delete key directory objects.", "techniques": [{"technique_used": true, "domain": "enterprise", "id": "T1484", "name": "Domain or Tenant Policy Modification", "descr": "Monitor for unexpected deletion of an active directory object, such as Windows EID 5141.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Group Policy Modification", "descr": "Monitor for unexpected deletion of an active directory object, such as Windows EID 5141.", "subtechniques": [], "color": 1}], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Active Directory Object Modification", "descr": "Changes to AD objects (e.g., users, groups, OUs) are logged as Event ID 5136 (Object Modification) or 5163 (Attribute Changes). Examples:\n\n- User Account: Modifying attributes (e.g., group membership, enabling/disabling accounts).\n- Group Membership: Adding/removing members.\n- OU: Changing properties/permissions (e.g., delegation).\n- Service Account: Modifying SPNs or other attributes.\n- Object Attributes: Changes to passwords, logon hours, or control flags.\n\n*Data Collection Measures:*\n\n- Audit Policy:\n    - Enable \"Audit Directory Service Changes\" (Success and Failure).\n    - Path: `Computer Configuration > Policies > Windows Settings > Security Settings > Advanced Audit Policy Configuration > Audit Policies > Directory Service Changes`.\n    - Key Events: 5136 (modifications), 5163 (attribute changes).\n- Log Forwarding:\n    - Use WEF to centralize logs for SIEM.\n    - Parse logs to extract: Object Name, Attribute Changed, Initiator Account Name.\n- Enable EDR Monitoring:\n    - Detect changes to critical attributes (e.g., memberOf, logonHours).\n    - Track processes modifying directory service objects (e.g., Set-ADUser or dsmod).\n- Enable EDR Monitoring:\n    - Detect changes to critical attributes (e.g., memberOf, logonHours).\n    - Track processes modifying directory service objects (e.g., Set-ADUser or dsmod).", "techniques": [{"domain": "enterprise", "id": "T1134", "name": "Access Token Manipulation", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "SID-History Injection", "descr": "Monitor for changes to account management events on Domain Controllers for successful and failed changes to SID-History. (Citation: AdSecurity SID History Sept 2015) (Citation: Microsoft DsAddSidHistory)", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to AD settings that may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls."}, {"technique_used": true, "domain": "enterprise", "id": "T1531", "name": "Account Access Removal", "descr": "Monitor for changes made to AD settings for unexpected modifications to user accounts, such as deletions or potentially malicious changes to user attributes (credentials, status, etc.).\n\nAnalytic 1 - Unusual password change operations\n\n<code> index=\"m365_audit_logs\" Operation=\"Change user password\"\n| stats count by Actor, TargetUser\n| where Actor!=\"expected_actor\" AND TargetUser!=\"expected_target_user\"</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1098", "name": "Account Manipulation", "descr": "Monitor for the registration or joining of new device objects in Active Directory. Raise alerts when new devices are registered or joined without using MFA.(Citation: Microsoft Azure AD Security Operations for Devices)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Additional Cloud Credentials", "descr": "Monitor M365 Audit logs for ```Update application``` or ``` Update Service principal``` operations involving the AzureActiveDirectory workloads. Look for suspicious modified properties RequiredResourceAccess changes.\n\nAnalytic 1 - Suspicious modifications to RequiredResourceAccess, unexpected user agents, unusual modification times.\n\nNote: To detect suspicious updates to applications which might indicate the granting of unauthorized permissions or impersonation access.\n\n<code>\"index=\"\"m365_audit_logs\"\" Workload=\"\"AzureActiveDirectory\"\" Operation=\"\"Update application\"\"\n| search NOT (UserAgent=\"\"expected_user_agent\"\")\n| table CreationTime, UserPrincipalName, IPAddress, ExtendedProperties, ModifiedProperties\n\" </code>\n\nAnalytic 2 - Suspicious key descriptions, unexpected user agents, unusual modification times.\n\nNote: To detect suspicious updates to application certificates and secrets, which might indicate unauthorized access or changes.\n\n<code> \"index=\"\"m365_audit_logs\"\" Workload=\"\"AzureActiveDirectory\"\" Operation=\"\"Update application \u2013 Certificates and secrets management\"\"\n| search NOT (UserAgent=\"\"expected_user_agent\"\")\n| table CreationTime, UserPrincipalName, IPAddress, ExtendedProperties, ModifiedProperties\n\"</code>\n\nAnalytic 3 - Suspicious service principal names, unexpected user agents, unusual modification times.\n\nNote: To detect suspicious updates to service principals, which might indicate unauthorized access or changes.\n\n<code> \"index=\"\"m365_audit_logs\"\" Workload=\"\"AzureActiveDirectory\"\" Operation=\"\"Update service principal\"\"\n| search NOT (UserAgent=\"\"expected_user_agent\"\")\n| table CreationTime, UserPrincipalName, IPAddress, ExtendedProperties, ModifiedProperties\n\"</code>", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1037", "name": "Boot or Logon Initialization Scripts", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Network Logon Script", "descr": "Monitor for changes made in the Active Directory that may use network logon scripts automatically executed at logon initialization to establish persistence.", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made in the Active Directory that may use scripts automatically executed at boot or logon initialization to establish persistence."}, {"technique_used": true, "domain": "enterprise", "id": "T1671", "name": "Cloud Application Integration", "descr": "Monitor M365 Audit logs for the Operations `Add app role assignment grant to user` and/or `Consent to application` occurring against `AzureActiveDirectory` Workloads.(Citation: Splunk Hunting M365 Invaders 2024)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1484", "name": "Domain or Tenant Policy Modification", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Group Policy Modification", "descr": "Monitor for changes made to AD settings for unexpected modifications to user accounts, such as deletions or potentially malicious changes to user attributes (credentials, status, etc.).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Trust Modification", "descr": "Monitor for changes made to AD settings for unexpected modifications to domain trust settings, such as when a user or application modifies the federation settings on the domain.", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to AD settings for unexpected modifications to user accounts, such as deletions or potentially malicious changes to user attributes (credentials, status, etc.)."}, {"domain": "enterprise", "id": "T1222", "name": "File and Directory Permissions Modification", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Windows File and Directory Permissions Modification", "descr": "Monitor for changes made to DACLs and file/directory ownership. Many of the commands used to modify DACLs and file/directory ownership are built-in system utilities and may generate a high false positive alert rate, so compare against baseline knowledge for how systems are typically used and correlate modification events with other indications of malicious activity where possible.", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to ACLs and file/directory ownership. Many of the commands used to modify ACLs and file/directory ownership are built-in system utilities and may generate a high false positive alert rate, so compare against baseline knowledge for how systems are typically used and correlate modification events with other indications of malicious activity where possible."}, {"domain": "enterprise", "id": "T1556", "name": "Modify Authentication Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Reversible Encryption", "descr": "Monitor property changes in Group Policy: <code>Computer Configuration\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Store passwords using reversible encryption</code>. By default, the property should be set to Disabled.\n\nAnalytic 1 - Enabling reversible encryption outside of standard procedures.\n\n<code>index=windows source=\"WinEventLog:Security\" (EventCode=5136 OR EventCode=5137 OR EventCode=5138 OR EventCode=5139)\n| search AttributeLDAPDisplayName=\"msDS-User-Account-Control-Computed\" OR AttributeLDAPDisplayName=\"userParameters\"\n| rex field=_raw \"ObjectDN=(?P<ObjectDN>[^,]+)\"\n| eval Modification=if(match(AttributeValue, \".*;PwdProperties=1.*\"), \"Enabled\", \"Disabled\")\n| stats count by ObjectDN, Modification, EventCode, AttributeValue\n| where Modification=\"Enabled\" </code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Multi-Factor Authentication", "descr": "Monitor for changes made to AD security settings related to MFA logon requirements, such as changes to Azure AD Conditional Access Policies or the registration of new MFA applications. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "009", "name": "Conditional Access Policies", "descr": "Monitor for changes made to security settings related to Entra ID Conditional Access Policies. For example, these can be found in the Entra ID audit log under the operation name `Update Conditional Access policy.`(Citation: Microsoft Conditional Access Policy Changes)", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to AD security settings related to MFA logon requirements, such as changes to Azure AD Conditional Access Policies or the registration of new MFA applications.\n\nMonitor for changes made to security settings related to Azure AD Conditional Access Policies. These can be found in the Azure AD audit log under the operation name `Update Conditional Access policy.`(Citation: Microsoft Conditional Access Policy Changes)\n\nAnalytic 1 - Changes to AD security settings outside of normal maintenance windows.\n\n<code>index=security sourcetype IN (\"WinEventLog:Security\", \"azure:activity\", \"gsuite:reports:activity\", \"aws:cloudtrail\", \"linux_audit\", \"macos_secure\", \"network_logs\")\n(EventCode IN (4670, 5136, 5137, 5139, 5141) OR\n eventName IN (\"UpdateUser\", \"UpdateGroup\", \"UpdatePolicy\", \"UpdateRole\", \"PutRolePolicy\", \"AttachUserPolicy\", \"AttachGroupPolicy\", \"AttachRolePolicy\") OR\n \"protoPayload.methodName\" IN (\"directory.users.update\", \"admin.directory.group.update\", \"admin.directory.roleAssignments.update\")) </code>"}, {"technique_used": true, "domain": "enterprise", "id": "T1207", "name": "Rogue Domain Controller", "descr": "Leverage AD directory synchronization (DirSync) to monitor changes to directory state using AD replication cookies.(Citation: Microsoft DirSync)\u00a0(Citation: ADDSecurity DCShadow Feb 2018) Also consider monitoring and alerting on the replication of AD objects (Audit Detailed Directory Service Replication Events 4928 and 4929). (Citation: DCShadow Blog)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1528", "name": "Steal Application Access Token", "descr": "Monitor M365 Audit logs for the Operations Add app role assignment grant to user and/or Consent to application occurring against AzureActiveDirectory Workloads.\n\nAnalytic 1 - Unusual app role assignments or consents to applications.\n\n<code> index=security sourcetype=\"WinEventLog:Security\" EventCode=5136 OR \n(index=azuread sourcetype=\"azure:activity\" operationName=\"Add member to role\" OR operationName=\"Update application\" OR operationName=\"Update servicePrincipal\") OR\n(index=gsuite sourcetype=\"gsuite:admin\" event_type=\"UPDATE_GROUP\" OR event_type=\"UPDATE_USER\") OR\n(index=o365 sourcetype=\"o365:management:activity\" operation IN (\"Add member to role\", \"Update user\", \"Update group\"))</code>", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1649", "name": "Steal or Forge Authentication Certificates", "descr": "Monitor for changes to CA attributes and settings, such as AD CS certificate template modifications (ex: EID 4899/4900 once a potentially malicious certificate is enrolled).(Citation: SpecterOps Certified Pre Owned)", "subtechniques": [], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}], "citations": {"current_number": 0, "Microsoft AD DS Getting Started": {"description": "Foulds, I. et al. (2018, August 7). AD DS Getting Started. Retrieved September 23, 2021.", "url": "https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/ad-ds-getting-started", "number": null}, "Microsoft DRSR Dec 2017": {"description": "Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017.", "url": "https://msdn.microsoft.com/library/cc228086.aspx", "number": null}, "Microsoft GetNCCChanges": {"description": "Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017.", "url": "https://msdn.microsoft.com/library/dd207691.aspx", "number": null}, "Samba DRSUAPI": {"description": "SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017.", "url": "https://wiki.samba.org/index.php/DRSUAPI", "number": null}, "Harmj0y DCSync Sept 2015": {"description": "Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017.", "url": "http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/", "number": null}, "AdSecurity DCSync Sept 2015": {"description": "Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017.", "url": "https://adsecurity.org/?p=1729", "number": null}, "Microsoft SAMR": {"description": "Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017.", "url": "https://msdn.microsoft.com/library/cc245496.aspx", "number": null}, "Microsoft Conditional Access Policy Changes": {"description": "Microsoft. (2023, October 23). Troubleshooting Conditional Access policy changes. Retrieved January 2, 2024.", "url": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/troubleshoot-policy-changes-audit-log", "number": null}, "AdSecurity SID History Sept 2015": {"description": "Metcalf, S. (2015, September 19). Sneaky Active Directory Persistence #14: SID History. Retrieved November 30, 2017.", "url": "https://adsecurity.org/?p=1772", "number": null}, "Microsoft DsAddSidHistory": {"description": "Microsoft. (n.d.). Using DsAddSidHistory. Retrieved November 30, 2017.", "url": "https://msdn.microsoft.com/library/ms677982.aspx", "number": null}, "Microsoft Azure AD Security Operations for Devices": {"description": "Microsoft. (2020, September 16). Azure Active Directory security operations for devices. Retrieved February 21, 2023.", "url": "https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-devices", "number": null}, "Microsoft DirSync": {"description": "Microsoft. (n.d.). Polling for Changes Using the DirSync Control. Retrieved March 30, 2018.", "url": "https://msdn.microsoft.com/en-us/library/ms677626.aspx", "number": null}, "ADDSecurity DCShadow Feb 2018": {"description": "Lucand,G. (2018, February 18). Detect DCShadow, impossible?. Retrieved March 30, 2018.", "url": "https://adds-security.blogspot.fr/2018/02/detecter-dcshadow-impossible.html", "number": null}, "DCShadow Blog": {"description": "Delpy, B. & LE TOUX, V. (n.d.). DCShadow. Retrieved March 20, 2018.", "url": "https://www.dcshadow.com/", "number": null}, "Splunk Hunting M365 Invaders 2024": {"description": "Mauricio Velazco. (2024, January 4). Hunting M365 Invaders: Blue Team\u2019s Guide to Initial Access Vectors. Retrieved April 3, 2025.", "url": "https://www.splunk.com/en_us/blog/security/hunting-m365-invaders-blue-team-s-guide-to-initial-access-vectors.html", "number": null}, "SpecterOps Certified Pre Owned": {"description": "Schroeder, W. & Christensen, L. (2021, June 22). Certified Pre-Owned - Abusing Active Directory Certificate Services. Retrieved August 2, 2022.", "url": "https://web.archive.org/web/20220818094600/https://specterops.io/assets/resources/Certified_Pre-Owned.pdf", "number": null}, "CERT-EU Golden Ticket Protection": {"description": "Abolins, D., Boldea, C., Socha, K., Soria-Machado, M. (2016, April 26). Kerberos Golden Ticket Protection. Retrieved July 13, 2017.", "url": "https://cert.europa.eu/static/WhitePapers/UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf", "number": null}, "Stealthbits Detect PtT 2019": {"description": "Jeff Warren. (2019, February 19). How to Detect Pass-the-Ticket Attacks. Retrieved February 27, 2020.", "url": "https://blog.stealthbits.com/detect-pass-the-ticket-attacks", "number": null}, "ADSecurity Detecting Forged Tickets": {"description": "Metcalf, S. (2015, May 03). Detecting Forged Kerberos Ticket (Golden Ticket & Silver Ticket) Use in Active Directory. Retrieved December 23, 2015.", "url": "https://adsecurity.org/?p=1515", "number": null}, "Microsoft Kerberos Golden Ticket": {"description": "Microsoft. (2015, March 24). Kerberos Golden Ticket Check (Updated). Retrieved February 27, 2020.", "url": "https://gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285", "number": null}}, "versioning_feature": false}