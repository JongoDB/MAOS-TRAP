Title: Firewall
Template: datasources/datasource
save_as: datasources/DS0018/index.html
data: {"attack_id": "DS0018", "side_menu_data": {"name": "Data Sources", "id": "datasources", "path": null, "children": [{"name": "Active Directory", "id": "DS0026", "path": "/datasources/DS0026/", "children": [{"name": "Active Directory Credential Request", "id": "Active Directory Credential Request", "path": "/datasources/DS0026/#Active Directory Credential Request", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Access", "id": "Active Directory Object Access", "path": "/datasources/DS0026/#Active Directory Object Access", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Creation", "id": "Active Directory Object Creation", "path": "/datasources/DS0026/#Active Directory Object Creation", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Deletion", "id": "Active Directory Object Deletion", "path": "/datasources/DS0026/#Active Directory Object Deletion", "domains": ["enterprise"], "children": []}, {"name": "Active Directory Object Modification", "id": "Active Directory Object Modification", "path": "/datasources/DS0026/#Active Directory Object Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Application Log", "id": "DS0015", "path": "/datasources/DS0015/", "children": [{"name": "Application Log Content", "id": "Application Log Content", "path": "/datasources/DS0015/#Application Log Content", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Application Vetting", "id": "DS0041", "path": "/datasources/DS0041/", "children": [{"name": "API Calls", "id": "API Calls", "path": "/datasources/DS0041/#API Calls", "domains": ["mobile"], "children": []}, {"name": "Application Assets", "id": "Application Assets", "path": "/datasources/DS0041/#Application Assets", "domains": ["mobile"], "children": []}, {"name": "Network Communication", "id": "Network Communication", "path": "/datasources/DS0041/#Network Communication", "domains": ["mobile"], "children": []}, {"name": "Permissions Requests", "id": "Permissions Requests", "path": "/datasources/DS0041/#Permissions Requests", "domains": ["mobile"], "children": []}, {"name": "Protected Configuration", "id": "Protected Configuration", "path": "/datasources/DS0041/#Protected Configuration", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Asset", "id": "DS0039", "path": "/datasources/DS0039/", "children": [{"name": "Asset Inventory", "id": "Asset Inventory", "path": "/datasources/DS0039/#Asset Inventory", "domains": ["ics"], "children": []}, {"name": "Software", "id": "Software", "path": "/datasources/DS0039/#Software", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Certificate", "id": "DS0037", "path": "/datasources/DS0037/", "children": [{"name": "Certificate Registration", "id": "Certificate Registration", "path": "/datasources/DS0037/#Certificate Registration", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Service", "id": "DS0025", "path": "/datasources/DS0025/", "children": [{"name": "Cloud Service Disable", "id": "Cloud Service Disable", "path": "/datasources/DS0025/#Cloud Service Disable", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Enumeration", "id": "Cloud Service Enumeration", "path": "/datasources/DS0025/#Cloud Service Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Metadata", "id": "Cloud Service Metadata", "path": "/datasources/DS0025/#Cloud Service Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Service Modification", "id": "Cloud Service Modification", "path": "/datasources/DS0025/#Cloud Service Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Cloud Storage", "id": "DS0010", "path": "/datasources/DS0010/", "children": [{"name": "Cloud Storage Access", "id": "Cloud Storage Access", "path": "/datasources/DS0010/#Cloud Storage Access", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Creation", "id": "Cloud Storage Creation", "path": "/datasources/DS0010/#Cloud Storage Creation", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Deletion", "id": "Cloud Storage Deletion", "path": "/datasources/DS0010/#Cloud Storage Deletion", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Enumeration", "id": "Cloud Storage Enumeration", "path": "/datasources/DS0010/#Cloud Storage Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Metadata", "id": "Cloud Storage Metadata", "path": "/datasources/DS0010/#Cloud Storage Metadata", "domains": ["enterprise"], "children": []}, {"name": "Cloud Storage Modification", "id": "Cloud Storage Modification", "path": "/datasources/DS0010/#Cloud Storage Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Command", "id": "DS0017", "path": "/datasources/DS0017/", "children": [{"name": "Command Execution", "id": "Command Execution", "path": "/datasources/DS0017/#Command Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Container", "id": "DS0032", "path": "/datasources/DS0032/", "children": [{"name": "Container Creation", "id": "Container Creation", "path": "/datasources/DS0032/#Container Creation", "domains": ["enterprise"], "children": []}, {"name": "Container Enumeration", "id": "Container Enumeration", "path": "/datasources/DS0032/#Container Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Container Start", "id": "Container Start", "path": "/datasources/DS0032/#Container Start", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Domain Name", "id": "DS0038", "path": "/datasources/DS0038/", "children": [{"name": "Active DNS", "id": "Active DNS", "path": "/datasources/DS0038/#Active DNS", "domains": ["enterprise"], "children": []}, {"name": "Domain Registration", "id": "Domain Registration", "path": "/datasources/DS0038/#Domain Registration", "domains": ["enterprise"], "children": []}, {"name": "Passive DNS", "id": "Passive DNS", "path": "/datasources/DS0038/#Passive DNS", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Drive", "id": "DS0016", "path": "/datasources/DS0016/", "children": [{"name": "Drive Access", "id": "Drive Access", "path": "/datasources/DS0016/#Drive Access", "domains": ["enterprise"], "children": []}, {"name": "Drive Creation", "id": "Drive Creation", "path": "/datasources/DS0016/#Drive Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Drive Modification", "id": "Drive Modification", "path": "/datasources/DS0016/#Drive Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Driver", "id": "DS0027", "path": "/datasources/DS0027/", "children": [{"name": "Driver Load", "id": "Driver Load", "path": "/datasources/DS0027/#Driver Load", "domains": ["enterprise"], "children": []}, {"name": "Driver Metadata", "id": "Driver Metadata", "path": "/datasources/DS0027/#Driver Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "File", "id": "DS0022", "path": "/datasources/DS0022/", "children": [{"name": "File Access", "id": "File Access", "path": "/datasources/DS0022/#File Access", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Creation", "id": "File Creation", "path": "/datasources/DS0022/#File Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Deletion", "id": "File Deletion", "path": "/datasources/DS0022/#File Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Metadata", "id": "File Metadata", "path": "/datasources/DS0022/#File Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "File Modification", "id": "File Modification", "path": "/datasources/DS0022/#File Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Firewall", "id": "DS0018", "path": "/datasources/DS0018/", "children": [{"name": "Firewall Disable", "id": "Firewall Disable", "path": "/datasources/DS0018/#Firewall Disable", "domains": ["enterprise"], "children": []}, {"name": "Firewall Enumeration", "id": "Firewall Enumeration", "path": "/datasources/DS0018/#Firewall Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Firewall Metadata", "id": "Firewall Metadata", "path": "/datasources/DS0018/#Firewall Metadata", "domains": ["enterprise"], "children": []}, {"name": "Firewall Rule Modification", "id": "Firewall Rule Modification", "path": "/datasources/DS0018/#Firewall Rule Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Firmware", "id": "DS0001", "path": "/datasources/DS0001/", "children": [{"name": "Firmware Modification", "id": "Firmware Modification", "path": "/datasources/DS0001/#Firmware Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Group", "id": "DS0036", "path": "/datasources/DS0036/", "children": [{"name": "Group Enumeration", "id": "Group Enumeration", "path": "/datasources/DS0036/#Group Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Group Metadata", "id": "Group Metadata", "path": "/datasources/DS0036/#Group Metadata", "domains": ["enterprise"], "children": []}, {"name": "Group Modification", "id": "Group Modification", "path": "/datasources/DS0036/#Group Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Image", "id": "DS0007", "path": "/datasources/DS0007/", "children": [{"name": "Image Creation", "id": "Image Creation", "path": "/datasources/DS0007/#Image Creation", "domains": ["enterprise"], "children": []}, {"name": "Image Deletion", "id": "Image Deletion", "path": "/datasources/DS0007/#Image Deletion", "domains": ["enterprise"], "children": []}, {"name": "Image Metadata", "id": "Image Metadata", "path": "/datasources/DS0007/#Image Metadata", "domains": ["enterprise"], "children": []}, {"name": "Image Modification", "id": "Image Modification", "path": "/datasources/DS0007/#Image Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Instance", "id": "DS0030", "path": "/datasources/DS0030/", "children": [{"name": "Instance Creation", "id": "Instance Creation", "path": "/datasources/DS0030/#Instance Creation", "domains": ["enterprise"], "children": []}, {"name": "Instance Deletion", "id": "Instance Deletion", "path": "/datasources/DS0030/#Instance Deletion", "domains": ["enterprise"], "children": []}, {"name": "Instance Enumeration", "id": "Instance Enumeration", "path": "/datasources/DS0030/#Instance Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Instance Metadata", "id": "Instance Metadata", "path": "/datasources/DS0030/#Instance Metadata", "domains": ["enterprise"], "children": []}, {"name": "Instance Modification", "id": "Instance Modification", "path": "/datasources/DS0030/#Instance Modification", "domains": ["enterprise"], "children": []}, {"name": "Instance Start", "id": "Instance Start", "path": "/datasources/DS0030/#Instance Start", "domains": ["enterprise"], "children": []}, {"name": "Instance Stop", "id": "Instance Stop", "path": "/datasources/DS0030/#Instance Stop", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Internet Scan", "id": "DS0035", "path": "/datasources/DS0035/", "children": [{"name": "Response Content", "id": "Response Content", "path": "/datasources/DS0035/#Response Content", "domains": ["enterprise"], "children": []}, {"name": "Response Metadata", "id": "Response Metadata", "path": "/datasources/DS0035/#Response Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Kernel", "id": "DS0008", "path": "/datasources/DS0008/", "children": [{"name": "Kernel Module Load", "id": "Kernel Module Load", "path": "/datasources/DS0008/#Kernel Module Load", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Logon Session", "id": "DS0028", "path": "/datasources/DS0028/", "children": [{"name": "Logon Session Creation", "id": "Logon Session Creation", "path": "/datasources/DS0028/#Logon Session Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Logon Session Metadata", "id": "Logon Session Metadata", "path": "/datasources/DS0028/#Logon Session Metadata", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Malware Repository", "id": "DS0004", "path": "/datasources/DS0004/", "children": [{"name": "Malware Content", "id": "Malware Content", "path": "/datasources/DS0004/#Malware Content", "domains": ["enterprise"], "children": []}, {"name": "Malware Metadata", "id": "Malware Metadata", "path": "/datasources/DS0004/#Malware Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Module", "id": "DS0011", "path": "/datasources/DS0011/", "children": [{"name": "Module Load", "id": "Module Load", "path": "/datasources/DS0011/#Module Load", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Named Pipe", "id": "DS0023", "path": "/datasources/DS0023/", "children": [{"name": "Named Pipe Metadata", "id": "Named Pipe Metadata", "path": "/datasources/DS0023/#Named Pipe Metadata", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Network Share", "id": "DS0033", "path": "/datasources/DS0033/", "children": [{"name": "Network Share Access", "id": "Network Share Access", "path": "/datasources/DS0033/#Network Share Access", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Network Traffic", "id": "DS0029", "path": "/datasources/DS0029/", "children": [{"name": "Network Connection Creation", "id": "Network Connection Creation", "path": "/datasources/DS0029/#Network Connection Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Content", "id": "Network Traffic Content", "path": "/datasources/DS0029/#Network Traffic Content", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Network Traffic Flow", "id": "Network Traffic Flow", "path": "/datasources/DS0029/#Network Traffic Flow", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Operational Databases", "id": "DS0040", "path": "/datasources/DS0040/", "children": [{"name": "Device Alarm", "id": "Device Alarm", "path": "/datasources/DS0040/#Device Alarm", "domains": ["ics"], "children": []}, {"name": "Process History/Live Data", "id": "Process History/Live Data", "path": "/datasources/DS0040/#Process History/Live Data", "domains": ["ics"], "children": []}, {"name": "Process/Event Alarm", "id": "Process/Event Alarm", "path": "/datasources/DS0040/#Process/Event Alarm", "domains": ["ics"], "children": []}], "domains": ["ics"]}, {"name": "Persona", "id": "DS0021", "path": "/datasources/DS0021/", "children": [{"name": "Social Media", "id": "Social Media", "path": "/datasources/DS0021/#Social Media", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Pod", "id": "DS0014", "path": "/datasources/DS0014/", "children": [{"name": "Pod Creation", "id": "Pod Creation", "path": "/datasources/DS0014/#Pod Creation", "domains": ["enterprise"], "children": []}, {"name": "Pod Enumeration", "id": "Pod Enumeration", "path": "/datasources/DS0014/#Pod Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Pod Modification", "id": "Pod Modification", "path": "/datasources/DS0014/#Pod Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Process", "id": "DS0009", "path": "/datasources/DS0009/", "children": [{"name": "OS API Execution", "id": "OS API Execution", "path": "/datasources/DS0009/#OS API Execution", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Access", "id": "Process Access", "path": "/datasources/DS0009/#Process Access", "domains": ["enterprise"], "children": []}, {"name": "Process Creation", "id": "Process Creation", "path": "/datasources/DS0009/#Process Creation", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Metadata", "id": "Process Metadata", "path": "/datasources/DS0009/#Process Metadata", "domains": ["enterprise", "mobile", "ics"], "children": []}, {"name": "Process Modification", "id": "Process Modification", "path": "/datasources/DS0009/#Process Modification", "domains": ["enterprise"], "children": []}, {"name": "Process Termination", "id": "Process Termination", "path": "/datasources/DS0009/#Process Termination", "domains": ["enterprise", "mobile", "ics"], "children": []}], "domains": ["enterprise", "mobile", "ics"]}, {"name": "Scheduled Job", "id": "DS0003", "path": "/datasources/DS0003/", "children": [{"name": "Scheduled Job Creation", "id": "Scheduled Job Creation", "path": "/datasources/DS0003/#Scheduled Job Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Scheduled Job Metadata", "id": "Scheduled Job Metadata", "path": "/datasources/DS0003/#Scheduled Job Metadata", "domains": ["enterprise"], "children": []}, {"name": "Scheduled Job Modification", "id": "Scheduled Job Modification", "path": "/datasources/DS0003/#Scheduled Job Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Script", "id": "DS0012", "path": "/datasources/DS0012/", "children": [{"name": "Script Execution", "id": "Script Execution", "path": "/datasources/DS0012/#Script Execution", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Sensor Health", "id": "DS0013", "path": "/datasources/DS0013/", "children": [{"name": "Host Status", "id": "Host Status", "path": "/datasources/DS0013/#Host Status", "domains": ["enterprise", "mobile"], "children": []}], "domains": ["enterprise", "mobile"]}, {"name": "Service", "id": "DS0019", "path": "/datasources/DS0019/", "children": [{"name": "Service Creation", "id": "Service Creation", "path": "/datasources/DS0019/#Service Creation", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Metadata", "id": "Service Metadata", "path": "/datasources/DS0019/#Service Metadata", "domains": ["enterprise", "ics"], "children": []}, {"name": "Service Modification", "id": "Service Modification", "path": "/datasources/DS0019/#Service Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "Snapshot", "id": "DS0020", "path": "/datasources/DS0020/", "children": [{"name": "Snapshot Creation", "id": "Snapshot Creation", "path": "/datasources/DS0020/#Snapshot Creation", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Deletion", "id": "Snapshot Deletion", "path": "/datasources/DS0020/#Snapshot Deletion", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Enumeration", "id": "Snapshot Enumeration", "path": "/datasources/DS0020/#Snapshot Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Metadata", "id": "Snapshot Metadata", "path": "/datasources/DS0020/#Snapshot Metadata", "domains": ["enterprise"], "children": []}, {"name": "Snapshot Modification", "id": "Snapshot Modification", "path": "/datasources/DS0020/#Snapshot Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "User Account", "id": "DS0002", "path": "/datasources/DS0002/", "children": [{"name": "User Account Authentication", "id": "User Account Authentication", "path": "/datasources/DS0002/#User Account Authentication", "domains": ["enterprise", "ics"], "children": []}, {"name": "User Account Creation", "id": "User Account Creation", "path": "/datasources/DS0002/#User Account Creation", "domains": ["enterprise"], "children": []}, {"name": "User Account Deletion", "id": "User Account Deletion", "path": "/datasources/DS0002/#User Account Deletion", "domains": ["enterprise"], "children": []}, {"name": "User Account Metadata", "id": "User Account Metadata", "path": "/datasources/DS0002/#User Account Metadata", "domains": ["enterprise"], "children": []}, {"name": "User Account Modification", "id": "User Account Modification", "path": "/datasources/DS0002/#User Account Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "User Interface", "id": "DS0042", "path": "/datasources/DS0042/", "children": [{"name": "Permissions Request", "id": "Permissions Request", "path": "/datasources/DS0042/#Permissions Request", "domains": ["mobile"], "children": []}, {"name": "System Notifications", "id": "System Notifications", "path": "/datasources/DS0042/#System Notifications", "domains": ["mobile"], "children": []}, {"name": "System Settings", "id": "System Settings", "path": "/datasources/DS0042/#System Settings", "domains": ["mobile"], "children": []}], "domains": ["mobile"]}, {"name": "Volume", "id": "DS0034", "path": "/datasources/DS0034/", "children": [{"name": "Volume Creation", "id": "Volume Creation", "path": "/datasources/DS0034/#Volume Creation", "domains": ["enterprise"], "children": []}, {"name": "Volume Deletion", "id": "Volume Deletion", "path": "/datasources/DS0034/#Volume Deletion", "domains": ["enterprise"], "children": []}, {"name": "Volume Enumeration", "id": "Volume Enumeration", "path": "/datasources/DS0034/#Volume Enumeration", "domains": ["enterprise"], "children": []}, {"name": "Volume Metadata", "id": "Volume Metadata", "path": "/datasources/DS0034/#Volume Metadata", "domains": ["enterprise"], "children": []}, {"name": "Volume Modification", "id": "Volume Modification", "path": "/datasources/DS0034/#Volume Modification", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Web Credential", "id": "DS0006", "path": "/datasources/DS0006/", "children": [{"name": "Web Credential Creation", "id": "Web Credential Creation", "path": "/datasources/DS0006/#Web Credential Creation", "domains": ["enterprise"], "children": []}, {"name": "Web Credential Usage", "id": "Web Credential Usage", "path": "/datasources/DS0006/#Web Credential Usage", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}, {"name": "Windows Registry", "id": "DS0024", "path": "/datasources/DS0024/", "children": [{"name": "Windows Registry Key Access", "id": "Windows Registry Key Access", "path": "/datasources/DS0024/#Windows Registry Key Access", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Creation", "id": "Windows Registry Key Creation", "path": "/datasources/DS0024/#Windows Registry Key Creation", "domains": ["enterprise"], "children": []}, {"name": "Windows Registry Key Deletion", "id": "Windows Registry Key Deletion", "path": "/datasources/DS0024/#Windows Registry Key Deletion", "domains": ["enterprise", "ics"], "children": []}, {"name": "Windows Registry Key Modification", "id": "Windows Registry Key Modification", "path": "/datasources/DS0024/#Windows Registry Key Modification", "domains": ["enterprise", "ics"], "children": []}], "domains": ["enterprise", "ics"]}, {"name": "WMI", "id": "DS0005", "path": "/datasources/DS0005/", "children": [{"name": "WMI Creation", "id": "WMI Creation", "path": "/datasources/DS0005/#WMI Creation", "domains": ["enterprise"], "children": []}], "domains": ["enterprise"]}]}, "notes": null, "created": "20 October 2021", "modified": "25 April 2025", "name": "Firewall", "version": "1.1", "contributors_list": ["Center for Threat-Informed Defense (CTID)"], "descr": "A network security system, running locally on an endpoint or remotely as a service (ex: cloud environment), that monitors and controls incoming/outgoing network traffic based on predefined rules(Citation: AWS Sec Groups VPC)", "platforms": "ESXi, IaaS, Identity Provider, Linux, Office Suite, SaaS, Windows, macOS", "collection_layers": "Cloud Control Plane, Host", "datacomponents_list": [{"name": "Firewall Disable", "descr": "The deactivation, misconfiguration, or complete stoppage of firewall services, either on a host or in a cloud control plane. Such activity may involve turning off firewalls, modifying rules to disable protection, or deleting firewall-related configurations and activity logs. Examples: \n\n- Disabling Host-Based Firewalls: Stopping the Windows Defender Firewall service or using `iptables -F` to flush all rules on a Linux system.\n- Cloud Firewall Modification or Deactivation: Modifying or deleting security group rules in AWS or disabling a network firewall in Azure.\n- Activity Log Deletion: Writing or deleting entries in Azure Firewall Activity Logs to hide unauthorized firewall changes.\n- Temporary Disable for Malicious Operations: Temporarily disabling a firewall to allow malicious files or traffic, then re-enabling it to avoid detection.\n- Using Command-Line Tools to Stop Firewalls: Running commands like `Set-NetFirewallProfile -Enabled False on Windows or systemctl stop ufw` on Linux.\n\nThis data component can be collected through the following measures:\n\nCloud Control Plane\n\n- Azure Activity Logs:\n    - Enable logging of administrative actions, such as stopping or modifying Azure Firewall configurations.\n    - Use Azure Monitor to track specific firewall-related actions, including disabling or rule deletion.\n- AWS CloudTrail Logs:\n    - Monitor `RevokeSecurityGroupIngress` or `RevokeSecurityGroupEgress` events to detect rule changes in AWS Security Groups.\n- Google Cloud Platform Logs:\n    - Collect logs from the Firewall Rules resource in Google Cloud Operations Suite to detect rule deletions or modifications.\n\nHost-Level Firewalls\n\n- Windows Firewall Event Logs:\n    - Enable logging of firewall state changes:\n        - Security Event ID 2004: Firewall service stopped.\n        - Security Event ID 2005: Firewall service started.\n    - Use Sysmon for process creation events tied to firewall commands or scripts (Sysmon Event ID 1).\n- Linux Firewall Logs: Use auditd to track commands like iptables, firewalld, or ufw: `auditctl -a always,exit -F arch=b64 -S execve -k firewall_disable`\n- macOS Firewall: Monitor changes to the macOS Application Firewall using the log show command.\n\nNetwork-Level Monitoring\n\n- IDS/IPS Alerts: Deploy IDS/IPS systems to monitor abnormal traffic flows that could indicate firewall disablement.\n- NetFlow Data: Analyze NetFlow or packet capture data for traffic patterns inconsistent with firewall enforcement.\n\nSIEM and CSPM Tools\n\n- SIEM Integration: Use tools like Splunk or QRadar to centralize and analyze firewall disablement events from both hosts and cloud platforms.\n- Cloud Security Posture Management (CSPM): Use CSPM solutions to monitor misconfigurations and track deactivation of critical cloud services like firewalls.", "techniques": [{"domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "004", "name": "Disable or Modify System Firewall", "descr": "Monitor for changes in the status of the system firewall such as Windows Security Auditing events 5025 (The Windows firewall service has been stopped) and 5034 (The Windows firewall driver was stopped).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "Disable or Modify Cloud Firewall", "descr": "Monitor for changes in the status of the cloud firewall.", "subtechniques": [], "color": 1}], "descr": "Monitor for changes in the status of the system firewall such as Windows Security Auditing events 5025 (The Windows firewall service has been stopped) and 5034 (The Windows firewall driver was stopped)."}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Firewall Enumeration", "descr": "Querying and extracting a list of available firewalls or their associated configurations and rules. This activity can occur across host systems and cloud control planes, providing insight into the state and configuration of firewalls that protect the environment. Examples: \n\n- Querying Host-Based Firewalls: Using Windows PowerShell commands like `Get-NetFirewallRule` or Linux commands such as `iptables -L` or `firewalld --list-all`.\n- Cloud Firewall Rule Listing: Running commands like `az network firewall list` for Azure or `aws ec2 describe-security-groups` for AWS.\n- Using Management APIs: Leveraging APIs like Google Cloud Firewall's `list` API method or AWS's DescribeSecurityGroups API.\nIdentifying Misconfigurations: Extracting firewall rules to identify \u201callow all\u201d policies or rules that lack logging.\n- Enumerating with CLI Tools: Using CLI commands like `gcloud compute firewall-rules list` to extract firewall settings in Google Cloud.\n\nThis data component can be collected through the following measures:\n\nCloud Control Plane\n\n- Azure Activity Logs:Collect logs from Azure Firewall to monitor rule listing commands. Enable logging for `az network firewall` commands.\n- AWS CloudTrail: Monitor calls to `DescribeSecurityGroups` or `DescribeNetworkAcls` APIs.\nGoogle Cloud Operations Suite: Collect logs for `gcloud compute firewall-rules list` or API calls to `firewalls.list`.\n\nHost-Based Firewalls\n\n- Windows Event Logs: Use PowerShell transcription logs to capture commands like `Get-NetFirewallRule`.\n- Linux Auditd: Track executions of commands like `iptables -L` or `ufw status` using auditd: `auditctl -a always,exit -F arch=b64 -S execve -k firewall_enum`\n- macOS: Monitor logs for firewall-related queries via the Console app or log monitoring tools.\n\nSIEM Integration\n\n- Collect logs from endpoints and cloud platforms to centralize data and detect enumeration activity.\n\nEndpoint Detection and Response (EDR)\n\n- Use EDR tools to track enumeration commands or API calls performed on managed devices.\n\nCSPM Tools\n\n- Deploy Cloud Security Posture Management tools to monitor for unauthorized enumeration of firewall rules or configurations.", "techniques": [{"technique_used": true, "domain": "enterprise", "id": "T1518", "name": "Software Discovery", "descr": "Monitor for an extracted list of available firewalls and/or their associated settings/rules (ex: Azure Network Firewall CLI Show commands)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Security Software Discovery", "descr": "Monitor for an extracted list of available firewalls and/or their associated settings/rules (ex: Azure Network Firewall CLI Show commands)", "subtechniques": [], "color": 1}], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Firewall Metadata", "descr": "Contextual information about firewalls, including their configurations, policies, status, and other details such as names and associated rules. This metadata provides valuable insights into the operational state and configurations of firewalls, both in cloud control planes and host systems. Examples: \n\n- Firewall Name and Configuration: The name, type, and purpose of a firewall such as \"Azure Firewall - Production Environment.\"\n- Policy Details: Capturing firewall policy details, such as \"Allow inbound TCP 443 to web servers.\"\n- Firewall Status: Status indicators like \"Active,\" \"Disabled,\" or \"Pending Updates.\"\n- Audit Log Metadata: Log entries showing administrative changes, such as \"Policy modified by admin@domain.com.\"\n- Rules Associated with Firewalls: Rules specifying source/destination IP ranges, protocols, and ports.\n- Tagging Information: Tags like \"Environment: Production\" or \"Owner: NetworkOps.\"\n\nThis data component can be collected through the following measures:\n\nCloud Control Plane\n\n- Azure: Use Azure Activity Logs and Network Watcher to collect metadata for Azure Firewall.\n    - Example: `az network firewall show --name <firewall-name>`\n- AWS: Use AWS CloudTrail and describe commands: `aws ec2 describe-security-groups`\n- Google Cloud: Use gcloud commands to extract metadata: `gcloud compute firewall-rules list --format=json`\n\nHost-Based Firewalls\n\n- Windows: Use PowerShell to gather metadata: `Get-NetFirewallRule -PolicyStore PersistentStore`\n- Linux: Query iptables or nftables rulesets: `iptables -S`\n- macOS: Use pfctl to extract metadata: `sudo pfctl -sr`\n\nSIEM Integration\n\n- Collect logs from cloud platforms, host systems, and network appliances.\n\nAPI Monitoring\n\n- Monitor API calls for metadata requests. Example (AWS): `Capture DescribeSecurityGroups or DescribeNetworkAcls` calls via CloudTrail.\n\nEndpoint Detection and Response (EDR)\n\n- Use EDR solutions to monitor firewall management tools for configuration changes or queries.", "techniques": [{"domain": "enterprise", "id": "T1518", "name": "Software Discovery", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Security Software Discovery", "descr": "Monitor for contextual data about a firewall and activity around it such as name, policy, or status", "subtechniques": [], "color": 1}], "descr": "Monitor for contextual data about a firewall and activity around it such as name, policy, or status"}], "add_datacomponent_ref": true, "domains": ["enterprise"]}, {"name": "Firewall Rule Modification", "descr": "The creation, deletion, or alteration of firewall rules to allow or block specific network traffic. Monitoring changes to these rules is critical for detecting misconfigurations, unauthorized access, or malicious attempts to bypass network protections. Examples: \n\n- Rule Creation: Adding a new rule to allow inbound traffic on port 3389 (RDP).\n- Rule Deletion: Deleting a rule that blocks inbound traffic from untrusted IP ranges.\n- Rule Modification: Changing a rule to allow traffic from \"any\" source IP instead of a specific trusted range.\n- Audit Log Metadata: Logs indicating \"Firewall rule modified by admin@domain.com.\"\n- Platform-Specific Scenarios\n    - Azure: Altering rules in an Azure Network Security Group (NSG).\n    - AWS: Modifying Security Group rules to allow traffic.\n    - Windows: Changes tracked in Security Event Logs (EID 4950 or 4951).\n\nThis data component can be collected through the following measures:\n\nCloud Control Plane\n\n- Azure: Collect rule modification logs from Azure Firewall Activity Logs.\n    - Example Command: `az network firewall policy rule-collection-group rule-collection list --policy-name <policy-name>`\n- AWS: Use CloudTrail to track `AuthorizeSecurityGroupIngress` or `RevokeSecurityGroupIngress` actions.\n    Example: `aws ec2 describe-security-groups`\n- Google Cloud: Use gcloud commands to extract firewall rules: `gcloud compute firewall-rules list --format=json`\n\nHost-Based Firewalls\n\n- Windows: \n    - Collect events from the Windows Security Event Log (EID 4950: A rule has been modified).\n    - Use PowerShell to track rule changes: `Get-NetFirewallRule -PolicyStore PersistentStore`\n- Linux:\n    - Monitor iptables or nftables rule modifications: `iptables -L -v`\n    - Use auditd for real-time monitoring: `auditctl -w /etc/iptables.rules -p wa`\n- macOS: Use pfctl to monitor rule changes: `sudo pfctl -sr`\n\nSIEM Integration\n\n- Collect logs from cloud platforms, host systems, and network appliances for centralized monitoring.\n\nAPI Monitoring\n\n- Monitor API calls for firewall rule modifications.", "techniques": [{"domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "004", "name": "Disable or Modify System Firewall", "descr": "Monitor for changes made to firewall rules that might allow remote communication over protocols such as SMD and RDP. Modification of firewall rules might also consider opening local ports and services for different network profiles such as public and domain.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "Disable or Modify Cloud Firewall", "descr": "Monitor cloud logs for modification or creation of new security groups or firewall rules. For example, in AWS environments, monitor for the `AuthorizeSecurityGroupIngress` API call in CloudTrail and use AWS Config to monitor changes the configuration of a Virtual Private Cloud (VPC) Security Group.(Citation: AWS Monitor API Calls to EC2 Security Groups)\n\nAnalytic 1 - Operations performed by unexpected initiators, unusual rule names, frequent modifications\n\n<code>index=\"azure_activity_logs\" OperationName=\"Create or Update Security Rule\"\n| stats count by InitiatorName, Resource\n| where Resource LIKE \"Microsoft.Network/networkSecurityGroups/securityRules\" AND (Status!=\"Succeeded\" OR InitiatorName!=\"expected_initiator\")\n| sort by Time </code>", "subtechniques": [], "color": 1}], "descr": "Monitor for changes made to firewall rules for unexpected modifications to allow/block specific network traffic that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms."}, {"technique_used": true, "domain": "enterprise", "id": "T1070", "name": "Indicator Removal", "descr": "Monitor for changes made to firewall rules, especially unexpected modifications that may potentially be related to allowing and/or cleaning up previous tampering that enabled malicious network traffic.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "007", "name": "Clear Network Connection History and Configurations", "descr": "Monitor for changes made to firewall rules, especially unexpected modifications that may potentially be related to allowing and/or cleaning up previous tampering that enabled malicious network traffic.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1669", "name": "Wi-Fi Networks", "descr": "Monitor for changes made to firewall rules for unexpected modifications to allow specific network traffic that may maliciously modify components of a victim environment in order to move laterally.", "subtechniques": [], "color": 1}], "add_datacomponent_ref": true, "domains": ["enterprise"]}], "citations": {"current_number": 0, "AWS Sec Groups VPC": {"description": "Amazon. (n.d.). Security groups for your VPC. Retrieved October 13, 2021.", "url": "https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html", "number": null}, "AWS Monitor API Calls to EC2 Security Groups": {"description": "Jeff Levine. (2017, January 3). How to Monitor AWS Account Configuration Changes and API Calls to Amazon EC2 Security Groups. Retrieved September 24, 2024.", "url": "https://aws.amazon.com/blogs/security/how-to-monitor-aws-account-configuration-changes-and-api-calls-to-amazon-ec2-security-groups/", "number": null}}, "versioning_feature": false}