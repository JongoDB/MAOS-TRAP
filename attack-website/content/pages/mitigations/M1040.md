Title: Behavior Prevention on Endpoint-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1040/index.html
data: {"attack_id": "M1040", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": null, "children": [{"name": "Enterprise", "id": "enterprise", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M1057/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M1060/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Pre-compromise", "id": "Pre-compromise", "path": "/mitigations/M1056/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Mobile", "id": "mobile", "path": "/mitigations/mobile/", "children": [{"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1058/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Attestation", "id": "Attestation", "path": "/mitigations/M1002/", "children": []}, {"name": "Deploy Compromised Device Detection Method", "id": "Deploy Compromised Device Detection Method", "path": "/mitigations/M1010/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1059/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M1009/", "children": []}, {"name": "Enterprise Policy", "id": "Enterprise Policy", "path": "/mitigations/M1012/", "children": []}, {"name": "Interconnection Filtering", "id": "Interconnection Filtering", "path": "/mitigations/M1014/", "children": []}, {"name": "Lock Bootloader", "id": "Lock Bootloader", "path": "/mitigations/M1003/", "children": []}, {"name": "Security Updates", "id": "Security Updates", "path": "/mitigations/M1001/", "children": []}, {"name": "System Partition Integrity", "id": "System Partition Integrity", "path": "/mitigations/M1004/", "children": []}, {"name": "Use Recent OS Version", "id": "Use Recent OS Version", "path": "/mitigations/M1006/", "children": []}, {"name": "User Guidance", "id": "User Guidance", "path": "/mitigations/M1011/", "children": []}]}, {"name": "ICS", "id": "ics", "path": "/mitigations/ics/", "children": [{"name": "Access Management", "id": "Access Management", "path": "/mitigations/M0801/", "children": []}, {"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M0936/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M0915/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M0949/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M0913/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M0948/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M0947/", "children": []}, {"name": "Authorization Enforcement", "id": "Authorization Enforcement", "path": "/mitigations/M0800/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M0946/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M0945/", "children": []}, {"name": "Communication Authenticity", "id": "Communication Authenticity", "path": "/mitigations/M0802/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M0953/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M0803/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M0942/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M0808/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M0941/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M0938/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M0950/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M0937/", "children": []}, {"name": "Human User Authentication", "id": "Human User Authentication", "path": "/mitigations/M0804/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M0935/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M0934/", "children": []}, {"name": "Mechanical Protection Layers", "id": "Mechanical Protection Layers", "path": "/mitigations/M0805/", "children": []}, {"name": "Minimize Wireless Signal Propagation", "id": "Minimize Wireless Signal Propagation", "path": "/mitigations/M0806/", "children": []}, {"name": "Mitigation Limited or Not Effective", "id": "Mitigation Limited or Not Effective", "path": "/mitigations/M0816/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M0932/", "children": []}, {"name": "Network Allowlists", "id": "Network Allowlists", "path": "/mitigations/M0807/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M0931/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M0930/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M0928/", "children": []}, {"name": "Operational Information Confidentiality", "id": "Operational Information Confidentiality", "path": "/mitigations/M0809/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M0810/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M0927/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M0926/", "children": []}, {"name": "Redundancy of Service", "id": "Redundancy of Service", "path": "/mitigations/M0811/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M0922/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M0944/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M0924/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M0921/", "children": []}, {"name": "Safety Instrumented Systems", "id": "Safety Instrumented Systems", "path": "/mitigations/M0812/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M0954/", "children": []}, {"name": "Software Process and Device Authentication", "id": "Software Process and Device Authentication", "path": "/mitigations/M0813/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M0920/", "children": []}, {"name": "Static Network Configuration", "id": "Static Network Configuration", "path": "/mitigations/M0814/", "children": []}, {"name": "Supply Chain Management", "id": "Supply Chain Management", "path": "/mitigations/M0817/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M0919/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M0951/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M0918/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M0917/", "children": []}, {"name": "Validate Program Inputs", "id": "Validate Program Inputs", "path": "/mitigations/M0818/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M0916/", "children": []}, {"name": "Watchdog Timers", "id": "Watchdog Timers", "path": "/mitigations/M0815/", "children": []}]}]}, "name": "Behavior Prevention on Endpoint", "notes": null, "created": "11 June 2019", "modified": "10 December 2024", "descr": "Behavior Prevention on Endpoint refers to the use of technologies and strategies to detect and block potentially malicious activities by analyzing the behavior of processes, files, API calls, and other endpoint events. Rather than relying solely on known signatures, this approach leverages heuristics, machine learning, and real-time monitoring to identify anomalous patterns indicative of an attack. This mitigation can be implemented through the following measures:\n\nSuspicious Process Behavior:\n\n- Implementation: Use Endpoint Detection and Response (EDR) tools to monitor and block processes exhibiting unusual behavior, such as privilege escalation attempts.\n- Use Case: An attacker uses a known vulnerability to spawn a privileged process from a user-level application. The endpoint tool detects the abnormal parent-child process relationship and blocks the action.\n\nUnauthorized File Access:\n\n- Implementation: Leverage Data Loss Prevention (DLP) or endpoint tools to block processes attempting to access sensitive files without proper authorization.\n- Use Case: A process tries to read or modify a sensitive file located in a restricted directory, such as /etc/shadow on Linux or the SAM registry hive on Windows. The endpoint tool identifies this anomalous behavior and prevents it.\n\nAbnormal API Calls:\n\n- Implementation: Implement runtime analysis tools to monitor API calls and block those associated with malicious activities.\n- Use Case: A process dynamically injects itself into another process to hijack its execution. The endpoint detects the abnormal use of APIs like `OpenProcess` and `WriteProcessMemory` and terminates the offending process.\n\nExploit Prevention:\n\n- Implementation: Use behavioral exploit prevention tools to detect and block exploits attempting to gain unauthorized access.\n- Use Case: A buffer overflow exploit is launched against a vulnerable application. The endpoint detects the anomalous memory write operation and halts the process.", "version": "1.1", "techniques_addressed_data": [{"domain": "enterprise", "id": "T1059", "name": "Command and Scripting Interpreter", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Visual Basic", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent [Visual Basic](https://attack.mitre.org/techniques/T1059/005) scripts from executing potentially malicious downloaded content (Citation: win10_asr).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "JavaScript", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent [JavaScript](https://attack.mitre.org/techniques/T1059/007) scripts from executing potentially malicious downloaded content (Citation: win10_asr).", "subtechniques": [], "color": 1}], "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent [Visual Basic](https://attack.mitre.org/techniques/T1059/005) and [JavaScript](https://attack.mitre.org/techniques/T1059/007) scripts from executing potentially malicious downloaded content (Citation: win10_asr)."}, {"domain": "enterprise", "id": "T1543", "name": "Create or Modify System Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Windows Service", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent an application from writing a signed vulnerable driver to the system.(Citation: Malicious Driver Reporting Center) On Windows 10 and 11, enable Microsoft Vulnerable Driver Blocklist to assist in hardening against third party-developed service drivers.(Citation: Microsoft driver block rules)  ", "subtechniques": [], "color": 1}], "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent an application from writing a signed vulnerable driver to the system.(Citation: Malicious Driver Reporting Center) On Windows 10 and 11, enable Microsoft Vulnerable Driver Blocklist to assist in hardening against third party-developed drivers.(Citation: Microsoft driver block rules)  "}, {"technique_used": true, "domain": "enterprise", "id": "T1486", "name": "Data Encrypted for Impact", "descr": "On Windows 10, enable cloud-delivered protection and Attack Surface Reduction (ASR) rules to block the execution of files that resemble ransomware.(Citation: win10_asr) In AWS environments, create an IAM policy to restrict or block the use of SSE-C on S3 buckets.(Citation: Halcyon AWS Ransomware 2025)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1006", "name": "Direct Volume Access", "descr": "Some endpoint security solutions can be configured to block some types of behaviors related to efforts by an adversary to create backups, such as command execution or preventing API calls to backup related services.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1546", "name": "Event Triggered Execution", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Windows Management Instrumentation Event Subscription", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent malware from abusing WMI to attain persistence.(Citation: win10_asr)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1564", "name": "Hide Artifacts", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "014", "name": "Extended Attributes", "descr": "During artifact review, packaging, or deployment stages, scan extended attributes alongside file contents to detect hidden payloads, obfuscated data, or suspicious attribute keys that may indicate malicious behavior.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1574", "name": "Hijack Execution Flow", "descr": "Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions).", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "013", "name": "KernelCallbackTable", "descr": "Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions).", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1559", "name": "Inter-Process Communication", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Dynamic Data Exchange", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.(Citation: Microsoft ASR Nov 2017)(Citation: Enigma Reviving DDE Jan 2018)", "subtechniques": [], "color": 1}], "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.(Citation: Microsoft ASR Nov 2017)(Citation: Enigma Reviving DDE Jan 2018)"}, {"domain": "enterprise", "id": "T1036", "name": "Masquerading", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "008", "name": "Masquerade File Type", "descr": "Implement security controls on the endpoint, such as a Host Intrusion Prevention System (HIPS), to identify and prevent execution of files with mismatching file signatures.", "subtechniques": [], "color": 1}], "descr": "Implement security controls on the endpoint, such as a Host Intrusion Prevention System (HIPS), to identify and prevent execution of potentially malicious files (such as those with mismatching file signatures)."}, {"technique_used": true, "domain": "enterprise", "id": "T1106", "name": "Native API", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office VBA macros from calling Win32 APIs. (Citation: win10_asr)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1027", "name": "Obfuscated Files or Information", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "009", "name": "Embedded Payloads", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent execution of potentially obfuscated scripts.(Citation: win10_asr)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "010", "name": "Command Obfuscation", "descr": "On Windows 10+, enable Attack Surface Reduction (ASR) rules to block execution of potentially obfuscated scripts.(Citation: Microsoft ASR Obfuscation)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "012", "name": "LNK Icon Smuggling", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent execution of potentially obfuscated scripts or payloads.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "013", "name": "Encrypted/Encoded File", "descr": "On Windows 10+, enable Attack Surface Reduction (ASR) rules to block execution of potentially obfuscated scripts.(Citation: Obfuscated scripts)\n\nSecurity tools should be configured to analyze the encoding properties of files and detect anomalies that deviate from standard encoding practices.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "014", "name": "Polymorphic Code", "descr": "On Windows 10+, enable Attack Surface Reduction (ASR) rules to prevent execution of potentially obfuscated payloads", "subtechniques": [], "color": 1}], "descr": "On Windows 10+, enable Attack Surface Reduction (ASR) rules to prevent execution of potentially obfuscated payloads. (Citation: win10_asr)"}, {"domain": "enterprise", "id": "T1137", "name": "Office Application Startup", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Office Template Macros", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Office Test", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Outlook Forms", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Outlook Home Page", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Outlook Rules", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Add-ins", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)", "subtechniques": [], "color": 1}], "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)"}, {"technique_used": true, "domain": "enterprise", "id": "T1003", "name": "OS Credential Dumping", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing. (Citation: win10_asr)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "LSASS Memory", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing. (Citation: win10_asr)", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1055", "name": "Process Injection", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Dynamic-link Library Injection", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Portable Executable Injection", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Thread Execution Hijacking", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Asynchronous Procedure Call", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Thread Local Storage", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Ptrace System Calls", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "009", "name": "Proc Memory", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "011", "name": "Extra Window Memory Injection", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "012", "name": "Process Hollowing", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "013", "name": "Process Doppelg\u00e4nging", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "014", "name": "VDSO Hijacking", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "015", "name": "ListPlanting", "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process.", "subtechniques": [], "color": 1}], "descr": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. For example, on Windows 10, Attack Surface Reduction (ASR) rules may prevent Office applications from code injection. (Citation: win10_asr)"}, {"technique_used": true, "domain": "enterprise", "id": "T1091", "name": "Replication Through Removable Media", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block unsigned/untrusted executable files (such as .exe, .dll, or .scr) from running from USB removable drives. (Citation: win10_asr)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1216", "name": "System Script Proxy Execution", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "PubPrn", "descr": "On Windows 10, update Windows Defender Application Control policies to include rules that block the older, vulnerable versions of PubPrn.(Citation: Microsoft_rec_block_rules)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1569", "name": "System Services", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Service Execution", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by [PsExec](https://attack.mitre.org/software/S0029) from running. (Citation: win10_asr)", "subtechniques": [], "color": 1}], "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by [PsExec](https://attack.mitre.org/software/S0029) from running. (Citation: win10_asr)"}, {"technique_used": true, "domain": "enterprise", "id": "T1204", "name": "User Execution", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent executable files from running unless they meet a prevalence, age, or trusted list criteria and to prevent Office applications from creating potentially malicious executable content by blocking malicious code from being written to disk. Note: cloud-delivered protection must be enabled to use certain rules. (Citation: win10_asr)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Malicious File", "descr": "On Windows 10, various Attack Surface Reduction (ASR) rules can be enabled to prevent the execution of potentially malicious executable files (such as those that have been downloaded and executed by Office applications/scripting interpreters/email clients or that do not meet specific prevalence, age, or trusted list criteria). Note: cloud-delivered protection must be enabled for certain rules. (Citation: win10_asr)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1047", "name": "Windows Management Instrumentation", "descr": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by WMI commands from running. Note: many legitimate tools and applications utilize WMI for command execution. (Citation: win10_asr)", "subtechniques": [], "color": 1}], "layers": [{"domain": "enterprise", "name": "Enterprise", "filename": "M1040-enterprise-layer.json", "navigator_link": "https://mitre-attack.github.io/attack-navigator/"}], "citations": {"current_number": 0, "Malicious Driver Reporting Center": {"description": "Azure Edge and Platform Security Team & Microsoft 365 Defender Research Team. (2021, December 8). Improve kernel security with the new Microsoft Vulnerable and Malicious Driver Reporting Center. Retrieved April 6, 2022.", "url": "https://www.microsoft.com/security/blog/2021/12/08/improve-kernel-security-with-the-new-microsoft-vulnerable-and-malicious-driver-reporting-center/", "number": null}, "Microsoft driver block rules": {"description": "Jordan Geurten et al. . (2022, March 29). Microsoft recommended driver block rules. Retrieved April 7, 2022.", "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules", "number": null}, "win10_asr": {"description": "Microsoft. (2021, July 2). Use attack surface reduction rules to prevent malware infection. Retrieved June 24, 2021.", "url": "https://docs.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction", "number": null}, "Microsoft ASR Obfuscation": {"description": "Microsoft. (2023, February 22). Attack surface reduction (ASR) rules reference: Block execution of potentially obfuscated scripts. Retrieved March 17, 2023.", "url": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference#block-execution-of-potentially-obfuscated-scripts", "number": null}, "Microsoft ASR Nov 2017": {"description": "Brower, N. & D'Souza-Wiltshire, I. (2017, November 9). Enable Attack surface reduction. Retrieved February 3, 2018.", "url": "https://docs.microsoft.com/windows/threat-protection/windows-defender-exploit-guard/enable-attack-surface-reduction", "number": null}, "Enigma Reviving DDE Jan 2018": {"description": "Nelson, M. (2018, January 29). Reviving DDE: Using OneNote and Excel for Code Execution. Retrieved February 3, 2018.", "url": "https://posts.specterops.io/reviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee", "number": null}, "Microsoft_rec_block_rules": {"description": "Microsoft. (2021, August 23). Retrieved August 16, 2021.", "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules", "number": null}, "Halcyon AWS Ransomware 2025": {"description": "Halcyon RISE Team. (2025, January 13). Abusing AWS Native Services: Ransomware Encrypting S3 Buckets with SSE-C. Retrieved March 18, 2025.", "url": "https://www.halcyon.ai/blog/abusing-aws-native-services-ransomware-encrypting-s3-buckets-with-sse-c", "number": null}, "Obfuscated scripts": {"description": "Microsoft. (2024, March 4). Attack surface reduction rules reference. Retrieved March 29, 2024.", "url": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?view=o365-worldwide#block-execution-of-potentially-obfuscated-scripts", "number": null}}, "versioning_feature": false}