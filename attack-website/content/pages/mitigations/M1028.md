Title: Operating System Configuration-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1028/index.html
data: {"attack_id": "M1028", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": null, "children": [{"name": "Enterprise", "id": "enterprise", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M1057/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M1060/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Pre-compromise", "id": "Pre-compromise", "path": "/mitigations/M1056/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Mobile", "id": "mobile", "path": "/mitigations/mobile/", "children": [{"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1058/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Attestation", "id": "Attestation", "path": "/mitigations/M1002/", "children": []}, {"name": "Deploy Compromised Device Detection Method", "id": "Deploy Compromised Device Detection Method", "path": "/mitigations/M1010/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1059/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M1009/", "children": []}, {"name": "Enterprise Policy", "id": "Enterprise Policy", "path": "/mitigations/M1012/", "children": []}, {"name": "Interconnection Filtering", "id": "Interconnection Filtering", "path": "/mitigations/M1014/", "children": []}, {"name": "Lock Bootloader", "id": "Lock Bootloader", "path": "/mitigations/M1003/", "children": []}, {"name": "Security Updates", "id": "Security Updates", "path": "/mitigations/M1001/", "children": []}, {"name": "System Partition Integrity", "id": "System Partition Integrity", "path": "/mitigations/M1004/", "children": []}, {"name": "Use Recent OS Version", "id": "Use Recent OS Version", "path": "/mitigations/M1006/", "children": []}, {"name": "User Guidance", "id": "User Guidance", "path": "/mitigations/M1011/", "children": []}]}, {"name": "ICS", "id": "ics", "path": "/mitigations/ics/", "children": [{"name": "Access Management", "id": "Access Management", "path": "/mitigations/M0801/", "children": []}, {"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M0936/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M0915/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M0949/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M0913/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M0948/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M0947/", "children": []}, {"name": "Authorization Enforcement", "id": "Authorization Enforcement", "path": "/mitigations/M0800/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M0946/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M0945/", "children": []}, {"name": "Communication Authenticity", "id": "Communication Authenticity", "path": "/mitigations/M0802/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M0953/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M0803/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M0942/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M0808/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M0941/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M0938/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M0950/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M0937/", "children": []}, {"name": "Human User Authentication", "id": "Human User Authentication", "path": "/mitigations/M0804/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M0935/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M0934/", "children": []}, {"name": "Mechanical Protection Layers", "id": "Mechanical Protection Layers", "path": "/mitigations/M0805/", "children": []}, {"name": "Minimize Wireless Signal Propagation", "id": "Minimize Wireless Signal Propagation", "path": "/mitigations/M0806/", "children": []}, {"name": "Mitigation Limited or Not Effective", "id": "Mitigation Limited or Not Effective", "path": "/mitigations/M0816/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M0932/", "children": []}, {"name": "Network Allowlists", "id": "Network Allowlists", "path": "/mitigations/M0807/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M0931/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M0930/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M0928/", "children": []}, {"name": "Operational Information Confidentiality", "id": "Operational Information Confidentiality", "path": "/mitigations/M0809/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M0810/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M0927/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M0926/", "children": []}, {"name": "Redundancy of Service", "id": "Redundancy of Service", "path": "/mitigations/M0811/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M0922/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M0944/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M0924/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M0921/", "children": []}, {"name": "Safety Instrumented Systems", "id": "Safety Instrumented Systems", "path": "/mitigations/M0812/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M0954/", "children": []}, {"name": "Software Process and Device Authentication", "id": "Software Process and Device Authentication", "path": "/mitigations/M0813/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M0920/", "children": []}, {"name": "Static Network Configuration", "id": "Static Network Configuration", "path": "/mitigations/M0814/", "children": []}, {"name": "Supply Chain Management", "id": "Supply Chain Management", "path": "/mitigations/M0817/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M0919/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M0951/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M0918/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M0917/", "children": []}, {"name": "Validate Program Inputs", "id": "Validate Program Inputs", "path": "/mitigations/M0818/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M0916/", "children": []}, {"name": "Watchdog Timers", "id": "Watchdog Timers", "path": "/mitigations/M0815/", "children": []}]}]}, "name": "Operating System Configuration", "notes": null, "created": "06 June 2019", "modified": "18 December 2024", "descr": "Operating System Configuration involves adjusting system settings and hardening the default configurations of an operating system (OS) to mitigate adversary exploitation and prevent abuse of system functionality. Proper OS configurations address security vulnerabilities, limit attack surfaces, and ensure robust defense against a wide range of techniques. This mitigation can be implemented through the following measures: \n\nDisable Unused Features:\n\n- Turn off SMBv1, LLMNR, and NetBIOS where not needed.\n- Disable remote registry and unnecessary services.\n\nEnforce OS-level Protections:\n\n- Enable Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Control Flow Guard (CFG) on Windows.\n- Use AppArmor or SELinux on Linux for mandatory access controls.\n\nSecure Access Settings:\n\n- Enable User Account Control (UAC) for Windows.\n- Restrict root/sudo access on Linux/macOS and enforce strong permissions using sudoers files.\n\nFile System Hardening:\n\n- Implement least-privilege access for critical files and system directories.\n- Audit permissions regularly using tools like icacls (Windows) or getfacl/chmod (Linux/macOS).\n\nSecure Remote Access:\n\n- Restrict RDP, SSH, and VNC to authorized IPs using firewall rules.\n- Enable NLA for RDP and enforce strong password/lockout policies.\n\nHarden Boot Configurations:\n\n- Enable Secure Boot and enforce UEFI/BIOS password protection.\n- Use BitLocker or LUKS to encrypt boot drives.\n\nRegular Audits:\n\n- Periodically audit OS configurations using tools like CIS Benchmarks or SCAP tools.\n\n*Tools for Implementation*\n\nWindows:\n\n- Microsoft Group Policy Objects (GPO): Centrally enforce OS security settings.\n- Windows Defender Exploit Guard: Built-in OS protection against exploits.\n- CIS-CAT Pro: Audit Windows security configurations based on CIS Benchmarks.\n\nLinux/macOS:\n\n- AppArmor/SELinux: Enforce mandatory access controls.\n- Lynis: Perform comprehensive security audits.\n- SCAP Security Guide: Automate configuration hardening using Security Content Automation Protocol.\n\nCross-Platform:\n\n- Ansible or Chef/Puppet: Automate configuration hardening at scale.\n- OpenSCAP: Perform compliance and configuration checks.", "version": "1.3", "techniques_addressed_data": [{"domain": "enterprise", "id": "T1548", "name": "Abuse Elevation Control Mechanism", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Setuid and Setgid", "descr": "Applications with known vulnerabilities or known shell escapes should not have the setuid or setgid bits set to reduce potential damage if an application is compromised. Additionally, the number of programs with setuid or setgid bits set should be minimized across a system.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Sudo and Sudo Caching", "descr": "Ensuring that the <code>tty_tickets</code> setting is enabled will prevent this leakage across tty sessions.", "subtechniques": [], "color": 1}], "descr": "Applications with known vulnerabilities or known shell escapes should not have the setuid or setgid bits set to reduce potential damage if an application is compromised. Additionally, the number of programs with setuid or setgid bits set should be minimized across a system. Ensuring that the sudo tty_tickets setting is enabled will prevent this leakage across tty sessions."}, {"domain": "enterprise", "id": "T1087", "name": "Account Discovery", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Local Account", "descr": "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located at <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts on elevation.(Citation: UCF STIG Elevation Account Enumeration)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Domain Account", "descr": "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located at <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts on elevation.(Citation: UCF STIG Elevation Account Enumeration)", "subtechniques": [], "color": 1}], "descr": "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: E numerate administrator accounts on elevation. (Citation: UCF STIG Elevation Account Enumeration)"}, {"technique_used": true, "domain": "enterprise", "id": "T1098", "name": "Account Manipulation", "descr": "Protect domain controllers by ensuring proper security configuration for critical servers to limit access by potentially unnecessary protocols and services, such as SMB file sharing.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1197", "name": "BITS Jobs", "descr": "\nConsider reducing the default BITS job lifetime in Group Policy or by editing the <code>JobInactivityTimeout</code> and <code>MaxDownloadTime</code> Registry values in <code> HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\BITS</code>.(Citation: Microsoft BITS)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1092", "name": "Communication Through Removable Media", "descr": "Disallow or restrict removable media at an organizational policy level if they are not required for business operations.(Citation: TechNet Removable Media Control)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1136", "name": "Create Account", "descr": "Protect domain controllers by ensuring proper security configuration for critical servers.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Domain Account", "descr": "Protect domain controllers by ensuring proper security configuration for critical servers.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1543", "name": "Create or Modify System Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Windows Service", "descr": "Ensure that Driver Signature Enforcement is enabled to restrict unsigned drivers from being installed. ", "subtechniques": [], "color": 1}], "descr": "Ensure that Driver Signature Enforcement is enabled to restrict unsigned drivers from being installed. "}, {"domain": "enterprise", "id": "T1546", "name": "Event Triggered Execution", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "008", "name": "Accessibility Features", "descr": "To use this technique remotely, an adversary must use it in conjunction with RDP. Ensure that Network Level Authentication is enabled to force the remote desktop session to authenticate before the session is created and the login screen displayed. It is enabled by default on Windows Vista and later.(Citation: TechNet RDP NLA)", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1011", "name": "Exfiltration Over Other Network Medium", "descr": "Prevent the creation of new network adapters where possible.(Citation: Microsoft GPO Bluetooth FEB 2009)(Citation: TechRepublic Wireless GPO FEB 2009)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration Over Bluetooth", "descr": "Prevent the creation of new network adapters where possible.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1564", "name": "Hide Artifacts", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Hidden Users", "descr": "If the computer is domain joined, then group policy can help restrict the ability to create or hide users. Similarly, preventing the modification of the <code>/Library/Preferences/com.apple.loginwindow</code> <code>Hide500Users</code> value will force all users to be visible.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1574", "name": "Hijack Execution Flow", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "Dynamic Linker Hijacking", "descr": "When System Integrity Protection (SIP) is enabled in macOS, the aforementioned environment variables are ignored when executing protected binaries. Third-party applications can also leverage Apple\u2019s Hardened Runtime, ensuring these environment variables are subject to imposed restrictions.(Citation: Apple Developer Doco Hardened Runtime) Admins can add restrictions to applications by setting the setuid and/or setgid bits, use entitlements, or have a __RESTRICT segment in the Mach-O binary.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Impair Command History Logging", "descr": "Make sure that the <code>HISTCONTROL</code> environment variable is set to \u201cignoredups\u201d instead of \u201cignoreboth\u201d or \u201cignorespace\u201d.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1490", "name": "Inhibit System Recovery", "descr": "Consider technical controls to prevent the disabling of services or deletion of files involved in system recovery. Additionally, ensure that WinRE is enabled using the following command: <code>reagentc /enable</code>.(Citation: reagentc_cmd)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1036", "name": "Masquerading", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "007", "name": "Double File Extension", "descr": "Disable the default to \u201chide file extensions for known file types\u201d in Windows OS.(Citation: Seqrite DoubleExtension)(Citation: HowToGeek ShowExtension)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1556", "name": "Modify Authentication Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Password Filter DLL", "descr": "Ensure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (C:\\Windows\\System32\\ by default) of a domain controller and/or local computer with a corresponding entry in HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Network Provider DLL", "descr": "Starting in Windows 11 22H2, the `EnableMPRNotifications` policy can be disabled through Group Policy or through a configuration service provider to prevent Winlogon from sending credentials to network providers.(Citation: EnableMPRNotifications)", "subtechniques": [], "color": 1}], "descr": "Ensure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (`C:\\Windows\\System32\\` by default) of a domain controller and/or local computer with a corresponding entry in `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages`. \n\nStarting in Windows 11 22H2, the `EnableMPRNotifications` policy can be disabled through Group Policy or through a configuration service provider to prevent Winlogon from sending credentials to network providers.(Citation: EnableMPRNotifications)"}, {"technique_used": true, "domain": "enterprise", "id": "T1135", "name": "Network Share Discovery", "descr": "Enable Windows Group Policy \u201cDo Not Allow Anonymous Enumeration of SAM Accounts and Shares\u201d security setting to limit users who can enumerate network shares.(Citation: Windows Anonymous Enumeration of SAM Accounts)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1003", "name": "OS Credential Dumping", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "LSASS Memory", "descr": "Consider disabling or restricting NTLM.(Citation: Microsoft Disable NTLM Nov 2012) Consider disabling WDigest authentication.(Citation: Microsoft WDigest Mit)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Security Account Manager", "descr": "Consider disabling or restricting NTLM.(Citation: Microsoft Disable NTLM Nov 2012)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Cached Domain Credentials", "descr": "Consider limiting the number of cached credentials (HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Current Version\\Winlogon\\cachedlogonscountvalue)(Citation: Tilbury Windows Credentials)", "subtechniques": [], "color": 1}], "descr": "\nConsider disabling or restricting NTLM.(Citation: Microsoft Disable NTLM Nov 2012) Consider disabling WDigest authentication.(Citation: Microsoft WDigest Mit)"}, {"domain": "enterprise", "id": "T1542", "name": "Pre-OS Boot", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "TFTP Boot", "descr": "Follow vendor device hardening best practices to disable unnecessary and unused features and services, avoid using default configurations and passwords, and introduce logging and auditing for detection.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1563", "name": "Remote Service Session Hijacking", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "RDP Hijacking", "descr": "Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.(Citation: Windows RDP Sessions)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1021", "name": "Remote Services", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Remote Desktop Protocol", "descr": "Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.(Citation: Windows RDP Sessions)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1053", "name": "Scheduled Task/Job", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "At", "descr": "Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled. (Citation: TechNet Server Operator Scheduled Task) ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Scheduled Task", "descr": "Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled. (Citation: TechNet Server Operator Scheduled Task)", "subtechniques": [], "color": 1}], "descr": "Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled. (Citation: TechNet Server Operator Scheduled Task)"}, {"technique_used": true, "domain": "enterprise", "id": "T1553", "name": "Subvert Trust Controls", "descr": "Windows Group Policy can be used to manage root certificates and the <code>Flags</code> value of <code>HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\ProtectedRoots</code> can be set to 1 to prevent non-administrator users from making further root installations into their own HKCU certificate store. (Citation: SpectorOps Code Signing Dec 2017)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "004", "name": "Install Root Certificate", "descr": "Windows Group Policy can be used to manage root certificates and the <code>Flags</code> value of <code>HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\ProtectedRoots</code> can be set to 1 to prevent non-administrator users from making further root installations into their own HKCU certificate store. (Citation: SpectorOps Code Signing Dec 2017)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1552", "name": "Unsecured Credentials", "descr": "There are multiple methods of preventing a user's command history from being flushed to their .bash_history file, including use of the following commands:\n<code>set +o history</code> and <code>set -o history</code> to start logging again;\n<code>unset HISTFILE</code> being added to a user's .bash_rc file; and\n<code>ln -s /dev/null ~/.bash_history</code> to write commands to <code>/dev/null</code>instead.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Bash History", "descr": "There are multiple methods of preventing a user's command history from being flushed to their .bash_history file, including use of the following commands:\n<code>set +o history</code> and <code>set -o history</code> to start logging again;\n<code>unset HISTFILE</code> being added to a user's .bash_rc file; and\n<code>ln -s /dev/null ~/.bash_history</code> to write commands to <code>/dev/null</code>instead.", "subtechniques": [], "color": 1}], "color": 1}], "layers": [{"domain": "enterprise", "name": "Enterprise", "filename": "M1028-enterprise-layer.json", "navigator_link": "https://mitre-attack.github.io/attack-navigator/"}], "citations": {"current_number": 0, "Apple Developer Doco Hardened Runtime": {"description": "Apple Inc.. (2021, January 1). Hardened Runtime: Manage security protections and resource access for your macOS apps.. Retrieved March 24, 2021.", "url": "https://developer.apple.com/documentation/security/hardened_runtime", "number": null}, "UCF STIG Elevation Account Enumeration": {"description": "UCF. (n.d.). The system must require username and password to elevate a running application.. Retrieved December 18, 2017.", "url": "https://www.stigviewer.com/stig/microsoft_windows_server_2012_member_server/2013-07-25/finding/WN12-CC-000077", "number": null}, "SpectorOps Code Signing Dec 2017": {"description": "Graeber, M. (2017, December 22). Code Signing Certificate Cloning Attacks and Defenses. Retrieved April 3, 2018.", "url": "https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec", "number": null}, "TechNet Server Operator Scheduled Task": {"description": "Microsoft. (2012, November 15). Domain controller: Allow server operators to schedule tasks. Retrieved December 18, 2017.", "url": "https://technet.microsoft.com/library/jj852168.aspx", "number": null}, "Windows RDP Sessions": {"description": "Microsoft. (n.d.). Configure Timeout and Reconnection Settings for Remote Desktop Services Sessions. Retrieved December 11, 2017.", "url": "https://technet.microsoft.com/en-us/library/cc754272(v=ws.11).aspx", "number": null}, "Microsoft Disable NTLM Nov 2012": {"description": "Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017.", "url": "https://technet.microsoft.com/library/jj865668.aspx", "number": null}, "Microsoft WDigest Mit": {"description": "Microsoft. (2014, May 13). Microsoft Security Advisory: Update to improve credentials protection and management. Retrieved June 8, 2020.", "url": "https://support.microsoft.com/en-us/help/2871997/microsoft-security-advisory-update-to-improve-credentials-protection-a", "number": null}, "Microsoft BITS": {"description": "Microsoft. (n.d.). Background Intelligent Transfer Service. Retrieved January 12, 2018.", "url": "https://msdn.microsoft.com/library/windows/desktop/bb968799.aspx", "number": null}, "Microsoft GPO Bluetooth FEB 2009": {"description": "Microsoft. (2009, February 9). Disabling Bluetooth and Infrared Beaming. Retrieved July 26, 2018.", "url": "https://technet.microsoft.com/library/dd252791.aspx", "number": null}, "TechRepublic Wireless GPO FEB 2009": {"description": "Schauland, D. (2009, February 24). Configuring Wireless settings via Group Policy. Retrieved July 26, 2018.", "url": "https://www.techrepublic.com/blog/data-center/configuring-wireless-settings-via-group-policy/", "number": null}, "Tilbury Windows Credentials": {"description": "Chad Tilbury. (2017, August 8). 1Windows Credentials: Attack, Mitigation, Defense. Retrieved February 21, 2020.", "url": "https://www.first.org/resources/papers/conf2017/Windows-Credentials-Attacks-and-Mitigation-Techniques.pdf", "number": null}, "Windows Anonymous Enumeration of SAM Accounts": {"description": "Microsoft. (2017, April 19). Network access: Do not allow anonymous enumeration of SAM accounts and shares. Retrieved May 20, 2020.", "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-access-do-not-allow-anonymous-enumeration-of-sam-accounts-and-shares", "number": null}, "TechNet Removable Media Control": {"description": "Microsoft. (2007, August 31). https://technet.microsoft.com/en-us/library/cc771759(v=ws.10).aspx. Retrieved April 20, 2016.", "url": "https://technet.microsoft.com/en-us/library/cc772540(v=ws.10).aspx", "number": null}, "reagentc_cmd": {"description": "Microsoft, EliotSeattle, et al. (2022, August 18). REAgentC command-line options. Retrieved October 19, 2022.", "url": "https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/reagentc-command-line-options?view=windows-11", "number": null}, "Seqrite DoubleExtension": {"description": "Seqrite. (n.d.). How to avoid dual attack and vulnerable files with double extension?. Retrieved July 27, 2021.", "url": "https://www.seqrite.com/blog/how-to-avoid-dual-attack-and-vulnerable-files-with-double-extension/", "number": null}, "HowToGeek ShowExtension": {"description": "Chris Hoffman. (2017, March 8). How to Make Windows Show File Extensions. Retrieved August 4, 2021.", "url": "https://www.howtogeek.com/205086/beginner-how-to-make-windows-show-file-extensions/", "number": null}, "TechNet RDP NLA": {"description": "Microsoft. (n.d.). Configure Network Level Authentication for Remote Desktop Services Connections. Retrieved June 6, 2016.", "url": "https://technet.microsoft.com/en-us/library/cc732713.aspx", "number": null}, "EnableMPRNotifications": {"description": "Microsoft. (2023, January 26). Policy CSP - WindowsLogon. Retrieved March 30, 2023.", "url": "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-windowslogon", "number": null}}, "versioning_feature": false}