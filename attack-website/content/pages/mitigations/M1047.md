Title: Audit-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1047/index.html
data: {"attack_id": "M1047", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": null, "children": [{"name": "Enterprise", "id": "enterprise", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M1057/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M1060/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Pre-compromise", "id": "Pre-compromise", "path": "/mitigations/M1056/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Mobile", "id": "mobile", "path": "/mitigations/mobile/", "children": [{"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1058/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Attestation", "id": "Attestation", "path": "/mitigations/M1002/", "children": []}, {"name": "Deploy Compromised Device Detection Method", "id": "Deploy Compromised Device Detection Method", "path": "/mitigations/M1010/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1059/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M1009/", "children": []}, {"name": "Enterprise Policy", "id": "Enterprise Policy", "path": "/mitigations/M1012/", "children": []}, {"name": "Interconnection Filtering", "id": "Interconnection Filtering", "path": "/mitigations/M1014/", "children": []}, {"name": "Lock Bootloader", "id": "Lock Bootloader", "path": "/mitigations/M1003/", "children": []}, {"name": "Security Updates", "id": "Security Updates", "path": "/mitigations/M1001/", "children": []}, {"name": "System Partition Integrity", "id": "System Partition Integrity", "path": "/mitigations/M1004/", "children": []}, {"name": "Use Recent OS Version", "id": "Use Recent OS Version", "path": "/mitigations/M1006/", "children": []}, {"name": "User Guidance", "id": "User Guidance", "path": "/mitigations/M1011/", "children": []}]}, {"name": "ICS", "id": "ics", "path": "/mitigations/ics/", "children": [{"name": "Access Management", "id": "Access Management", "path": "/mitigations/M0801/", "children": []}, {"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M0936/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M0915/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M0949/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M0913/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M0948/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M0947/", "children": []}, {"name": "Authorization Enforcement", "id": "Authorization Enforcement", "path": "/mitigations/M0800/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M0946/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M0945/", "children": []}, {"name": "Communication Authenticity", "id": "Communication Authenticity", "path": "/mitigations/M0802/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M0953/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M0803/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M0942/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M0808/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M0941/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M0938/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M0950/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M0937/", "children": []}, {"name": "Human User Authentication", "id": "Human User Authentication", "path": "/mitigations/M0804/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M0935/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M0934/", "children": []}, {"name": "Mechanical Protection Layers", "id": "Mechanical Protection Layers", "path": "/mitigations/M0805/", "children": []}, {"name": "Minimize Wireless Signal Propagation", "id": "Minimize Wireless Signal Propagation", "path": "/mitigations/M0806/", "children": []}, {"name": "Mitigation Limited or Not Effective", "id": "Mitigation Limited or Not Effective", "path": "/mitigations/M0816/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M0932/", "children": []}, {"name": "Network Allowlists", "id": "Network Allowlists", "path": "/mitigations/M0807/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M0931/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M0930/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M0928/", "children": []}, {"name": "Operational Information Confidentiality", "id": "Operational Information Confidentiality", "path": "/mitigations/M0809/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M0810/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M0927/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M0926/", "children": []}, {"name": "Redundancy of Service", "id": "Redundancy of Service", "path": "/mitigations/M0811/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M0922/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M0944/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M0924/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M0921/", "children": []}, {"name": "Safety Instrumented Systems", "id": "Safety Instrumented Systems", "path": "/mitigations/M0812/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M0954/", "children": []}, {"name": "Software Process and Device Authentication", "id": "Software Process and Device Authentication", "path": "/mitigations/M0813/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M0920/", "children": []}, {"name": "Static Network Configuration", "id": "Static Network Configuration", "path": "/mitigations/M0814/", "children": []}, {"name": "Supply Chain Management", "id": "Supply Chain Management", "path": "/mitigations/M0817/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M0919/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M0951/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M0918/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M0917/", "children": []}, {"name": "Validate Program Inputs", "id": "Validate Program Inputs", "path": "/mitigations/M0818/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M0916/", "children": []}, {"name": "Watchdog Timers", "id": "Watchdog Timers", "path": "/mitigations/M0815/", "children": []}]}]}, "name": "Audit", "notes": null, "created": "11 June 2019", "modified": "10 December 2024", "descr": "Auditing is the process of recording activity and systematically reviewing and analyzing the activity and system configurations. The primary purpose of auditing is to detect anomalies and identify potential threats or weaknesses in the environment. Proper auditing configurations can also help to meet compliance requirements. The process of auditing encompasses regular analysis of user behaviors and system logs in support of proactive security measures.\n\nAuditing is applicable to all systems used within an organization, from the front door of a building to accessing a file on a fileserver. It is considered more critical for regulated industries such as, healthcare, finance and government where compliance requirements demand stringent tracking of user and system activates.This mitigation can be implemented through the following measures: \n\nSystem Audit:\n\n- Use Case: Regularly assess system configurations to ensure compliance with organizational security policies.\n- Implementation: Use tools to scan for deviations from established benchmarks.\n\nPermission Audits:\n\n- Use Case: Review file and folder permissions to minimize the risk of unauthorized access or privilege escalation.\n- Implementation: Run access reviews to identify users or groups with excessive permissions.\n\nSoftware Audits:\n\n- Use Case: Identify outdated, unsupported, or insecure software that could serve as an attack vector.\n- Implementation: Use inventory and vulnerability scanning tools to detect outdated versions and recommend secure alternatives.\n\nConfiguration Audits:\n\n- Use Case: Evaluate system and network configurations to ensure secure settings (e.g., disabled SMBv1, enabled MFA).\n- Implementation: Implement automated configuration scanning tools like SCAP (Security Content Automation Protocol) to identify non-compliant systems.\n\nNetwork Audits:\n\n- Use Case: Examine network traffic, firewall rules, and endpoint communications to identify unauthorized or insecure connections.\n- Implementation: Utilize tools such as Wireshark, or Zeek to monitor and log suspicious network behavior.", "version": "1.3", "techniques_addressed_data": [{"domain": "enterprise", "id": "T1548", "name": "Abuse Elevation Control Mechanism", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Bypass User Account Control", "descr": "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.(Citation: Github UACMe)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "TCC Manipulation", "descr": "Routinely check applications using Automation under Security & Privacy System Preferences. To reset permissions, user's can utilize the `tccutil reset` command. When using Mobile Device Management (MDM), review the list of enabled or disabled applications in the `MDMOverrides.plist` which overrides the TCC database.(Citation: TCC macOS bypass)", "subtechniques": [], "color": 1}], "descr": "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.(Citation: Github UACMe)"}, {"domain": "enterprise", "id": "T1087", "name": "Account Discovery", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "004", "name": "Cloud Account", "descr": "Routinely check user permissions to ensure only the expected users have the ability to list IAM identities or otherwise discover cloud accounts.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1560", "name": "Archive Collected Data", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Archive via Utility", "descr": "System scans can be performed to identify unauthorized archival utilities.", "subtechniques": [], "color": 1}], "descr": "System scans can be performed to identify unauthorized archival utilities."}, {"technique_used": true, "domain": "enterprise", "id": "T1612", "name": "Build Image on Host", "descr": "Audit images deployed within the environment to ensure they do not contain any malicious components.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1671", "name": "Cloud Application Integration", "descr": "Periodically review SaaS integrations for unapproved or potentially malicious applications.  ", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1059", "name": "Command and Scripting Interpreter", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "Python", "descr": "Inventory systems for unauthorized Python installations.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "011", "name": "Lua", "descr": "Inventory systems for unauthorized Lua installations.", "subtechniques": [], "color": 1}], "descr": "Inventory systems for unauthorized command and scripting interpreter installations."}, {"domain": "enterprise", "id": "T1543", "name": "Create or Modify System Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Windows Service", "descr": "Use auditing tools capable of detecting privilege and service abuse opportunities on systems within an enterprise and correct them. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Launch Daemon", "descr": "Use auditing tools capable of detecting folder permissions abuse opportunities on systems, especially reviewing changes made to folders by third-party software.", "subtechniques": [], "color": 1}], "descr": "Use auditing tools capable of detecting privilege and service abuse opportunities on systems within an enterprise and correct them."}, {"technique_used": true, "domain": "enterprise", "id": "T1530", "name": "Data from Cloud Storage", "descr": "Frequently check permissions on cloud storage to ensure proper permissions are set to deny open or unprivileged access to resources.(Citation: Amazon S3 Security, 2019)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1213", "name": "Data from Information Repositories", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Confluence", "descr": "Consider periodic review of accounts and privileges for critical and sensitive Confluence repositories.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Sharepoint", "descr": "Consider periodic review of accounts and privileges for critical and sensitive SharePoint repositories.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Code Repositories", "descr": "Consider periodic reviews of accounts and privileges for critical and sensitive code repositories. Scan code repositories for exposed credentials or other sensitive information.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Customer Relationship Management Software", "descr": "Consider periodic review of accounts and privileges for critical and sensitive CRM data.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Messaging Applications", "descr": "Preemptively search through communication services to find inappropriately shared data, and take actions to reduce exposure when found. ", "subtechniques": [], "color": 1}], "descr": "Consider periodic review of accounts and privileges for critical and sensitive repositories. Ensure that repositories such as cloud-hosted databases are not unintentionally exposed to the public, and that security groups assigned to them permit only necessary and authorized hosts.(Citation: AWS DB VPC)"}, {"technique_used": true, "domain": "enterprise", "id": "T1610", "name": "Deploy Container", "descr": "Scan images before deployment, and block those that are not in compliance with security policies. In Kubernetes environments, the admission controller can be used to validate images after a container deployment request is authenticated but before the container is deployed.(Citation: Kubernetes Hardening Guide)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1484", "name": "Domain or Tenant Policy Modification", "descr": "Identify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such as [BloodHound](https://attack.mitre.org/software/S0521) (version 1.5.1 and later)(Citation: GitHub Bloodhound).", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Group Policy Modification", "descr": "Identify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such as [BloodHound](https://attack.mitre.org/software/S0521) (version 1.5.1 and later).(Citation: GitHub Bloodhound)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1482", "name": "Domain Trust Discovery", "descr": "Map the trusts within existing domains/forests and keep trust relationships to a minimum.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1114", "name": "Email Collection", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Email Forwarding Rule", "descr": "Enterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.\n\nIn an Exchange environment, Administrators can use `Get-InboxRule` / `Remove-InboxRule` and `Get-TransportRule` / `Remove-TransportRule` to discover and remove potentially malicious auto-fowarding and transport rules.(Citation: Microsoft Tim McMichael Exchange Mail Forwarding 2)(Citation: Microsoft Manage Mail Flow Rules 2023)(Citation: Microsoft Get-InboxRule) In addition to this, a MAPI Editor can be utilized to examine the underlying database structure and discover any modifications/tampering of the properties of auto-forwarding rules.(Citation: Pfammatter - Hidden Inbox Rules)", "subtechniques": [], "color": 1}], "descr": "Enterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.\n\nIn an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious auto-forwarding rules.(Citation: Microsoft Tim McMichael Exchange Mail Forwarding 2) "}, {"domain": "enterprise", "id": "T1546", "name": "Event Triggered Execution", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "LC_LOAD_DYLIB Addition", "descr": "Binaries can also be baselined for what dynamic libraries they require, and if an app requires a new dynamic library that wasn't included as part of an update, it should be investigated.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1606", "name": "Forge Web Credentials", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Web Cookies", "descr": "Administrators should perform an audit of all access lists and the permissions they have been granted to access web applications and services. This should be done extensively on all resources in order to establish a baseline, followed up on with periodic audits of new or updated resources. Suspicious accounts/credentials should be investigated and removed.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "SAML Tokens", "descr": "Enable advanced auditing on AD FS. Check the success and failure audit options in the AD FS Management snap-in. Enable Audit Application Generated events on the AD FS farm via Group Policy Object.(Citation: FireEye ADFS)", "subtechniques": [], "color": 1}], "descr": "Administrators should perform an audit of all access lists and the permissions they have been granted to access web applications and services. This should be done extensively on all resources in order to establish a baseline, followed up on with periodic audits of new or updated resources. Suspicious accounts/credentials should be investigated and removed.\n \nEnable advanced auditing on ADFS. Check the success and failure audit options in the ADFS Management snap-in. Enable Audit Application Generated events on the AD FS farm via Group Policy Object.(Citation: FireEye ADFS)"}, {"domain": "enterprise", "id": "T1564", "name": "Hide Artifacts", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "Run Virtual Instance", "descr": "Periodically audit virtual machines for abnormalities. On ESXi servers, periodically compare the output of `vim-cmd vmsvc/getallvms`, which lists all VMs in vCenter, and `escxli vm process list | grep Display`, which lists all VMs hosted on ESXi.(Citation: MITRE VMware Abuse 2024)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Email Hiding Rules", "descr": "Enterprise email solutions may have monitoring mechanisms that may include the ability to audit inbox rules on a regular basis. \n\nIn an Exchange environment, Administrators can use `Get-InboxRule` / `Remove-InboxRule` and `Get-TransportRule` / `Remove-TransportRule` to discover and remove potentially malicious inbox and transport rules.(Citation: Microsoft Get-InboxRule)(Citation: Microsoft Manage Mail Flow Rules 2023)", "subtechniques": [], "color": 1}], "descr": "Periodically audit virtual machines for abnormalities."}, {"domain": "enterprise", "id": "T1574", "name": "Hijack Execution Flow", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "DLL", "descr": "Use auditing tools capable of detecting DLL search order hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for DLL hijacking weaknesses.(Citation: Powersploit)\n\nUse the program `sxstrace.exe` that is included with Windows, along with manual inspection, to check manifest files for side-by-side problems in software.(Citation: Microsoft Sxstrace)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Executable Installer File Permissions Weakness", "descr": "Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses.(Citation: Powersploit)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "Path Interception by PATH Environment Variable", "descr": "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Path Interception by Search Order Hijacking", "descr": "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "009", "name": "Path Interception by Unquoted Path", "descr": "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "010", "name": "Services File Permissions Weakness", "descr": "Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses.(Citation: Powersploit)", "subtechniques": [], "color": 1}], "descr": "Use auditing tools capable of detecting hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for hijacking weaknesses.(Citation: Powersploit)\n\nUse the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-loading vulnerabilities in software.\n\nFind and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector)"}, {"domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Disable or Modify Tools", "descr": "Periodically verify that tools are functioning appropriately \u2013 for example, that all expected hosts with EDRs or monitoring agents are checking in to the central console. Check EDRs to ensure that no unexpected exclusion paths have been added. In Microsoft Defender for Endpoint, exclusions can be reviewed with the `Get-MpPreference` cmdlet.(Citation: CodeX Microsoft Defender 2021)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Disable Windows Event Logging", "descr": "Consider periodic review of <code>auditpol</code> settings for Administrator accounts and perform dynamic baselining on SIEM(s) to investigate potential malicious activity. Also ensure that the EventLog service and its threads are properly running.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Disable or Modify System Firewall", "descr": "Routinely check account role permissions to ensure only expected users and roles have permission to modify system firewalls.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "Disable or Modify Cloud Firewall", "descr": "Routinely check account role permissions to ensure only expected users and roles have permission to modify cloud firewalls. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "012", "name": "Disable or Modify Linux Audit System", "descr": "Routinely check account role permissions to ensure only expected users and roles have permission to modify logging settings.\n\nTo ensure Audit rules can not be modified at runtime, add the `auditctl -e 2` as the last command in the audit.rules files. Once started, any attempt to change the configuration in this mode will be audited and denied. The configuration can only be changed by rebooting the machine.", "subtechniques": [], "color": 1}], "descr": "Routinely check account role permissions to ensure only expected users and roles have permission to modify defensive tools and settings. Periodically verify that tools such as EDRs are functioning as expected."}, {"technique_used": true, "domain": "enterprise", "id": "T1525", "name": "Implant Internal Image", "descr": "Periodically check the integrity of images and containers used in cloud deployments to ensure they have not been modified to include malicious software.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1070", "name": "Indicator Removal", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "008", "name": "Clear Mailbox Data", "descr": "In an Exchange environment, Administrators can use `Get-TransportRule` / `Remove-TransportRule` to discover and remove potentially malicious transport rules.(Citation: Microsoft Manage Mail Flow Rules 2023)", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1036", "name": "Masquerading", "descr": "Audit user accounts to ensure that each one has a defined purpose.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "010", "name": "Masquerade Account Name", "descr": "Audit user accounts to ensure that each one has a defined purpose.  ", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1556", "name": "Modify Authentication Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "Multi-Factor Authentication", "descr": "Review MFA actions alongside authentication logs to ensure that MFA-based logins are functioning as intended. Review user accounts to ensure that all accounts have MFA enabled.(Citation: Mandiant Cloudy Logs 2023)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "Hybrid Identity", "descr": "Periodically review the hybrid identity solution in use for any discrepancies. For example, review all PTA agents in the Entra ID Management Portal to identify any unwanted or unapproved ones.(Citation: Mandiant Azure AD Backdoors) If ADFS is in use, review DLLs and executable files in the AD FS and Global Assembly Cache directories to ensure that they are signed by Microsoft. Note that in some cases binaries may be catalog-signed, which may cause the file to appear unsigned when viewing file properties.(Citation: MagicWeb)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Network Provider DLL", "descr": "Periodically review for new and unknown network provider DLLs within the Registry (`HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<NetworkProviderName>\\NetworkProvider\\ProviderPath`).\n\nEnsure only valid network provider DLLs are registered. The name of these can be found in the Registry key at `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order`, and have corresponding service subkey pointing to a DLL at `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentC ontrolSet\\Services\\<NetworkProviderName>\\NetworkProvider`.", "subtechniques": [], "color": 1}], "descr": "Review authentication logs to ensure that mechanisms such as enforcement of MFA are functioning as intended.\n\nPeriodically review the hybrid identity solution in use for any discrepancies. For example, review all Pass Through Authentication (PTA) agents in the Azure Management Portal to identify any unwanted or unapproved ones.(Citation: Mandiant Azure AD Backdoors) If ADFS is in use, review DLLs and executable files in the AD FS and Global Assembly Cache directories to ensure that they are signed by Microsoft. Note that in some cases binaries may be catalog-signed, which may cause the file to appear unsigned when viewing file properties.(Citation: MagicWeb)\n\nPeriodically review for new and unknown network provider DLLs within the Registry (`HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<NetworkProviderName>\\NetworkProvider\\ProviderPath`). Ensure only valid network provider DLLs are registered. The name of these can be found in the Registry key at `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order`, and have corresponding service subkey pointing to a DLL at `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentC ontrolSet\\Services\\<NetworkProviderName>\\NetworkProvider`."}, {"domain": "enterprise", "id": "T1578", "name": "Modify Cloud Compute Infrastructure", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Create Snapshot", "descr": "Routinely check user permissions to ensure only the expected users have the capability to create snapshots and backups.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Create Cloud Instance", "descr": "Routinely check user permissions to ensure only the expected users have the capability to create new instances.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Delete Cloud Instance", "descr": "Routinely check user permissions to ensure only the expected users have the capability to delete new instances.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Modify Cloud Compute Configurations", "descr": "Routinely monitor user permissions to ensure only the expected users have the capability to request quota adjustments or modify tenant-level compute settings.", "subtechniques": [], "color": 1}], "descr": "Routinely monitor user permissions to ensure only the expected users have the capability to modify cloud compute infrastructure components."}, {"technique_used": true, "domain": "enterprise", "id": "T1666", "name": "Modify Cloud Resource Hierarchy", "descr": "Periodically audit resource groups in the cloud management console to ensure that only expected items exist, especially close to the top of the hierarchy (e.g., AWS accounts and Azure subscriptions). Typically, top-level accounts (such as the AWS management account) should not contain any workloads or resources.(Citation: AWS Management Account Best Practices)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1095", "name": "Non-Application Layer Protocol", "descr": "Periodically investigate ESXi hosts for open VMCI ports. Running the `lsof -A` command and inspecting results with a type of `SOCKET_VMCI` will reveal processes that have open VMCI ports.(Citation: Google Cloud Threat Intelligence ESXi Hardening 2023)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1027", "name": "Obfuscated Files or Information", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "011", "name": "Fileless Storage", "descr": "Consider periodic review of common fileless storage locations (such as the Registry or WMI repository) to potentially identify abnormal and malicious data.", "subtechniques": [], "color": 1}], "descr": "Consider periodic review of common fileless storage locations (such as the Registry or WMI repository) to potentially identify abnormal and malicious data."}, {"technique_used": true, "domain": "enterprise", "id": "T1566", "name": "Phishing", "descr": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Spearphishing Attachment", "descr": "Enable auditing and monitoring for email attachments and file transfers to detect and investigate suspicious activity. Regularly review logs for anomalies related to attachments containing potentially malicious content, as well as any attempts to execute or interact with these files. This practice helps identify spearphishing attempts before they can lead to further compromise.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Spearphishing Link", "descr": "Audit applications and their permissions to ensure access to data and resources are limited based upon necessity and principle of least privilege.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Spearphishing via Service", "descr": "Implement auditing and logging for interactions with third-party messaging services or collaboration platforms. Monitor user activity and review logs for signs of suspicious links, downloads, or file exchanges that could indicate spearphishing attempts. Effective auditing allows for the quick identification of malicious activity originating from compromised service accounts.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1653", "name": "Power Settings", "descr": "Periodically inspect systems for abnormal and unexpected power settings that may indicate malicious activty.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1542", "name": "Pre-OS Boot", "descr": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "004", "name": "ROMMONkit", "descr": "Periodically check the integrity of system image to ensure it has not been modified. (Citation: Cisco IOS Software Integrity Assurance - Image File Integrity) (Citation: Cisco IOS Software Integrity Assurance - Image File Verification) (Citation: Cisco IOS Software Integrity Assurance - Change Control) ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "TFTP Boot", "descr": "Periodically check the integrity of the running configuration and system image to ensure they have not been modified. (Citation: Cisco IOS Software Integrity Assurance - Image File Verification) (Citation: Cisco IOS Software Integrity Assurance - Image File Integrity) (Citation: Cisco IOS Software Integrity Assurance - Change Control) ", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1563", "name": "Remote Service Session Hijacking", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "RDP Hijacking", "descr": "Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1021", "name": "Remote Services", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Remote Desktop Protocol", "descr": "Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "VNC", "descr": "Inventory workstations for unauthorized VNC server software.", "subtechniques": [], "color": 1}], "descr": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses."}, {"domain": "enterprise", "id": "T1053", "name": "Scheduled Task/Job", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "At", "descr": "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit) Windows operating system also creates a registry key specifically associated with the creation of a scheduled task on the destination host at: Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\At1. (Citation: Secureworks - AT.exe Scheduled Task) In Linux and macOS environments, scheduled tasks using <code>[at](https://attack.mitre.org/software/S0110)</code> can be audited locally, or through centrally collected logging, using syslog, or auditd events from the host. (Citation: Kifarunix - Task Scheduling in Linux)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Cron", "descr": "Review changes to the <code>cron</code> schedule. <code>cron</code> execution can be reviewed within the <code>/var/log</code> directory. To validate the location of the <code>cron</code> log file, check the syslog config at <code>/etc/rsyslog.conf</code> or <code>/etc/syslog.conf</code>.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Scheduled Task", "descr": "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit)", "subtechniques": [], "color": 1}], "descr": "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit)"}, {"technique_used": true, "domain": "enterprise", "id": "T1593", "name": "Search Open Websites/Domains", "descr": "Scan public code repositories for exposed credentials or other sensitive information before making commits. Ensure that any leaked credentials are removed from the commit history, not just the current latest version of the code.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Code Repositories", "descr": "Scan public code repositories for exposed credentials or other sensitive information before making commits. Ensure that any leaked credentials are removed from the commit history, not just the current latest version of the code.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1505", "name": "Server Software Component", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "SQL Stored Procedures", "descr": "Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Transport Agent", "descr": "Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "IIS Components", "descr": "Regularly check installed IIS components to verify the integrity of the web server and identify if unexpected changes have been made.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Terminal Services DLL", "descr": "Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "vSphere Installation Bundles", "descr": "Periodically audit ESXi hosts to ensure that only approved VIBs are installed. The command `esxcli software vib list` lists installed VIBs, while the command `esxcli software vib signature verify` verifies the signatures of installed VIBs.(Citation: Google Cloud Threat Intelligence ESXi VIBs 2022)", "subtechniques": [], "color": 1}], "descr": "Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made."}, {"domain": "enterprise", "id": "T1176", "name": "Software Extensions", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Browser Extensions", "descr": " Ensure extensions that are installed are the intended ones, as many malicious extensions will masquerade as legitimate ones.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "IDE Extensions", "descr": "Ensure extensions that are installed are the intended ones, as many malicious extensions may masquerade as legitimate ones. ", "subtechniques": [], "color": 1}], "descr": "Ensure extensions that are installed are the intended ones, as many malicious extensions may masquerade as legitimate ones. "}, {"technique_used": true, "domain": "enterprise", "id": "T1528", "name": "Steal Application Access Token", "descr": "Administrators should audit all cloud and container accounts to ensure that they are necessary and that the permissions granted to them are appropriate.  Additionally, administrators should perform an audit of all OAuth applications and the permissions they have been granted to access organizational data. This should be done extensively on all applications in order to establish a baseline, followed up on with periodic audits of new or updated applications. Suspicious applications should be investigated and removed.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1649", "name": "Steal or Forge Authentication Certificates", "descr": "Check and remediate unneeded existing authentication certificates as well as common abusable misconfigurations of CA settings and permissions, such as AD CS certificate enrollment permissions and published overly permissive certificate templates (which define available settings for created certificates). For example, available AD CS certificate templates can be checked via the Certificate Authority MMC snap-in (`certsrv.msc`). `certutil.exe` can also be used to examine various information within an AD CS CA database.(Citation: SpecterOps Certified Pre Owned)(Citation: GitHub PSPKIAudit)(Citation: GitHub Certify)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1558", "name": "Steal or Forge Kerberos Tickets", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "004", "name": "AS-REP Roasting", "descr": "Kerberos preauthentication is enabled by default. Older protocols might not support preauthentication therefore it is possible to have this setting disabled. Make sure that all accounts have preauthentication whenever possible and audit changes to setting. Windows tools such as PowerShell may be used to easily find which accounts have preauthentication disabled.  (Citation: Microsoft Preauthentication Jul 2012)(Citation: Stealthbits Cracking AS-REP Roasting Jun 2019)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Ccache Files", "descr": "Enable and perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.(Citation: Brining MimiKatz to Unix) For example, use <code>auditd</code> to audit access to hashes, machine tickets, or <code>/tmp</code> files. If using sssd and Vintela, ensure kerberos is disabled if not being used.(Citation: audits linikatz)", "subtechniques": [], "color": 1}], "descr": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses."}, {"technique_used": true, "domain": "enterprise", "id": "T1539", "name": "Steal Web Session Cookie", "descr": "Implement auditing for authentication activities and user logins to detect the use of stolen session cookies. Monitor for impossible travel scenarios and anomalous behavior that could indicate the use of compromised session tokens or cookies.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1552", "name": "Unsecured Credentials", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Credentials In Files", "descr": "Preemptively search for files containing passwords and take actions to reduce the exposure risk when found.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Credentials in Registry", "descr": "Proactively search for credentials within the Registry and attempt to remediate the risk.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Private Keys", "descr": "Ensure only authorized keys are allowed access to critical resources and audit access lists regularly.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Group Policy Preferences", "descr": "Search SYSVOL for any existing GGPs that may contain credentials and remove them.(Citation: ADSecurity Finding Passwords in SYSVOL)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Chat Messages", "descr": "Preemptively search through communication services to find shared unsecured credentials. Searching for common patterns like \"<code>password is </code>\", \u201c<code>password=</code>\u201d and take actions to reduce exposure when found. ", "subtechniques": [], "color": 1}], "descr": "Preemptively search for files containing passwords or other credentials and take actions to reduce the exposure risk when found."}, {"technique_used": true, "domain": "enterprise", "id": "T1550", "name": "Use Alternate Authentication Material", "descr": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Application Access Token", "descr": "Administrators should audit all cloud and container accounts to ensure that they are necessary and that the permissions granted to them are appropriate. Where possible, the ability to request temporary account tokens on behalf of another accounts should be disabled. Additionally, administrators can leverage audit tools to monitor actions that can be conducted as a result of OAuth 2.0 access. For instance, audit reports enable admins to identify privilege escalation actions such as role creations or policy modifications, which could be actions performed after initial access.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1204", "name": "User Execution", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Malicious Image", "descr": "Audit images deployed within the environment to ensure they do not contain any malicious components.", "subtechniques": [], "color": 1}]}], "layers": [{"domain": "enterprise", "name": "Enterprise", "filename": "M1047-enterprise-layer.json", "navigator_link": "https://mitre-attack.github.io/attack-navigator/"}], "citations": {"current_number": 0, "GitHub Bloodhound": {"description": "Robbins, A., Vazarkar, R., and Schroeder, W. (2016, April 17). Bloodhound: Six Degrees of Domain Admin. Retrieved March 5, 2019.", "url": "https://github.com/BloodHoundAD/BloodHound", "number": null}, "Powersploit": {"description": "PowerSploit. (n.d.). Retrieved December 4, 2014.", "url": "https://github.com/mattifestation/PowerSploit", "number": null}, "MITRE VMware Abuse 2024": {"description": "Lex Crumpton. (2024, May 22). Infiltrating Defenses: Abusing VMware in MITRE\u2019s Cyber Intrusion. Retrieved March 26, 2025.", "url": "https://medium.com/mitre-engenuity/infiltrating-defenses-abusing-vmware-in-mitres-cyber-intrusion-4ea647b83f5b", "number": null}, "Vulnerability and Exploit Detector": {"description": "Kanthak, S.. (2016, July 20). Vulnerability and Exploit Detector. Retrieved February 3, 2017.", "url": "https://skanthak.homepage.t-online.de/sentinel.html", "number": null}, "Microsoft CreateProcess": {"description": "Microsoft. (n.d.). CreateProcess function. Retrieved September 12, 2024.", "url": "https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa", "number": null}, "Microsoft Dynamic-Link Library Security": {"description": "Microsoft. (n.d.). Dynamic-Link Library Security. Retrieved July 25, 2016.", "url": "https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-security?redirectedfrom=MSDN", "number": null}, "Microsoft Manage Mail Flow Rules 2023": {"description": "Microsoft. (2023, February 22). Manage mail flow rules in Exchange Online. Retrieved March 13, 2023.", "url": "https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/manage-mail-flow-rules", "number": null}, "Microsoft Get-InboxRule": {"description": "Microsoft. (n.d.). Get-InboxRule. Retrieved June 10, 2021.", "url": "https://docs.microsoft.com/en-us/powershell/module/exchange/get-inboxrule?view=exchange-ps", "number": null}, "Github UACMe": {"description": "UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016.", "url": "https://github.com/hfiref0x/UACME", "number": null}, "Microsoft Preauthentication Jul 2012": {"description": "Microsoft. (2012, July 18). Preauthentication. Retrieved August 24, 2020.", "url": "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc961961(v=technet.10)?redirectedfrom=MSDN", "number": null}, "Stealthbits Cracking AS-REP Roasting Jun 2019": {"description": "Jeff Warren. (2019, June 27). Cracking Active Directory Passwords with AS-REP Roasting. Retrieved August 24, 2020.", "url": "https://blog.stealthbits.com/cracking-active-directory-passwords-with-as-rep-roasting/", "number": null}, "Secureworks - AT.exe Scheduled Task": {"description": "Carvey, H.. (2014, September). Where You AT?: Indicators of Lateral Movement Using at.exe on Windows 7 Systems. Retrieved November 27, 2019.", "url": "https://www.secureworks.com/blog/where-you-at-indicators-of-lateral-movement-using-at-exe-on-windows-7-systems", "number": null}, "Kifarunix - Task Scheduling in Linux": {"description": "Koromicha. (2019, September 7). Scheduling tasks using at command in Linux. Retrieved December 3, 2019.", "url": "https://kifarunix.com/scheduling-tasks-using-at-command-in-linux/", "number": null}, "ADSecurity Finding Passwords in SYSVOL": {"description": "Sean Metcalf. (2015, December 28). Finding Passwords in SYSVOL & Exploiting Group Policy Preferences. Retrieved February 17, 2020.", "url": "https://adsecurity.org/?p=2288", "number": null}, "Kubernetes Hardening Guide": {"description": "National Security Agency, Cybersecurity and Infrastructure Security Agency. (2022, March). Kubernetes Hardening Guide. Retrieved April 1, 2022.", "url": "https://media.defense.gov/2022/Aug/29/2003066362/-1/-1/0/CTR_KUBERNETES_HARDENING_GUIDANCE_1.2_20220829.PDF", "number": null}, "Brining MimiKatz to Unix": {"description": "Tim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.", "url": "https://labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf", "number": null}, "audits linikatz": {"description": "Wadhwa-Brown, Tim. (2022). audit.rules. Retrieved September 17, 2024.", "url": "https://github.com/CiscoCXSecurity/linikatz/blob/master/blue/audit/audit.rules", "number": null}, "FireEye ADFS": {"description": "Bierstock, D., Baker, A. (2019, March 21). I am AD FS and So Can You. Retrieved December 17, 2020.", "url": "https://www.troopers.de/troopers19/agenda/fpxwmn/", "number": null}, "Google Cloud Threat Intelligence ESXi Hardening 2023": {"description": "Alex Marvi, Greg Blaum, and Ron Craft. (2023, June 28). Detection, Containment, and Hardening Opportunities for Privileged Guest Operations, Anomalous Behavior, and VMCI Backdoors on Compromised VMware Hosts. Retrieved March 26, 2025.", "url": "https://cloud.google.com/blog/topics/threat-intelligence/vmware-detection-containment-hardening", "number": null}, "Mandiant Cloudy Logs 2023": {"description": "Pany, D. & Hanley, C. (2023, May 3). Cloudy with a Chance of Bad Logs: Cloud Platform Log Configurations to Consider in Investigations. Retrieved October 16, 2023.", "url": "https://www.mandiant.com/resources/blog/cloud-bad-log-configurations", "number": null}, "MagicWeb": {"description": "Microsoft Threat Intelligence Center, Microsoft Detection and Response Team, Microsoft 365 Defender Research Team . (2022, August 24). MagicWeb: NOBELIUM\u2019s post-compromise trick to authenticate as anyone. Retrieved September 28, 2022.", "url": "https://www.microsoft.com/security/blog/2022/08/24/magicweb-nobeliums-post-compromise-trick-to-authenticate-as-anyone/", "number": null}, "Mandiant Azure AD Backdoors": {"description": "Mike Burns. (2020, September 30). Detecting Microsoft 365 and Azure Active Directory Backdoors. Retrieved September 28, 2022.", "url": "https://www.mandiant.com/resources/detecting-microsoft-365-azure-active-directory-backdoors", "number": null}, "Cisco IOS Software Integrity Assurance - Image File Integrity": {"description": "Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Image File Integrity. Retrieved October 21, 2020.", "url": "https://tools.cisco.com/security/center/resources/integrity_assurance.html#30", "number": null}, "Cisco IOS Software Integrity Assurance - Image File Verification": {"description": "Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Cisco IOS Image File Verification. Retrieved October 19, 2020.", "url": "https://tools.cisco.com/security/center/resources/integrity_assurance.html#7", "number": null}, "Cisco IOS Software Integrity Assurance - Change Control": {"description": "Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Change Control. Retrieved October 21, 2020.", "url": "https://tools.cisco.com/security/center/resources/integrity_assurance.html#31", "number": null}, "Microsoft Sxstrace": {"description": "Gerend, J. et al.. (2017, October 16). sxstrace. Retrieved April 26, 2021.", "url": "https://docs.microsoft.com/windows-server/administration/windows-commands/sxstrace", "number": null}, "AWS Management Account Best Practices": {"description": "AWS. (n.d.). Best practices for the management account. Retrieved October 16, 2024.", "url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_best-practices_mgmt-acct.html", "number": null}, "Pfammatter - Hidden Inbox Rules": {"description": "Damian Pfammatter. (2018, September 17). Hidden Inbox Rules in Microsoft Exchange. Retrieved October 12, 2021.", "url": "https://blog.compass-security.com/2018/09/hidden-inbox-rules-in-microsoft-exchange/", "number": null}, "Microsoft Tim McMichael Exchange Mail Forwarding 2": {"description": "McMichael, T.. (2015, June 8). Exchange and Office 365 Mail Forwarding. Retrieved October 8, 2019.", "url": "https://blogs.technet.microsoft.com/timmcmic/2015/06/08/exchange-and-office-365-mail-forwarding-2/", "number": null}, "GitHub PSPKIAudit": {"description": "HarmJ0y et al. (2021, June 16). PSPKIAudit. Retrieved August 2, 2022.", "url": "https://github.com/GhostPack/PSPKIAudit", "number": null}, "GitHub Certify": {"description": "HarmJ0y et al. (2021, June 9). Certify. Retrieved August 4, 2022.", "url": "https://github.com/GhostPack/Certify/", "number": null}, "SpecterOps Certified Pre Owned": {"description": "Schroeder, W. & Christensen, L. (2021, June 22). Certified Pre-Owned - Abusing Active Directory Certificate Services. Retrieved August 2, 2022.", "url": "https://web.archive.org/web/20220818094600/https://specterops.io/assets/resources/Certified_Pre-Owned.pdf", "number": null}, "TCC macOS bypass": {"description": "Phil Stokes. (2021, July 1). Bypassing macOS TCC User Privacy Protections By Accident and Design. Retrieved March 21, 2024.", "url": "https://www.sentinelone.com/labs/bypassing-macos-tcc-user-privacy-protections-by-accident-and-design/", "number": null}, "Amazon S3 Security, 2019": {"description": "Amazon. (2019, May 17). How can I secure the files in my Amazon S3 bucket?. Retrieved October 4, 2019.", "url": "https://aws.amazon.com/premiumsupport/knowledge-center/secure-s3-resources/", "number": null}, "AWS DB VPC": {"description": "AWS. (n.d.). Working with a DB instance in a VPC. Retrieved September 24, 2024.", "url": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.WorkingWithRDSInstanceinaVPC.html", "number": null}, "CodeX Microsoft Defender 2021": {"description": "Christopher Brumm. (2021, August 4). My learnings on Microsoft Defender for Endpoint and Exclusions. Retrieved March 18, 2025.", "url": "https://medium.com/codex/my-learnings-on-microsoft-defender-for-endpoint-and-exclusions-ddacf2fdd047", "number": null}, "Google Cloud Threat Intelligence ESXi VIBs 2022": {"description": "Alexander Marvi, Jeremy Koppen, Tufail Ahmed, and Jonathan Lepore. (2022, September 29). Bad VIB(E)s Part One: Investigating Novel Malware Persistence Within ESXi Hypervisors. Retrieved March 26, 2025.", "url": "https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence", "number": null}}, "versioning_feature": false}