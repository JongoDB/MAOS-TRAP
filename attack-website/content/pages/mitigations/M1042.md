Title: Disable or Remove Feature or Program-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1042/index.html
data: {"attack_id": "M1042", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": null, "children": [{"name": "Enterprise", "id": "enterprise", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M1057/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M1060/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Pre-compromise", "id": "Pre-compromise", "path": "/mitigations/M1056/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Mobile", "id": "mobile", "path": "/mitigations/mobile/", "children": [{"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1058/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Attestation", "id": "Attestation", "path": "/mitigations/M1002/", "children": []}, {"name": "Deploy Compromised Device Detection Method", "id": "Deploy Compromised Device Detection Method", "path": "/mitigations/M1010/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1059/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M1009/", "children": []}, {"name": "Enterprise Policy", "id": "Enterprise Policy", "path": "/mitigations/M1012/", "children": []}, {"name": "Interconnection Filtering", "id": "Interconnection Filtering", "path": "/mitigations/M1014/", "children": []}, {"name": "Lock Bootloader", "id": "Lock Bootloader", "path": "/mitigations/M1003/", "children": []}, {"name": "Security Updates", "id": "Security Updates", "path": "/mitigations/M1001/", "children": []}, {"name": "System Partition Integrity", "id": "System Partition Integrity", "path": "/mitigations/M1004/", "children": []}, {"name": "Use Recent OS Version", "id": "Use Recent OS Version", "path": "/mitigations/M1006/", "children": []}, {"name": "User Guidance", "id": "User Guidance", "path": "/mitigations/M1011/", "children": []}]}, {"name": "ICS", "id": "ics", "path": "/mitigations/ics/", "children": [{"name": "Access Management", "id": "Access Management", "path": "/mitigations/M0801/", "children": []}, {"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M0936/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M0915/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M0949/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M0913/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M0948/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M0947/", "children": []}, {"name": "Authorization Enforcement", "id": "Authorization Enforcement", "path": "/mitigations/M0800/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M0946/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M0945/", "children": []}, {"name": "Communication Authenticity", "id": "Communication Authenticity", "path": "/mitigations/M0802/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M0953/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M0803/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M0942/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M0808/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M0941/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M0938/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M0950/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M0937/", "children": []}, {"name": "Human User Authentication", "id": "Human User Authentication", "path": "/mitigations/M0804/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M0935/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M0934/", "children": []}, {"name": "Mechanical Protection Layers", "id": "Mechanical Protection Layers", "path": "/mitigations/M0805/", "children": []}, {"name": "Minimize Wireless Signal Propagation", "id": "Minimize Wireless Signal Propagation", "path": "/mitigations/M0806/", "children": []}, {"name": "Mitigation Limited or Not Effective", "id": "Mitigation Limited or Not Effective", "path": "/mitigations/M0816/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M0932/", "children": []}, {"name": "Network Allowlists", "id": "Network Allowlists", "path": "/mitigations/M0807/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M0931/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M0930/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M0928/", "children": []}, {"name": "Operational Information Confidentiality", "id": "Operational Information Confidentiality", "path": "/mitigations/M0809/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M0810/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M0927/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M0926/", "children": []}, {"name": "Redundancy of Service", "id": "Redundancy of Service", "path": "/mitigations/M0811/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M0922/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M0944/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M0924/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M0921/", "children": []}, {"name": "Safety Instrumented Systems", "id": "Safety Instrumented Systems", "path": "/mitigations/M0812/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M0954/", "children": []}, {"name": "Software Process and Device Authentication", "id": "Software Process and Device Authentication", "path": "/mitigations/M0813/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M0920/", "children": []}, {"name": "Static Network Configuration", "id": "Static Network Configuration", "path": "/mitigations/M0814/", "children": []}, {"name": "Supply Chain Management", "id": "Supply Chain Management", "path": "/mitigations/M0817/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M0919/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M0951/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M0918/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M0917/", "children": []}, {"name": "Validate Program Inputs", "id": "Validate Program Inputs", "path": "/mitigations/M0818/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M0916/", "children": []}, {"name": "Watchdog Timers", "id": "Watchdog Timers", "path": "/mitigations/M0815/", "children": []}]}]}, "name": "Disable or Remove Feature or Program", "notes": null, "created": "11 June 2019", "modified": "10 December 2024", "descr": "Disable or remove unnecessary and potentially vulnerable software, features, or services to reduce the attack surface and prevent abuse by adversaries. This involves identifying software or features that are no longer needed or that could be exploited and ensuring they are either removed or properly disabled. This mitigation can be implemented through the following measures: \n\nRemove Legacy Software:\n\n- Use Case: Disable or remove older versions of software that no longer receive updates or security patches (e.g., legacy Java, Adobe Flash).\n- Implementation: A company removes Flash Player from all employee systems after it has reached its end-of-life date.\n\nDisable Unused Features:\n\n- Use Case: Turn off unnecessary operating system features like SMBv1, Telnet, or RDP if they are not required.\n- Implementation: Disable SMBv1 in a Windows environment to mitigate vulnerabilities like EternalBlue.\n\nControl Applications Installed by Users:\n\n- Use Case: Prevent users from installing unauthorized software via group policies or other management tools.\n- Implementation: Block user installations of unauthorized file-sharing applications (e.g., BitTorrent clients) in an enterprise environment.\n\nRemove Unnecessary Services:\n\n- Use Case: Identify and disable unnecessary default services running on endpoints, servers, or network devices.\n- Implementation: Disable unused administrative shares (e.g., C$, ADMIN$) on workstations.\n\nRestrict Add-ons and Plugins:\n\n- Use Case: Remove or disable browser plugins and add-ons that are not needed for business purposes.\n- Implementation: Disable Java and ActiveX plugins in web browsers to prevent drive-by attacks.\n\n", "version": "1.2", "techniques_addressed_data": [{"technique_used": true, "domain": "enterprise", "id": "T1098", "name": "Account Manipulation", "descr": "Remove unnecessary and potentially abusable authentication and authorization mechanisms where possible.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Additional Cloud Credentials", "descr": "Remove unnecessary and potentially abusable authentication mechanisms where possible. For example, in Entra ID environments, disable the app password feature unless explicitly required. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Additional Email Delegate Permissions", "descr": "If email delegation is not required, disable it. In Google Workspace this can be accomplished through the Google Admin console.(Citation: Gmail Delegation)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "SSH Authorized Keys", "descr": "Disable SSH if it is not necessary on a host or restrict SSH access for specific users/groups using <code>/etc/ssh/sshd_config</code>. Setting the `PermitRootLogin` directive to `no` will prevent the root user from logging in via SSH.(Citation: Broadcom ESXi SSH)", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1595", "name": "Active Scanning", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Wordlist Scanning", "descr": "Remove or disable access to any systems, resources, and infrastructure that are not explicitly required to be available externally.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1557", "name": "Adversary-in-the-Middle", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "LLMNR/NBT-NS Poisoning and SMB Relay", "descr": "Disable LLMNR and NetBIOS in local computer security settings or by group policy if they are not needed within an environment. (Citation: ADSecurity Windows Secure Baseline)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "ARP Cache Poisoning", "descr": "Consider disabling updating the ARP cache on gratuitous ARP replies.", "subtechniques": [], "color": 1}], "descr": "Disable legacy network protocols that may be used   to intercept network traffic if applicable, especially those that are not needed within an environment."}, {"domain": "enterprise", "id": "T1547", "name": "Boot or Logon Autostart Execution", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "007", "name": "Re-opened Applications", "descr": "This feature can be disabled entirely with the following terminal command: <code>defaults write -g ApplePersistence -bool no</code>.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1671", "name": "Cloud Application Integration", "descr": "Do not allow users to add new application integrations into a SaaS environment. In Entra ID environments, consider enforcing the \u201cDo not allow user consent\u201d option.(Citation: Microsoft Entra Configure OAuth Consent)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1059", "name": "Command and Scripting Interpreter", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "PowerShell", "descr": "It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Visual Basic", "descr": "Turn off or restrict access to unneeded VB components.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "JavaScript", "descr": "Turn off or restrict access to unneeded scripting components.", "subtechniques": [], "color": 1}], "descr": "Disable or remove any unnecessary or unused shells or interpreters."}, {"technique_used": true, "domain": "enterprise", "id": "T1092", "name": "Communication Through Removable Media", "descr": "Disable Autoruns if it is unnecessary.(Citation: Microsoft Disable Autorun)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1609", "name": "Container Administration Command", "descr": "Remove unnecessary tools and software from containers.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1555", "name": "Credentials from Password Stores", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "004", "name": "Windows Credential Manager", "descr": "Consider enabling the \u201cNetwork access: Do not allow storage of passwords and credentials for network authentication\u201d setting that will prevent network credentials from being stored by the Credential Manager.(Citation: Microsoft Network access Credential Manager)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1114", "name": "Email Collection", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Email Forwarding Rule", "descr": "Consider disabling external email forwarding.(Citation: Microsoft BEC Campaign)", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1611", "name": "Escape to Host", "descr": "Remove unnecessary tools and software from containers.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1546", "name": "Event Triggered Execution", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Screensaver", "descr": "Use Group Policy to disable screensavers if they are unnecessary.(Citation: TechNet Screensaver GP)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "014", "name": "Emond", "descr": "Consider disabling emond by removing the [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) plist file.", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1011", "name": "Exfiltration Over Other Network Medium", "descr": "Disable WiFi connection, modem, cellular data connection, Bluetooth, or another radio frequency (RF) channel in local computer security settings or by group policy if it is not needed within an environment.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration Over Bluetooth", "descr": "Disable Bluetooth in local computer security settings or by group policy if it is not needed within an environment.", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1052", "name": "Exfiltration Over Physical Medium", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Exfiltration over USB", "descr": "Disable Autorun if it is unnecessary. (Citation: Microsoft Disable Autorun) Disallow or restrict removable media at an organizational policy level if they are not required for business operations. (Citation: TechNet Removable Media Control)", "subtechniques": [], "color": 1}], "descr": "Disable Autorun if it is unnecessary. (Citation: Microsoft Disable Autorun) Disallow or restrict removable media at an organizational policy level if they are not required for business operations. (Citation: TechNet Removable Media Control)"}, {"technique_used": true, "domain": "enterprise", "id": "T1210", "name": "Exploitation of Remote Services", "descr": "Minimize available services to only those that are necessary.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1133", "name": "External Remote Services", "descr": "Disable or block remotely available services that may be unnecessary.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1564", "name": "Hide Artifacts", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "006", "name": "Run Virtual Instance", "descr": "Disable Hyper-V if not necessary within a given environment.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "VBA Stomping", "descr": "Turn off or restrict access to unneeded VB components.(Citation: Microsoft Disable VBA Jan 2020)", "subtechniques": [], "color": 1}]}, {"technique_used": true, "domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "descr": "Consider removing previous versions of tools that are unnecessary to the environment when possible.", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "010", "name": "Downgrade Attack", "descr": "Consider removing previous versions of tools that are unnecessary to the environment when possible.", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1559", "name": "Inter-Process Communication", "descr": "Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution. (Citation: Microsoft DDE Advisory Nov 2017)(Citation: BleepingComputer DDE Disabled in Word Dec 2017)(Citation: GitHub Disable DDEAUTO Oct 2017) Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.(Citation: Microsoft ADV170021 Dec 2017)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Dynamic Data Exchange", "descr": "Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution. (Citation: Microsoft DDE Advisory Nov 2017)(Citation: BleepingComputer DDE Disabled in Word Dec 2017)(Citation: GitHub Disable DDEAUTO Oct 2017) Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.(Citation: Microsoft ADV170021 Dec 2017)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1046", "name": "Network Service Discovery", "descr": "Ensure that unnecessary ports and services are closed to prevent risk of discovery and potential exploitation.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1137", "name": "Office Application Startup", "descr": "Follow Office macro security best practices suitable for your environment. Disable Office VBA macros from executing.\n\nDisable Office add-ins. If they are required, follow best practices for securing them by requiring them to be signed and disabling user notification for allowing add-ins. For some add-ins types (WLL, VBA) additional mitigation is likely required as disabling add-ins in the Office Trust Center does not disable WLL nor does it prevent VBA code from executing. (Citation: MRWLabs Office Persistence Add-ins)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Office Template Macros", "descr": "Follow Office macro security best practices suitable for your environment. Disable Office VBA macros from executing.\n\nDisable Office add-ins. If they are required, follow best practices for securing them by requiring them to be signed and disabling user notification for allowing add-ins. For some add-ins types (WLL, VBA) additional mitigation is likely required as disabling add-ins in the Office Trust Center does not disable WLL nor does it prevent VBA code from executing. (Citation: MRWLabs Office Persistence Add-ins)\n", "subtechniques": [], "color": 1}], "color": 1}, {"domain": "enterprise", "id": "T1219", "name": "Remote Access Tools", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "002", "name": "Remote Desktop Software", "descr": "Consider disabling unnecessary remote connection functionality, including both unapproved software installations and specific features built into supported applications.", "subtechniques": [], "color": 1}], "descr": "Consider disabling unnecessary remote connection functionality, including both unapproved software installations and specific features built into supported applications."}, {"domain": "enterprise", "id": "T1563", "name": "Remote Service Session Hijacking", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "SSH Hijacking", "descr": "Ensure that agent forwarding is disabled on systems that do not explicitly require this feature to prevent misuse. (Citation: Symantec SSH and ssh-agent)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "RDP Hijacking", "descr": "Disable the RDP service if it is unnecessary.", "subtechniques": [], "color": 1}], "descr": "Disable the remote service (ex: SSH, RDP, etc.) if it is unnecessary."}, {"domain": "enterprise", "id": "T1021", "name": "Remote Services", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Remote Desktop Protocol", "descr": "Disable the RDP service if it is unnecessary.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "Distributed Component Object Model", "descr": "Consider disabling DCOM through Dcomcnfg.exe.(Citation: Microsoft Disable DCOM)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "SSH", "descr": "Disable the SSH daemon on systems that do not require it, especially ESXi servers. For macOS, ensure Remote Login is disabled under Sharing Preferences.(Citation: Apple Unified Log Analysis Remote Login and Screen Sharing)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "VNC", "descr": "Uninstall any VNC server software where not required.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Windows Remote Management", "descr": "Disable the WinRM service.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Direct Cloud VM Connections", "descr": "If direct virtual machine connections are not required for administrative use, disable these connection types where feasible.", "subtechniques": [], "color": 1}], "descr": "If remote services, such as the ability to make direct connections to cloud virtual machines, are not required, disable these connection types where feasible. On ESXi servers, consider enabling lockdown mode, which disables direct access to an ESXi host and requires that the host be managed remotely using vCenter.(Citation: Google Cloud Threat Intelligence ESXi Hardening 2023)(Citation: Broadcom ESXi Lockdown Mode)"}, {"technique_used": true, "domain": "enterprise", "id": "T1091", "name": "Replication Through Removable Media", "descr": "Disable Autorun if it is unnecessary. (Citation: Microsoft Disable Autorun) Disallow or restrict removable media at an organizational policy level if it is not required for business operations. (Citation: TechNet Removable Media Control)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1505", "name": "Server Software Component", "descr": "Consider disabling software components from servers when possible to prevent abuse by adversaries.(Citation: ITSyndicate Disabling PHP functions)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Web Shell", "descr": "Consider disabling functions from web technologies such as PHP\u2019s `evaI()` that may be abused for web shells.(Citation: ITSyndicate Disabling PHP functions)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1649", "name": "Steal or Forge Authentication Certificates", "descr": "Consider disabling old/dangerous authentication protocols (e.g. NTLM), as well as unnecessary certificate features, such as potentially vulnerable AD CS web and other enrollment server roles.(Citation: SpecterOps Certified Pre Owned)", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1553", "name": "Subvert Trust Controls", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Mark-of-the-Web Bypass", "descr": "Consider disabling auto-mounting of disk image files (i.e., .iso, .img, .vhd, and .vhdx). This can be achieved by modifying the Registry values related to the Windows Explorer file associations in order to disable the automatic Explorer \"Mount and Burn\" dialog for these file extensions. Note: this will not deactivate the mount functionality itself.(Citation: GitHub MOTW)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1218", "name": "System Binary Proxy Execution", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "CMSTP", "descr": "CMSTP.exe may not be necessary within a given environment (unless using it for VPN connection installation).", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "InstallUtil", "descr": "InstallUtil may not be necessary within a given environment.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "005", "name": "Mshta", "descr": "Mshta.exe may not be necessary within a given environment since its functionality is tied to older versions of Internet Explorer that have reached end of life.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "007", "name": "Msiexec", "descr": "Consider disabling the <code>AlwaysInstallElevated</code> policy to prevent elevated execution of Windows Installer packages.(Citation: Microsoft AlwaysInstallElevated 2018)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "008", "name": "Odbcconf", "descr": "Odbcconf.exe may not be necessary within a given environment.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "009", "name": "Regsvcs/Regasm", "descr": "Regsvcs and Regasm may not be necessary within a given environment.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "012", "name": "Verclsid", "descr": "Consider removing verclsid.exe if it is not necessary within a given environment.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "013", "name": "Mavinject", "descr": "Consider removing mavinject.exe if Microsoft App-V is not used within a given environment.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "014", "name": "MMC", "descr": "MMC may not be necessary within a given environment since it is primarily used by system administrators, not regular users or clients. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "015", "name": "Electron Applications", "descr": "Remove or deny access to unnecessary and potentially vulnerable software and features to prevent abuse by adversaries. Many native binaries may not be necessary within a given environment: for example, consider disabling the Node.js integration in all renderers that display remote content to protect users by limiting adversaries\u2019 power to plant malicious JavaScript within Electron applications.(Citation: Electron Security 2)", "subtechniques": [], "color": 1}], "descr": "Many native binaries may not be necessary within a given environment."}, {"technique_used": true, "domain": "enterprise", "id": "T1221", "name": "Template Injection", "descr": "Consider disabling Microsoft Office macros/active content to prevent the execution of malicious payloads in documents (Citation: Microsoft Disable Macros), though this setting may not mitigate the [Forced Authentication](https://attack.mitre.org/techniques/T1187) use for this technique.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1205", "name": "Traffic Signaling", "descr": "Disable Wake-on-LAN if it is not needed within an environment.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1127", "name": "Trusted Developer Utilities Proxy Execution", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "MSBuild", "descr": "MSBuild.exe may not be necessary within an environment and should be removed if not being used.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "ClickOnce", "descr": "Disable ClickOnce installations from the internet using the following registry key: \n`\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\Security\\TrustManager\\PromptingLevel \u2014 Internet:Disabled`(Citation: NetSPI ClickOnce)(Citation: Microsoft Learn ClickOnce Config)\n\nClickOnce may not be necessary within an environment and should be disabled if not being used.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "003", "name": "JamPlus", "descr": "JamPlus may not be necessary within a given environment and should be removed if not used.", "subtechniques": [], "color": 1}], "descr": "Specific developer utilities may not be necessary within a given environment and should be removed if not used."}, {"domain": "enterprise", "id": "T1552", "name": "Unsecured Credentials", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Cloud Instance Metadata API", "descr": "Disable unnecessary metadata services and restrict or disable insecure versions of metadata services that are in use to prevent adversary access.(Citation: Amazon AWS IMDS V2)", "subtechniques": [], "color": 1}]}], "layers": [{"domain": "enterprise", "name": "Enterprise", "filename": "M1042-enterprise-layer.json", "navigator_link": "https://mitre-attack.github.io/attack-navigator/"}], "citations": {"current_number": 0, "Apple Unified Log Analysis Remote Login and Screen Sharing": {"description": "Sarah Edwards. (2020, April 30). Analysis of Apple Unified Logs: Quarantine Edition [Entry 6] \u2013 Working From Home? Remote Logins. Retrieved August 19, 2021.", "url": "https://sarah-edwards-xzkc.squarespace.com/blog/2020/4/30/analysis-of-apple-unified-logs-quarantine-edition-entry-6-working-from-home-remote-logins", "number": null}, "Microsoft Entra Configure OAuth Consent": {"description": "Microsoft Entra. (2024, September 16). Configure how users consent to applications. Retrieved March 20, 2025.", "url": "https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-user-consent?pivots=portal", "number": null}, "Microsoft DDE Advisory Nov 2017": {"description": "Microsoft. (2017, November 8). Microsoft Security Advisory 4053440 - Securely opening Microsoft Office documents that contain Dynamic Data Exchange (DDE) fields. Retrieved November 21, 2017.", "url": "https://technet.microsoft.com/library/security/4053440", "number": null}, "BleepingComputer DDE Disabled in Word Dec 2017": {"description": "Cimpanu, C. (2017, December 15). Microsoft Disables DDE Feature in Word to Prevent Further Malware Attacks. Retrieved December 19, 2017.", "url": "https://www.bleepingcomputer.com/news/microsoft/microsoft-disables-dde-feature-in-word-to-prevent-further-malware-attacks/", "number": null}, "GitHub Disable DDEAUTO Oct 2017": {"description": "Dormann, W. (2017, October 20). Disable DDEAUTO for Outlook, Word, OneNote, and Excel versions 2010, 2013, 2016. Retrieved February 3, 2018.", "url": "https://gist.github.com/wdormann/732bb88d9b5dd5a66c9f1e1498f31a1b", "number": null}, "Microsoft ADV170021 Dec 2017": {"description": "Microsoft. (2017, December 12). ADV170021 - Microsoft Office Defense in Depth Update. Retrieved February 3, 2018.", "url": "https://portal.msrc.microsoft.com/security-guidance/advisory/ADV170021", "number": null}, "ADSecurity Windows Secure Baseline": {"description": "Metcalf, S. (2016, October 21). Securing Windows Workstations: Developing a Secure Baseline. Retrieved November 17, 2017.", "url": "https://adsecurity.org/?p=3299", "number": null}, "Electron Security 2": {"description": "Stack Overflow. (n.d.). Why do I see an \"Electron Security Warning\" after updating my Electron project to the latest version?. Retrieved March 7, 2024.", "url": "https://stackoverflow.com/questions/48854265/why-do-i-see-an-electron-security-warning-after-updating-my-electron-project-t", "number": null}, "Microsoft Learn ClickOnce Config": {"description": "Microsoft. (2023, August 4). Configure the ClickOnce trust prompt behavior. Retrieved September 9, 2024.", "url": "https://learn.microsoft.com/en-us/visualstudio/deployment/how-to-configure-the-clickonce-trust-prompt-behavior?view=vs-2022&tabs=csharp", "number": null}, "NetSPI ClickOnce": {"description": "Ryan Gandrud. (2015, March 23). All You Need Is One \u2013 A ClickOnce Love Story. Retrieved September 9, 2024.", "url": "https://www.netspi.com/blog/technical-blog/adversary-simulation/all-you-need-is-one-a-clickonce-love-story/", "number": null}, "SpecterOps Certified Pre Owned": {"description": "Schroeder, W. & Christensen, L. (2021, June 22). Certified Pre-Owned - Abusing Active Directory Certificate Services. Retrieved August 2, 2022.", "url": "https://web.archive.org/web/20220818094600/https://specterops.io/assets/resources/Certified_Pre-Owned.pdf", "number": null}, "Microsoft BEC Campaign": {"description": "Carr, N., Sellmer, S. (2021, June 14). Behind the scenes of business email compromise: Using cross-domain threat data to disrupt a large BEC campaign. Retrieved June 15, 2021.", "url": "https://www.microsoft.com/security/blog/2021/06/14/behind-the-scenes-of-business-email-compromise-using-cross-domain-threat-data-to-disrupt-a-large-bec-infrastructure/", "number": null}, "Microsoft Disable Autorun": {"description": "Microsoft. (n.d.). How to disable the Autorun functionality in Windows. Retrieved April 20, 2016.", "url": "https://support.microsoft.com/en-us/kb/967715", "number": null}, "TechNet Removable Media Control": {"description": "Microsoft. (2007, August 31). https://technet.microsoft.com/en-us/library/cc771759(v=ws.10).aspx. Retrieved April 20, 2016.", "url": "https://technet.microsoft.com/en-us/library/cc772540(v=ws.10).aspx", "number": null}, "GitHub MOTW": {"description": "wdormann. (2019, August 29). Disable Windows Explorer file associations for Disc Image Mount. Retrieved April 16, 2022.", "url": "https://gist.github.com/wdormann/fca29e0dcda8b5c0472e73e10c78c3e7", "number": null}, "ITSyndicate Disabling PHP functions": {"description": "Kondratiev, A. (n.d.). Disabling dangerous PHP functions. Retrieved July 26, 2021.", "url": "https://itsyndicate.org/blog/disabling-dangerous-php-functions/", "number": null}, "MRWLabs Office Persistence Add-ins": {"description": "Knowles, W. (2017, April 21). Add-In Opportunities for Office Persistence. Retrieved November 17, 2024.", "url": "https://web.archive.org/web/20190526112859/https://labs.mwrinfosecurity.com/blog/add-in-opportunities-for-office-persistence/", "number": null}, "TechNet Screensaver GP": {"description": "Microsoft. (n.d.). Customizing the Desktop. Retrieved December 5, 2017.", "url": "https://technet.microsoft.com/library/cc938799.aspx", "number": null}, "Microsoft Disable DCOM": {"description": "Microsoft. (n.d.). Enable or Disable DCOM. Retrieved November 22, 2017.", "url": "https://technet.microsoft.com/library/cc771387.aspx", "number": null}, "Microsoft Network access Credential Manager": {"description": "Microsoft. (2016, August 31). Network access: Do not allow storage of passwords and credentials for network authentication. Retrieved November 23, 2020.", "url": "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj852185(v=ws.11)?redirectedfrom=MSDN", "number": null}, "Broadcom ESXi SSH": {"description": "Broadcom. (2024, December 12). Allowing SSH access to VMware vSphere ESXi/ESX hosts with public/private key authentication. Retrieved March 26, 2025.", "url": "https://knowledge.broadcom.com/external/article/313767/allowing-ssh-access-to-vmware-vsphere-es.html", "number": null}, "Symantec SSH and ssh-agent": {"description": "Hatch, B. (2004, November 22). SSH and ssh-agent. Retrieved January 8, 2018.", "url": "https://www.symantec.com/connect/articles/ssh-and-ssh-agent", "number": null}, "Microsoft AlwaysInstallElevated 2018": {"description": "Microsoft. (2018, May 31). AlwaysInstallElevated. Retrieved December 14, 2020.", "url": "https://docs.microsoft.com/en-us/windows/win32/msi/alwaysinstallelevated", "number": null}, "Microsoft Disable VBA Jan 2020": {"description": "Microsoft. (2020, January 23). How to turn off Visual Basic for Applications when you deploy Office. Retrieved September 17, 2020.", "url": "https://docs.microsoft.com/en-us/previous-versions/office/troubleshoot/office-developer/turn-off-visual-basic-for-application", "number": null}, "Amazon AWS IMDS V2": {"description": "MacCarthaigh, C. (2019, November 19). Add defense in depth against open firewalls, reverse proxies, and SSRF vulnerabilities with enhancements to the EC2 Instance Metadata Service. Retrieved October 14, 2020.", "url": "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/", "number": null}, "Google Cloud Threat Intelligence ESXi Hardening 2023": {"description": "Alex Marvi, Greg Blaum, and Ron Craft. (2023, June 28). Detection, Containment, and Hardening Opportunities for Privileged Guest Operations, Anomalous Behavior, and VMCI Backdoors on Compromised VMware Hosts. Retrieved March 26, 2025.", "url": "https://cloud.google.com/blog/topics/threat-intelligence/vmware-detection-containment-hardening", "number": null}, "Broadcom ESXi Lockdown Mode": {"description": "Broadcom. (2025, February 12). Enabling or disabling Lockdown mode on an ESXi host. Retrieved March 27, 2025.", "url": "https://knowledge.broadcom.com/external/article/336894/enabling-or-disabling-lockdown-mode-on-a.html", "number": null}, "Microsoft Disable Macros": {"description": "Microsoft. (n.d.). Enable or disable macros in Office files. Retrieved September 13, 2018.", "url": "https://support.office.com/article/enable-or-disable-macros-in-office-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6", "number": null}, "Gmail Delegation": {"description": "Google. (n.d.). Turn Gmail delegation on or off. Retrieved April 1, 2022.", "url": "https://support.google.com/a/answer/7223765?hl=en", "number": null}}, "versioning_feature": false}