Title: Restrict Registry Permissions-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1024/index.html
data: {"attack_id": "M1024", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": null, "children": [{"name": "Enterprise", "id": "enterprise", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M1057/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M1060/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Pre-compromise", "id": "Pre-compromise", "path": "/mitigations/M1056/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Mobile", "id": "mobile", "path": "/mitigations/mobile/", "children": [{"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1058/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Attestation", "id": "Attestation", "path": "/mitigations/M1002/", "children": []}, {"name": "Deploy Compromised Device Detection Method", "id": "Deploy Compromised Device Detection Method", "path": "/mitigations/M1010/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1059/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M1009/", "children": []}, {"name": "Enterprise Policy", "id": "Enterprise Policy", "path": "/mitigations/M1012/", "children": []}, {"name": "Interconnection Filtering", "id": "Interconnection Filtering", "path": "/mitigations/M1014/", "children": []}, {"name": "Lock Bootloader", "id": "Lock Bootloader", "path": "/mitigations/M1003/", "children": []}, {"name": "Security Updates", "id": "Security Updates", "path": "/mitigations/M1001/", "children": []}, {"name": "System Partition Integrity", "id": "System Partition Integrity", "path": "/mitigations/M1004/", "children": []}, {"name": "Use Recent OS Version", "id": "Use Recent OS Version", "path": "/mitigations/M1006/", "children": []}, {"name": "User Guidance", "id": "User Guidance", "path": "/mitigations/M1011/", "children": []}]}, {"name": "ICS", "id": "ics", "path": "/mitigations/ics/", "children": [{"name": "Access Management", "id": "Access Management", "path": "/mitigations/M0801/", "children": []}, {"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M0936/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M0915/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M0949/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M0913/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M0948/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M0947/", "children": []}, {"name": "Authorization Enforcement", "id": "Authorization Enforcement", "path": "/mitigations/M0800/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M0946/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M0945/", "children": []}, {"name": "Communication Authenticity", "id": "Communication Authenticity", "path": "/mitigations/M0802/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M0953/", "children": []}, {"name": "Data Loss Prevention", "id": "Data Loss Prevention", "path": "/mitigations/M0803/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M0942/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M0808/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M0941/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M0938/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M0950/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M0937/", "children": []}, {"name": "Human User Authentication", "id": "Human User Authentication", "path": "/mitigations/M0804/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M0935/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M0934/", "children": []}, {"name": "Mechanical Protection Layers", "id": "Mechanical Protection Layers", "path": "/mitigations/M0805/", "children": []}, {"name": "Minimize Wireless Signal Propagation", "id": "Minimize Wireless Signal Propagation", "path": "/mitigations/M0806/", "children": []}, {"name": "Mitigation Limited or Not Effective", "id": "Mitigation Limited or Not Effective", "path": "/mitigations/M0816/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M0932/", "children": []}, {"name": "Network Allowlists", "id": "Network Allowlists", "path": "/mitigations/M0807/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M0931/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M0930/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M0928/", "children": []}, {"name": "Operational Information Confidentiality", "id": "Operational Information Confidentiality", "path": "/mitigations/M0809/", "children": []}, {"name": "Out-of-Band Communications Channel", "id": "Out-of-Band Communications Channel", "path": "/mitigations/M0810/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M0927/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M0926/", "children": []}, {"name": "Redundancy of Service", "id": "Redundancy of Service", "path": "/mitigations/M0811/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M0922/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M0944/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M0924/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M0921/", "children": []}, {"name": "Safety Instrumented Systems", "id": "Safety Instrumented Systems", "path": "/mitigations/M0812/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M0954/", "children": []}, {"name": "Software Process and Device Authentication", "id": "Software Process and Device Authentication", "path": "/mitigations/M0813/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M0920/", "children": []}, {"name": "Static Network Configuration", "id": "Static Network Configuration", "path": "/mitigations/M0814/", "children": []}, {"name": "Supply Chain Management", "id": "Supply Chain Management", "path": "/mitigations/M0817/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M0919/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M0951/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M0918/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M0917/", "children": []}, {"name": "Validate Program Inputs", "id": "Validate Program Inputs", "path": "/mitigations/M0818/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M0916/", "children": []}, {"name": "Watchdog Timers", "id": "Watchdog Timers", "path": "/mitigations/M0815/", "children": []}]}]}, "name": "Restrict Registry Permissions", "notes": null, "created": "06 June 2019", "modified": "24 December 2024", "descr": "Restricting registry permissions involves configuring access control settings for sensitive registry keys and hives to ensure that only authorized users or processes can make modifications. By limiting access, organizations can prevent unauthorized changes that adversaries might use for persistence, privilege escalation, or defense evasion. This mitigation can be implemented through the following measures:\n\nReview and Adjust Permissions on Critical Keys\n\n- Regularly review permissions on keys such as `Run`, `RunOnce`, and `Services` to ensure only authorized users have write access.\n- Use tools like `icacls` or `PowerShell` to automate permission adjustments.\n\nEnable Registry Auditing\n\n- Enable auditing on sensitive keys to log access attempts.\n- Use Event Viewer or SIEM solutions to analyze logs and detect suspicious activity.\n- Example Audit Policy: `auditpol /set /subcategory:\"Registry\" /success:enable /failure:enable`\n\nProtect Credential-Related Hives\n\n- Limit access to hives like `SAM`,`SECURITY`, and `SYSTEM` to prevent credential dumping or other unauthorized access.\n- Use LSA Protection to add an additional security layer for credential storage.\n\nRestrict Registry Editor Usage\n\n- Use Group Policy to restrict access to regedit.exe for non-administrative users.\n- Block execution of registry editing tools on endpoints where they are unnecessary.\n\nDeploy Baseline Configuration Tools\n\n- Use tools like Microsoft Security Compliance Toolkit or CIS Benchmarks to apply and maintain secure registry configurations.\n\n*Tools for Implementation* \n\nRegistry Permission Tools:\n\n- Registry Editor (regedit): Built-in tool to manage registry permissions.\n- PowerShell: Automate permissions and manage keys. `Set-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" -Name \"KeyName\" -Value \"Value\"`\n- icacls: Command-line tool to modify ACLs.\n\nMonitoring Tools:\n\n- Sysmon: Monitor and log registry events.\n- Event Viewer: View registry access logs.\n\nPolicy Management Tools:\n\n- Group Policy Management Console (GPMC): Enforce registry permissions via GPOs.\n- Microsoft Endpoint Manager: Deploy configuration baselines for registry permissions.", "version": "1.2", "techniques_addressed_data": [{"domain": "enterprise", "id": "T1547", "name": "Boot or Logon Autostart Execution", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "Time Providers", "descr": "Consider using Group Policy to configure and block modifications to W32Time parameters in the Registry. (Citation: Microsoft W32Time May 2017)", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1037", "name": "Boot or Logon Initialization Scripts", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Logon Script (Windows)", "descr": "Ensure proper permissions are set for Registry hives to prevent users from modifying keys for logon scripts that may lead to persistence.", "subtechniques": [], "color": 1}], "descr": "Ensure proper permissions are set for Registry hives to prevent users from modifying keys for logon scripts that may lead to persistence."}, {"domain": "enterprise", "id": "T1574", "name": "Hijack Execution Flow", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "011", "name": "Services Registry Permissions Weakness", "descr": "Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "012", "name": "COR_PROFILER", "descr": "Ensure proper permissions are set for Registry hives to prevent users from modifying keys associated with COR_PROFILER.", "subtechniques": [], "color": 1}], "descr": "Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation."}, {"domain": "enterprise", "id": "T1562", "name": "Impair Defenses", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "001", "name": "Disable or Modify Tools", "descr": "Ensure proper Registry permissions are in place to prevent adversaries from disabling or interfering with security services.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "002", "name": "Disable Windows Event Logging", "descr": "Ensure proper Registry permissions are in place to prevent adversaries from disabling or interfering logging. The addition of the MiniNT registry key disables Event Viewer.(Citation: def_ev_win_event_logging)", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "004", "name": "Disable or Modify System Firewall", "descr": "Ensure proper Registry permissions are in place to prevent adversaries from disabling or modifying firewall settings.", "subtechniques": [], "color": 1}], "descr": "Ensure proper Registry permissions are in place to prevent adversaries from disabling or interfering with security/logging services."}, {"domain": "enterprise", "id": "T1070", "name": "Indicator Removal", "technique_used": false, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "007", "name": "Clear Network Connection History and Configurations", "descr": "Protect generated event files and logs that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities.", "subtechniques": [], "color": 1}]}, {"domain": "enterprise", "id": "T1556", "name": "Modify Authentication Process", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "008", "name": "Network Provider DLL", "descr": "Restrict Registry permissions to disallow the modification of sensitive Registry keys such as `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order`.", "subtechniques": [], "color": 1}], "descr": "Restrict Registry permissions to disallow the modification of sensitive Registry keys such as `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order`."}, {"technique_used": true, "domain": "enterprise", "id": "T1112", "name": "Modify Registry", "descr": "Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation.", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1505", "name": "Server Software Component", "descr": "Consider using Group Policy to configure and block modifications to service and other critical server parameters in the Registry.(Citation: Microsoft System Services Fundamentals)", "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "005", "name": "Terminal Services DLL", "descr": "Consider using Group Policy to configure and block modifications to Terminal Services parameters in the Registry.(Citation: Microsoft System Services Fundamentals)", "subtechniques": [], "color": 1}], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "T1489", "name": "Service Stop", "descr": "Ensure proper registry permissions are in place to inhibit adversaries from disabling or interfering with critical services.", "subtechniques": [], "color": 1}, {"domain": "enterprise", "id": "T1553", "name": "Subvert Trust Controls", "technique_used": true, "subtechniques": [{"technique_used": true, "domain": "enterprise", "id": "003", "name": "SIP and Trust Provider Hijacking", "descr": "Ensure proper permissions are set for Registry hives to prevent users from modifying keys related to SIP and trust provider components. Components may still be able to be hijacked to suitable functions already present on disk if malicious modifications to Registry keys are not prevented. ", "subtechniques": [], "color": 1}, {"technique_used": true, "domain": "enterprise", "id": "006", "name": "Code Signing Policy Modification", "descr": "Ensure proper permissions are set for the Registry to prevent users from modifying keys related to code signing policies.", "subtechniques": [], "color": 1}], "descr": "Ensure proper permissions are set for Registry hives to prevent users from modifying keys related to SIP and trust provider components. Components may still be able to be hijacked to suitable functions already present on disk if malicious modifications to Registry keys are not prevented."}], "layers": [{"domain": "enterprise", "name": "Enterprise", "filename": "M1024-enterprise-layer.json", "navigator_link": "https://mitre-attack.github.io/attack-navigator/"}], "citations": {"current_number": 0, "Microsoft W32Time May 2017": {"description": "Mathers, B. (2017, May 31). Windows Time Service Tools and Settings. Retrieved March 26, 2018.", "url": "https://docs.microsoft.com/windows-server/networking/windows-time-service/windows-time-service-tools-and-settings", "number": null}, "Microsoft System Services Fundamentals": {"description": "Microsoft. (2018, February 17). Windows System Services Fundamentals. Retrieved March 28, 2022.", "url": "https://social.technet.microsoft.com/wiki/contents/articles/12229.windows-system-services-fundamentals.aspx", "number": null}, "def_ev_win_event_logging": {"description": "Chandel, R. (2021, April 22). Defense Evasion: Windows Event Logging (T1562.002). Retrieved September 14, 2021.", "url": "https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/", "number": null}}, "versioning_feature": false}